Index: data/README.md
===================================================================
diff --git a/data/README.md b/data/README.md
deleted file mode 100644
--- a/data/README.md	(revision 914c0e7bb37d00d1a25c112f282b7b36d5b80d23)
+++ /dev/null	(revision 914c0e7bb37d00d1a25c112f282b7b36d5b80d23)
@@ -1,6 +0,0 @@
-# chest-X-rays
-Chest X-ray Abnormalities Classification from VinBigData
-
-
-papers:
-https://arxiv.org/abs/1904.03582
Index: notebooks/create_npy.ipynb
===================================================================
diff --git a/notebooks/create_npy.ipynb b/notebooks/create_npy.ipynb
deleted file mode 100644
--- a/notebooks/create_npy.ipynb	(revision 914c0e7bb37d00d1a25c112f282b7b36d5b80d23)
+++ /dev/null	(revision 914c0e7bb37d00d1a25c112f282b7b36d5b80d23)
@@ -1,861 +0,0 @@
-{
- "cells": [
-  {
-   "cell_type": "code",
-   "execution_count": 2,
-   "metadata": {},
-   "outputs": [],
-   "source": [
-    "import numpy as np\n",
-    "import pandas as pd \n",
-    "import os \n",
-    "import parameter as para "
-   ]
-  },
-  {
-   "cell_type": "code",
-   "execution_count": 4,
-   "metadata": {},
-   "outputs": [
-    {
-     "data": {
-      "text/html": [
-       "<div>\n",
-       "<style scoped>\n",
-       "    .dataframe tbody tr th:only-of-type {\n",
-       "        vertical-align: middle;\n",
-       "    }\n",
-       "\n",
-       "    .dataframe tbody tr th {\n",
-       "        vertical-align: top;\n",
-       "    }\n",
-       "\n",
-       "    .dataframe thead th {\n",
-       "        text-align: right;\n",
-       "    }\n",
-       "</style>\n",
-       "<table border=\"1\" class=\"dataframe\">\n",
-       "  <thead>\n",
-       "    <tr style=\"text-align: right;\">\n",
-       "      <th></th>\n",
-       "      <th>image_ids</th>\n",
-       "      <th>class_name</th>\n",
-       "      <th>Aortic enlargement</th>\n",
-       "      <th>Atelectasis</th>\n",
-       "      <th>Calcification</th>\n",
-       "      <th>Cardiomegaly</th>\n",
-       "      <th>Consolidation</th>\n",
-       "      <th>ILD</th>\n",
-       "      <th>Infiltration</th>\n",
-       "      <th>Lung Opacity</th>\n",
-       "      <th>Nodule Mass</th>\n",
-       "      <th>Other lesion</th>\n",
-       "      <th>Pleural effusion</th>\n",
-       "      <th>Pleural thickening</th>\n",
-       "      <th>Pneumothorax</th>\n",
-       "      <th>Pulmonary fibrosis</th>\n",
-       "      <th>image_paths</th>\n",
-       "    </tr>\n",
-       "  </thead>\n",
-       "  <tbody>\n",
-       "    <tr>\n",
-       "      <th>0</th>\n",
-       "      <td>a259009c4eeacf9ccf4f8db4bf3e7714</td>\n",
-       "      <td>['No finding' 'No finding' 'No finding']</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>1</th>\n",
-       "      <td>ac2a615b3861212f9a2ada6acd077fd9</td>\n",
-       "      <td>['Aortic enlargement' 'Pleural thickening' 'Pl...</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>2</th>\n",
-       "      <td>211fb0b1fae0691e21159bcff77672a7</td>\n",
-       "      <td>['No finding' 'No finding' 'No finding']</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>3</th>\n",
-       "      <td>003cfe5ce5c0ec5163138eb3b740e328</td>\n",
-       "      <td>['No finding' 'No finding' 'No finding']</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>4</th>\n",
-       "      <td>3fb2fa3cceb68338ecf497cb3a2a318d</td>\n",
-       "      <td>['No finding' 'No finding' 'No finding']</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>...</th>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>95</th>\n",
-       "      <td>0fa3a43de5d5204d9be82a1969c1b6c8</td>\n",
-       "      <td>['No finding' 'No finding' 'No finding']</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>96</th>\n",
-       "      <td>d69c970d9c790b8813f5b0d0964e6a55</td>\n",
-       "      <td>['No finding' 'No finding' 'No finding']</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>97</th>\n",
-       "      <td>a0af7d64eecad23a41730cef8dbf2f11</td>\n",
-       "      <td>['No finding' 'No finding' 'No finding']</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>98</th>\n",
-       "      <td>fb40ca51c74b4be05cc855629211b406</td>\n",
-       "      <td>['No finding' 'No finding' 'No finding']</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>99</th>\n",
-       "      <td>c9385d43de0481706fe6084ace25dbbf</td>\n",
-       "      <td>['No finding' 'No finding' 'No finding']</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "  </tbody>\n",
-       "</table>\n",
-       "<p>100 rows × 17 columns</p>\n",
-       "</div>"
-      ],
-      "text/plain": [
-       "                           image_ids  \\\n",
-       "0   a259009c4eeacf9ccf4f8db4bf3e7714   \n",
-       "1   ac2a615b3861212f9a2ada6acd077fd9   \n",
-       "2   211fb0b1fae0691e21159bcff77672a7   \n",
-       "3   003cfe5ce5c0ec5163138eb3b740e328   \n",
-       "4   3fb2fa3cceb68338ecf497cb3a2a318d   \n",
-       "..                               ...   \n",
-       "95  0fa3a43de5d5204d9be82a1969c1b6c8   \n",
-       "96  d69c970d9c790b8813f5b0d0964e6a55   \n",
-       "97  a0af7d64eecad23a41730cef8dbf2f11   \n",
-       "98  fb40ca51c74b4be05cc855629211b406   \n",
-       "99  c9385d43de0481706fe6084ace25dbbf   \n",
-       "\n",
-       "                                           class_name  Aortic enlargement  \\\n",
-       "0            ['No finding' 'No finding' 'No finding']                 0.0   \n",
-       "1   ['Aortic enlargement' 'Pleural thickening' 'Pl...                 1.0   \n",
-       "2            ['No finding' 'No finding' 'No finding']                 0.0   \n",
-       "3            ['No finding' 'No finding' 'No finding']                 0.0   \n",
-       "4            ['No finding' 'No finding' 'No finding']                 0.0   \n",
-       "..                                                ...                 ...   \n",
-       "95           ['No finding' 'No finding' 'No finding']                 0.0   \n",
-       "96           ['No finding' 'No finding' 'No finding']                 0.0   \n",
-       "97           ['No finding' 'No finding' 'No finding']                 0.0   \n",
-       "98           ['No finding' 'No finding' 'No finding']                 0.0   \n",
-       "99           ['No finding' 'No finding' 'No finding']                 0.0   \n",
-       "\n",
-       "    Atelectasis  Calcification  Cardiomegaly  Consolidation  ILD  \\\n",
-       "0           0.0            0.0           0.0            0.0  0.0   \n",
-       "1           0.0            0.0           1.0            0.0  0.0   \n",
-       "2           0.0            0.0           0.0            0.0  0.0   \n",
-       "3           0.0            0.0           0.0            0.0  0.0   \n",
-       "4           0.0            0.0           0.0            0.0  0.0   \n",
-       "..          ...            ...           ...            ...  ...   \n",
-       "95          0.0            0.0           0.0            0.0  0.0   \n",
-       "96          0.0            0.0           0.0            0.0  0.0   \n",
-       "97          0.0            0.0           0.0            0.0  0.0   \n",
-       "98          0.0            0.0           0.0            0.0  0.0   \n",
-       "99          0.0            0.0           0.0            0.0  0.0   \n",
-       "\n",
-       "    Infiltration  Lung Opacity  Nodule Mass  Other lesion  Pleural effusion  \\\n",
-       "0            0.0           0.0          0.0           0.0               0.0   \n",
-       "1            1.0           1.0          0.0           0.0               0.0   \n",
-       "2            0.0           0.0          0.0           0.0               0.0   \n",
-       "3            0.0           0.0          0.0           0.0               0.0   \n",
-       "4            0.0           0.0          0.0           0.0               0.0   \n",
-       "..           ...           ...          ...           ...               ...   \n",
-       "95           0.0           0.0          0.0           0.0               0.0   \n",
-       "96           0.0           0.0          0.0           0.0               0.0   \n",
-       "97           0.0           0.0          0.0           0.0               0.0   \n",
-       "98           0.0           0.0          0.0           0.0               0.0   \n",
-       "99           0.0           0.0          0.0           0.0               0.0   \n",
-       "\n",
-       "    Pleural thickening  Pneumothorax  Pulmonary fibrosis  \\\n",
-       "0                  0.0           0.0                 0.0   \n",
-       "1                  1.0           0.0                 0.0   \n",
-       "2                  0.0           0.0                 0.0   \n",
-       "3                  0.0           0.0                 0.0   \n",
-       "4                  0.0           0.0                 0.0   \n",
-       "..                 ...           ...                 ...   \n",
-       "95                 0.0           0.0                 0.0   \n",
-       "96                 0.0           0.0                 0.0   \n",
-       "97                 0.0           0.0                 0.0   \n",
-       "98                 0.0           0.0                 0.0   \n",
-       "99                 0.0           0.0                 0.0   \n",
-       "\n",
-       "                                          image_paths  \n",
-       "0   /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "1   /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "2   /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "3   /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "4   /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "..                                                ...  \n",
-       "95  /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "96  /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "97  /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "98  /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "99  /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "\n",
-       "[100 rows x 17 columns]"
-      ]
-     },
-     "execution_count": 4,
-     "metadata": {},
-     "output_type": "execute_result"
-    }
-   ],
-   "source": [
-    "df = pd.read_csv('/Users/HPhuc/Practice/12. classification/vinbigdata/output/csv/data_train.csv', index_col=0)\n",
-    "df "
-   ]
-  },
-  {
-   "cell_type": "code",
-   "execution_count": 5,
-   "metadata": {},
-   "outputs": [
-    {
-     "data": {
-      "text/html": [
-       "<div>\n",
-       "<style scoped>\n",
-       "    .dataframe tbody tr th:only-of-type {\n",
-       "        vertical-align: middle;\n",
-       "    }\n",
-       "\n",
-       "    .dataframe tbody tr th {\n",
-       "        vertical-align: top;\n",
-       "    }\n",
-       "\n",
-       "    .dataframe thead th {\n",
-       "        text-align: right;\n",
-       "    }\n",
-       "</style>\n",
-       "<table border=\"1\" class=\"dataframe\">\n",
-       "  <thead>\n",
-       "    <tr style=\"text-align: right;\">\n",
-       "      <th></th>\n",
-       "      <th>image_ids</th>\n",
-       "      <th>class_name</th>\n",
-       "      <th>Aortic enlargement</th>\n",
-       "      <th>Atelectasis</th>\n",
-       "      <th>Calcification</th>\n",
-       "      <th>Cardiomegaly</th>\n",
-       "      <th>Consolidation</th>\n",
-       "      <th>ILD</th>\n",
-       "      <th>Infiltration</th>\n",
-       "      <th>Lung Opacity</th>\n",
-       "      <th>Nodule Mass</th>\n",
-       "      <th>Other lesion</th>\n",
-       "      <th>Pleural effusion</th>\n",
-       "      <th>Pleural thickening</th>\n",
-       "      <th>Pneumothorax</th>\n",
-       "      <th>Pulmonary fibrosis</th>\n",
-       "      <th>image_paths</th>\n",
-       "      <th>Images</th>\n",
-       "    </tr>\n",
-       "  </thead>\n",
-       "  <tbody>\n",
-       "    <tr>\n",
-       "      <th>0</th>\n",
-       "      <td>a259009c4eeacf9ccf4f8db4bf3e7714</td>\n",
-       "      <td>['No finding' 'No finding' 'No finding']</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>1</th>\n",
-       "      <td>ac2a615b3861212f9a2ada6acd077fd9</td>\n",
-       "      <td>['Aortic enlargement' 'Pleural thickening' 'Pl...</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>2</th>\n",
-       "      <td>211fb0b1fae0691e21159bcff77672a7</td>\n",
-       "      <td>['No finding' 'No finding' 'No finding']</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>3</th>\n",
-       "      <td>003cfe5ce5c0ec5163138eb3b740e328</td>\n",
-       "      <td>['No finding' 'No finding' 'No finding']</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>4</th>\n",
-       "      <td>3fb2fa3cceb68338ecf497cb3a2a318d</td>\n",
-       "      <td>['No finding' 'No finding' 'No finding']</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>...</th>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>95</th>\n",
-       "      <td>0fa3a43de5d5204d9be82a1969c1b6c8</td>\n",
-       "      <td>['No finding' 'No finding' 'No finding']</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>96</th>\n",
-       "      <td>d69c970d9c790b8813f5b0d0964e6a55</td>\n",
-       "      <td>['No finding' 'No finding' 'No finding']</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>97</th>\n",
-       "      <td>a0af7d64eecad23a41730cef8dbf2f11</td>\n",
-       "      <td>['No finding' 'No finding' 'No finding']</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>98</th>\n",
-       "      <td>fb40ca51c74b4be05cc855629211b406</td>\n",
-       "      <td>['No finding' 'No finding' 'No finding']</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>99</th>\n",
-       "      <td>c9385d43de0481706fe6084ace25dbbf</td>\n",
-       "      <td>['No finding' 'No finding' 'No finding']</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "  </tbody>\n",
-       "</table>\n",
-       "<p>100 rows × 18 columns</p>\n",
-       "</div>"
-      ],
-      "text/plain": [
-       "                           image_ids  \\\n",
-       "0   a259009c4eeacf9ccf4f8db4bf3e7714   \n",
-       "1   ac2a615b3861212f9a2ada6acd077fd9   \n",
-       "2   211fb0b1fae0691e21159bcff77672a7   \n",
-       "3   003cfe5ce5c0ec5163138eb3b740e328   \n",
-       "4   3fb2fa3cceb68338ecf497cb3a2a318d   \n",
-       "..                               ...   \n",
-       "95  0fa3a43de5d5204d9be82a1969c1b6c8   \n",
-       "96  d69c970d9c790b8813f5b0d0964e6a55   \n",
-       "97  a0af7d64eecad23a41730cef8dbf2f11   \n",
-       "98  fb40ca51c74b4be05cc855629211b406   \n",
-       "99  c9385d43de0481706fe6084ace25dbbf   \n",
-       "\n",
-       "                                           class_name  Aortic enlargement  \\\n",
-       "0            ['No finding' 'No finding' 'No finding']                 0.0   \n",
-       "1   ['Aortic enlargement' 'Pleural thickening' 'Pl...                 1.0   \n",
-       "2            ['No finding' 'No finding' 'No finding']                 0.0   \n",
-       "3            ['No finding' 'No finding' 'No finding']                 0.0   \n",
-       "4            ['No finding' 'No finding' 'No finding']                 0.0   \n",
-       "..                                                ...                 ...   \n",
-       "95           ['No finding' 'No finding' 'No finding']                 0.0   \n",
-       "96           ['No finding' 'No finding' 'No finding']                 0.0   \n",
-       "97           ['No finding' 'No finding' 'No finding']                 0.0   \n",
-       "98           ['No finding' 'No finding' 'No finding']                 0.0   \n",
-       "99           ['No finding' 'No finding' 'No finding']                 0.0   \n",
-       "\n",
-       "    Atelectasis  Calcification  Cardiomegaly  Consolidation  ILD  \\\n",
-       "0           0.0            0.0           0.0            0.0  0.0   \n",
-       "1           0.0            0.0           1.0            0.0  0.0   \n",
-       "2           0.0            0.0           0.0            0.0  0.0   \n",
-       "3           0.0            0.0           0.0            0.0  0.0   \n",
-       "4           0.0            0.0           0.0            0.0  0.0   \n",
-       "..          ...            ...           ...            ...  ...   \n",
-       "95          0.0            0.0           0.0            0.0  0.0   \n",
-       "96          0.0            0.0           0.0            0.0  0.0   \n",
-       "97          0.0            0.0           0.0            0.0  0.0   \n",
-       "98          0.0            0.0           0.0            0.0  0.0   \n",
-       "99          0.0            0.0           0.0            0.0  0.0   \n",
-       "\n",
-       "    Infiltration  Lung Opacity  Nodule Mass  Other lesion  Pleural effusion  \\\n",
-       "0            0.0           0.0          0.0           0.0               0.0   \n",
-       "1            1.0           1.0          0.0           0.0               0.0   \n",
-       "2            0.0           0.0          0.0           0.0               0.0   \n",
-       "3            0.0           0.0          0.0           0.0               0.0   \n",
-       "4            0.0           0.0          0.0           0.0               0.0   \n",
-       "..           ...           ...          ...           ...               ...   \n",
-       "95           0.0           0.0          0.0           0.0               0.0   \n",
-       "96           0.0           0.0          0.0           0.0               0.0   \n",
-       "97           0.0           0.0          0.0           0.0               0.0   \n",
-       "98           0.0           0.0          0.0           0.0               0.0   \n",
-       "99           0.0           0.0          0.0           0.0               0.0   \n",
-       "\n",
-       "    Pleural thickening  Pneumothorax  Pulmonary fibrosis  \\\n",
-       "0                  0.0           0.0                 0.0   \n",
-       "1                  1.0           0.0                 0.0   \n",
-       "2                  0.0           0.0                 0.0   \n",
-       "3                  0.0           0.0                 0.0   \n",
-       "4                  0.0           0.0                 0.0   \n",
-       "..                 ...           ...                 ...   \n",
-       "95                 0.0           0.0                 0.0   \n",
-       "96                 0.0           0.0                 0.0   \n",
-       "97                 0.0           0.0                 0.0   \n",
-       "98                 0.0           0.0                 0.0   \n",
-       "99                 0.0           0.0                 0.0   \n",
-       "\n",
-       "                                          image_paths  \\\n",
-       "0   /Users/HPhuc/Practice/12. classification/vinbi...   \n",
-       "1   /Users/HPhuc/Practice/12. classification/vinbi...   \n",
-       "2   /Users/HPhuc/Practice/12. classification/vinbi...   \n",
-       "3   /Users/HPhuc/Practice/12. classification/vinbi...   \n",
-       "4   /Users/HPhuc/Practice/12. classification/vinbi...   \n",
-       "..                                                ...   \n",
-       "95  /Users/HPhuc/Practice/12. classification/vinbi...   \n",
-       "96  /Users/HPhuc/Practice/12. classification/vinbi...   \n",
-       "97  /Users/HPhuc/Practice/12. classification/vinbi...   \n",
-       "98  /Users/HPhuc/Practice/12. classification/vinbi...   \n",
-       "99  /Users/HPhuc/Practice/12. classification/vinbi...   \n",
-       "\n",
-       "                                               Images  \n",
-       "0   /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "1   /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "2   /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "3   /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "4   /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "..                                                ...  \n",
-       "95  /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "96  /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "97  /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "98  /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "99  /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "\n",
-       "[100 rows x 18 columns]"
-      ]
-     },
-     "execution_count": 5,
-     "metadata": {},
-     "output_type": "execute_result"
-    }
-   ],
-   "source": [
-    "save_path = '/Users/HPhuc/Practice/12. classification/vinbigdata/output/output_xray/'\n",
-    "df[\"Images\"] = f\"{save_path}\" + df[\"image_ids\"] + \".png.npy\"\n",
-    "df "
-   ]
-  },
-  {
-   "cell_type": "code",
-   "execution_count": 6,
-   "metadata": {},
-   "outputs": [
-    {
-     "data": {
-      "text/plain": [
-       "'/Users/HPhuc/Practice/12. classification/vinbigdata/output/output_xray/a0af7d64eecad23a41730cef8dbf2f11.png.npy'"
-      ]
-     },
-     "execution_count": 6,
-     "metadata": {},
-     "output_type": "execute_result"
-    }
-   ],
-   "source": [
-    "import numpy as np\n",
-    "idc = np.random.randint(0, len(df))\n",
-    "df.iloc[idc]['Images']"
-   ]
-  },
-  {
-   "cell_type": "code",
-   "execution_count": 7,
-   "metadata": {},
-   "outputs": [],
-   "source": [
-    "df.to_csv(os.path.join(para.csv_path, 'data_train.csv'))"
-   ]
-  },
-  {
-   "cell_type": "markdown",
-   "metadata": {},
-   "source": [
-    "Classes"
-   ]
-  },
-  {
-   "cell_type": "code",
-   "execution_count": 8,
-   "metadata": {},
-   "outputs": [],
-   "source": [
-    "classes = ['Aortic enlargement', 'Atelectasis', 'Calcification', 'Cardiomegaly', 'Consolidation', 'ILD',\n",
-    "              'Infiltration', 'Lung Opacity', 'Nodule Mass', 'Other lesion', 'Pleural effusion', 'Pleural thickening',\n",
-    "              'Pneumothorax', 'Pulmonary fibrosis']\n",
-    "              "
-   ]
-  },
-  {
-   "cell_type": "code",
-   "execution_count": 9,
-   "metadata": {},
-   "outputs": [],
-   "source": [
-    "from pathlib import Path \n",
-    "\n",
-    "np.save(para.output_path + 'columns_14.npy', classes)"
-   ]
-  },
-  {
-   "cell_type": "code",
-   "execution_count": null,
-   "metadata": {},
-   "outputs": [],
-   "source": []
-  }
- ],
- "metadata": {
-  "interpreter": {
-   "hash": "16fd0be27b59a639c645e56c43a95ce42e074baabdf12dcb6efea33a336ac199"
-  },
-  "kernelspec": {
-   "display_name": "Python 3.7.12 ('env1')",
-   "language": "python",
-   "name": "python3"
-  },
-  "language_info": {
-   "codemirror_mode": {
-    "name": "ipython",
-    "version": 3
-   },
-   "file_extension": ".py",
-   "mimetype": "text/x-python",
-   "name": "python",
-   "nbconvert_exporter": "python",
-   "pygments_lexer": "ipython3",
-   "version": "3.7.12"
-  },
-  "orig_nbformat": 4
- },
- "nbformat": 4,
- "nbformat_minor": 2
-}
Index: classifier/training/models/optimizer.py
===================================================================
diff --git a/classifier/training/models/optimizer.py b/classifier/training/models/optimizer.py
deleted file mode 100644
--- a/classifier/training/models/optimizer.py	(revision 914c0e7bb37d00d1a25c112f282b7b36d5b80d23)
+++ /dev/null	(revision 914c0e7bb37d00d1a25c112f282b7b36d5b80d23)
@@ -1,74 +0,0 @@
-from collections import defaultdict
-from itertools import chain
-from torch.optim import Optimizer
-import torch
-import warnings
-
-# Look ahead optimizer
-class Lookahead(Optimizer):
-    def __init__(self, optimizer, k=5, alpha=0.5):
-        self.optimizer = optimizer
-        self.k = k
-        self.alpha = alpha
-        self.param_groups = self.optimizer.param_groups
-        self.state = defaultdict(dict)
-        self.fast_state = self.optimizer.state
-        for group in self.param_groups:
-            group["counter"] = 0
-    
-    def update(self, group):
-        for fast in group["params"]:
-            param_state = self.state[fast]
-            if "slow_param" not in param_state:
-                param_state["slow_param"] = torch.zeros_like(fast.data)
-                param_state["slow_param"].copy_(fast.data)
-            slow = param_state["slow_param"]
-            slow += (fast.data - slow) * self.alpha
-            fast.data.copy_(slow)
-    
-    def update_lookahead(self):
-        for group in self.param_groups:
-            self.update(group)
-
-    def step(self, closure=None):
-        loss = self.optimizer.step(closure)
-        for group in self.param_groups:
-            if group["counter"] == 0:
-                self.update(group)
-            group["counter"] += 1
-            if group["counter"] >= self.k:
-                group["counter"] = 0
-        return loss
-
-    def state_dict(self):
-        fast_state_dict = self.optimizer.state_dict()
-        slow_state = {
-            (id(k) if isinstance(k, torch.Tensor) else k): v
-            for k, v in self.state.items()
-        }
-        fast_state = fast_state_dict["state"]
-        param_groups = fast_state_dict["param_groups"]
-        return {
-            "fast_state": fast_state,
-            "slow_state": slow_state,
-            "param_groups": param_groups,
-        }
-
-    def load_state_dict(self, state_dict):
-        slow_state_dict = {
-            "state": state_dict["slow_state"],
-            "param_groups": state_dict["param_groups"],
-        }
-        fast_state_dict = {
-            "state": state_dict["fast_state"],
-            "param_groups": state_dict["param_groups"],
-        }
-        super(Lookahead, self).load_state_dict(slow_state_dict)
-        self.optimizer.load_state_dict(fast_state_dict)
-        self.fast_state = self.optimizer.state
-
-    def add_param_group(self, param_group):
-        param_group["counter"] = 0
-        self.optimizer.add_param_group(param_group)
-
-        
\ No newline at end of file
Index: scripts/train-chextxay-classifier.sh
===================================================================
diff --git a/scripts/train-chextxay-classifier.sh b/scripts/train-chextxay-classifier.sh
deleted file mode 100644
--- a/scripts/train-chextxay-classifier.sh	(revision 914c0e7bb37d00d1a25c112f282b7b36d5b80d23)
+++ /dev/null	(revision 914c0e7bb37d00d1a25c112f282b7b36d5b80d23)
@@ -1,14 +0,0 @@
-#!/bin/bash
-set -e
-
-python classifier/training/run.py \
-    --model_path output/checkpoints/fold0_20221002.pt \
-    --data_path output/csv/data_train.csv \
-    --config_path configs/config.json \
-    --output_dir output \
-    --do_train True \
-    --do_eval False \
-    --num_train_epochs 10 \
-    --train_batch_size 3 \
-    --eval_batch_size 2 \
-    --save_model True 
Index: classifier/models/classifier.py
===================================================================
diff --git a/classifier/models/classifier.py b/classifier/models/classifier.py
deleted file mode 100644
--- a/classifier/models/classifier.py	(revision 914c0e7bb37d00d1a25c112f282b7b36d5b80d23)
+++ /dev/null	(revision 914c0e7bb37d00d1a25c112f282b7b36d5b80d23)
@@ -1,62 +0,0 @@
-import torch
-import torch.nn as nn
-import sys 
-if not sys.warnoptions:
-  import warnings
-  warnings.simplefilter("ignore")
-
-import numpy as np
-from torchvision.models import densenet121
-
-from classifier.models.modules.commons import GlobalAverage
-from classifier.models.modules.attentions import SAModule
-from classifier.models.chexnet import ChexNet
-from classifier.models.gcn import GCN
-
-def classifier(gcn=True, pretrained_path=None, freeze_feature=False, n_class=14): 
-    # features = densenet121(True).features
-    # final_width = int(features[-1].num_features)
-    # print('final_width', final_width)
-
-    features = ChexNet(trained=True).backbone
-    final_width = ChexNet(trained=True).head[-1].in_features
-    # print('final_width', final_width)
-
-    if gcn:
-      embedding_path = "/Users/HPhuc/Practice/12. classification/vinbigdata/output/embeddings_14.npy"
-      correlation_path = "/Users/HPhuc/Practice/12. classification/vinbigdata/output/correlations_14.npy"
-      embeddings = np.load(embedding_path)
-      corr_matrix = np.load(correlation_path)
-      print("embeddings.shape", embeddings.shape)
-      print("corr_matrix.shape", corr_matrix.shape)
-      classifier = nn.Sequential(*[
-                        GlobalAverage(),
-                        GCN(300, final_width, embeddings, corr_matrix)
-                      ])
-
-    else:
-      classifier = nn.Sequential(*[     
-          GlobalAverage(keepdims=True),
-          nn.Flatten(), 
-          nn.Linear(final_width, n_class), 
-          nn.Sigmoid()
-         ])
-    
-    model = nn.Sequential()
-    model.features = features
-    model.dropout  = nn.Dropout(0.5)
-    model.attention = SAModule(final_width)
-    model.classifier = classifier
-    
-    if pretrained_path is not None:
-        print(f"pretrained_path:", pretrained_path)
-        cp = torch.load(pretrained_path, map_location="cpu")
-        model.load_state_dict(cp['model_state_dict'])
-
-    if freeze_feature:
-      print("Freeze feature")
-      for p in model.features.parameters():
-          p.requires_grad = False
-
-    return model
-
Index: notebooks/preprocess.ipynb
===================================================================
diff --git a/notebooks/preprocess.ipynb b/notebooks/preprocess.ipynb
deleted file mode 100644
--- a/notebooks/preprocess.ipynb	(revision 914c0e7bb37d00d1a25c112f282b7b36d5b80d23)
+++ /dev/null	(revision 914c0e7bb37d00d1a25c112f282b7b36d5b80d23)
@@ -1,1510 +0,0 @@
-{
- "cells": [
-  {
-   "cell_type": "code",
-   "execution_count": 1,
-   "metadata": {},
-   "outputs": [],
-   "source": [
-    "import os \n",
-    "import pandas as pd \n",
-    "import numpy as np \n",
-    "import cv2"
-   ]
-  },
-  {
-   "cell_type": "code",
-   "execution_count": 3,
-   "metadata": {},
-   "outputs": [
-    {
-     "data": {
-      "text/html": [
-       "<div>\n",
-       "<style scoped>\n",
-       "    .dataframe tbody tr th:only-of-type {\n",
-       "        vertical-align: middle;\n",
-       "    }\n",
-       "\n",
-       "    .dataframe tbody tr th {\n",
-       "        vertical-align: top;\n",
-       "    }\n",
-       "\n",
-       "    .dataframe thead th {\n",
-       "        text-align: right;\n",
-       "    }\n",
-       "</style>\n",
-       "<table border=\"1\" class=\"dataframe\">\n",
-       "  <thead>\n",
-       "    <tr style=\"text-align: right;\">\n",
-       "      <th></th>\n",
-       "      <th>image_id</th>\n",
-       "      <th>class_name</th>\n",
-       "    </tr>\n",
-       "  </thead>\n",
-       "  <tbody>\n",
-       "    <tr>\n",
-       "      <th>547</th>\n",
-       "      <td>a259009c4eeacf9ccf4f8db4bf3e7714</td>\n",
-       "      <td>No finding</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>647</th>\n",
-       "      <td>ac2a615b3861212f9a2ada6acd077fd9</td>\n",
-       "      <td>Aortic enlargement</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>1615</th>\n",
-       "      <td>211fb0b1fae0691e21159bcff77672a7</td>\n",
-       "      <td>No finding</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>1617</th>\n",
-       "      <td>003cfe5ce5c0ec5163138eb3b740e328</td>\n",
-       "      <td>No finding</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>2067</th>\n",
-       "      <td>3fb2fa3cceb68338ecf497cb3a2a318d</td>\n",
-       "      <td>No finding</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>...</th>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>66705</th>\n",
-       "      <td>a4bb479ad1e617ee660120484af30947</td>\n",
-       "      <td>No finding</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>66708</th>\n",
-       "      <td>a0af7d64eecad23a41730cef8dbf2f11</td>\n",
-       "      <td>No finding</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>66730</th>\n",
-       "      <td>2bb880f8593d5682e59341514bafceeb</td>\n",
-       "      <td>No finding</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>67603</th>\n",
-       "      <td>8832f86e6472f9110c0c0f3ba2a1a331</td>\n",
-       "      <td>No finding</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>67894</th>\n",
-       "      <td>9b6fdea340adb81532759075f7c4f492</td>\n",
-       "      <td>No finding</td>\n",
-       "    </tr>\n",
-       "  </tbody>\n",
-       "</table>\n",
-       "<p>316 rows × 2 columns</p>\n",
-       "</div>"
-      ],
-      "text/plain": [
-       "                               image_id          class_name\n",
-       "547    a259009c4eeacf9ccf4f8db4bf3e7714          No finding\n",
-       "647    ac2a615b3861212f9a2ada6acd077fd9  Aortic enlargement\n",
-       "1615   211fb0b1fae0691e21159bcff77672a7          No finding\n",
-       "1617   003cfe5ce5c0ec5163138eb3b740e328          No finding\n",
-       "2067   3fb2fa3cceb68338ecf497cb3a2a318d          No finding\n",
-       "...                                 ...                 ...\n",
-       "66705  a4bb479ad1e617ee660120484af30947          No finding\n",
-       "66708  a0af7d64eecad23a41730cef8dbf2f11          No finding\n",
-       "66730  2bb880f8593d5682e59341514bafceeb          No finding\n",
-       "67603  8832f86e6472f9110c0c0f3ba2a1a331          No finding\n",
-       "67894  9b6fdea340adb81532759075f7c4f492          No finding\n",
-       "\n",
-       "[316 rows x 2 columns]"
-      ]
-     },
-     "execution_count": 3,
-     "metadata": {},
-     "output_type": "execute_result"
-    }
-   ],
-   "source": [
-    "train_df = pd.read_csv('/Users/HPhuc/Practice/12. classification/vinbigdata/output/csv/total_data.csv', index_col=0)\n",
-    "train_df = train_df[['image_id', 'class_name']]\n",
-    "train_df"
-   ]
-  },
-  {
-   "cell_type": "code",
-   "execution_count": 4,
-   "metadata": {},
-   "outputs": [
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "100\n"
-     ]
-    },
-    {
-     "data": {
-      "text/html": [
-       "<div>\n",
-       "<style scoped>\n",
-       "    .dataframe tbody tr th:only-of-type {\n",
-       "        vertical-align: middle;\n",
-       "    }\n",
-       "\n",
-       "    .dataframe tbody tr th {\n",
-       "        vertical-align: top;\n",
-       "    }\n",
-       "\n",
-       "    .dataframe thead th {\n",
-       "        text-align: right;\n",
-       "    }\n",
-       "</style>\n",
-       "<table border=\"1\" class=\"dataframe\">\n",
-       "  <thead>\n",
-       "    <tr style=\"text-align: right;\">\n",
-       "      <th></th>\n",
-       "      <th>image_ids</th>\n",
-       "      <th>class_name</th>\n",
-       "    </tr>\n",
-       "  </thead>\n",
-       "  <tbody>\n",
-       "    <tr>\n",
-       "      <th>0</th>\n",
-       "      <td>a259009c4eeacf9ccf4f8db4bf3e7714</td>\n",
-       "      <td>NaN</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>1</th>\n",
-       "      <td>ac2a615b3861212f9a2ada6acd077fd9</td>\n",
-       "      <td>NaN</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>2</th>\n",
-       "      <td>211fb0b1fae0691e21159bcff77672a7</td>\n",
-       "      <td>NaN</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>3</th>\n",
-       "      <td>003cfe5ce5c0ec5163138eb3b740e328</td>\n",
-       "      <td>NaN</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>4</th>\n",
-       "      <td>3fb2fa3cceb68338ecf497cb3a2a318d</td>\n",
-       "      <td>NaN</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>...</th>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>95</th>\n",
-       "      <td>0fa3a43de5d5204d9be82a1969c1b6c8</td>\n",
-       "      <td>NaN</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>96</th>\n",
-       "      <td>d69c970d9c790b8813f5b0d0964e6a55</td>\n",
-       "      <td>NaN</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>97</th>\n",
-       "      <td>a0af7d64eecad23a41730cef8dbf2f11</td>\n",
-       "      <td>NaN</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>98</th>\n",
-       "      <td>fb40ca51c74b4be05cc855629211b406</td>\n",
-       "      <td>NaN</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>99</th>\n",
-       "      <td>c9385d43de0481706fe6084ace25dbbf</td>\n",
-       "      <td>NaN</td>\n",
-       "    </tr>\n",
-       "  </tbody>\n",
-       "</table>\n",
-       "<p>100 rows × 2 columns</p>\n",
-       "</div>"
-      ],
-      "text/plain": [
-       "                           image_ids class_name\n",
-       "0   a259009c4eeacf9ccf4f8db4bf3e7714        NaN\n",
-       "1   ac2a615b3861212f9a2ada6acd077fd9        NaN\n",
-       "2   211fb0b1fae0691e21159bcff77672a7        NaN\n",
-       "3   003cfe5ce5c0ec5163138eb3b740e328        NaN\n",
-       "4   3fb2fa3cceb68338ecf497cb3a2a318d        NaN\n",
-       "..                               ...        ...\n",
-       "95  0fa3a43de5d5204d9be82a1969c1b6c8        NaN\n",
-       "96  d69c970d9c790b8813f5b0d0964e6a55        NaN\n",
-       "97  a0af7d64eecad23a41730cef8dbf2f11        NaN\n",
-       "98  fb40ca51c74b4be05cc855629211b406        NaN\n",
-       "99  c9385d43de0481706fe6084ace25dbbf        NaN\n",
-       "\n",
-       "[100 rows x 2 columns]"
-      ]
-     },
-     "execution_count": 4,
-     "metadata": {},
-     "output_type": "execute_result"
-    }
-   ],
-   "source": [
-    "ids_ = train_df['image_id'].unique()\n",
-    "print(len(ids_))\n",
-    "data = pd.DataFrame(columns=['image_ids', 'class_name'])\n",
-    "data['image_ids'] = ids_\n",
-    "data"
-   ]
-  },
-  {
-   "cell_type": "code",
-   "execution_count": 5,
-   "metadata": {},
-   "outputs": [
-    {
-     "data": {
-      "text/html": [
-       "<div>\n",
-       "<style scoped>\n",
-       "    .dataframe tbody tr th:only-of-type {\n",
-       "        vertical-align: middle;\n",
-       "    }\n",
-       "\n",
-       "    .dataframe tbody tr th {\n",
-       "        vertical-align: top;\n",
-       "    }\n",
-       "\n",
-       "    .dataframe thead th {\n",
-       "        text-align: right;\n",
-       "    }\n",
-       "</style>\n",
-       "<table border=\"1\" class=\"dataframe\">\n",
-       "  <thead>\n",
-       "    <tr style=\"text-align: right;\">\n",
-       "      <th></th>\n",
-       "      <th>image_ids</th>\n",
-       "      <th>class_name</th>\n",
-       "    </tr>\n",
-       "  </thead>\n",
-       "  <tbody>\n",
-       "    <tr>\n",
-       "      <th>0</th>\n",
-       "      <td>a259009c4eeacf9ccf4f8db4bf3e7714</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>1</th>\n",
-       "      <td>ac2a615b3861212f9a2ada6acd077fd9</td>\n",
-       "      <td>[Aortic enlargement, Pleural thickening, Pleur...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>2</th>\n",
-       "      <td>211fb0b1fae0691e21159bcff77672a7</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>3</th>\n",
-       "      <td>003cfe5ce5c0ec5163138eb3b740e328</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>4</th>\n",
-       "      <td>3fb2fa3cceb68338ecf497cb3a2a318d</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>...</th>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>95</th>\n",
-       "      <td>0fa3a43de5d5204d9be82a1969c1b6c8</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>96</th>\n",
-       "      <td>d69c970d9c790b8813f5b0d0964e6a55</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>97</th>\n",
-       "      <td>a0af7d64eecad23a41730cef8dbf2f11</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>98</th>\n",
-       "      <td>fb40ca51c74b4be05cc855629211b406</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>99</th>\n",
-       "      <td>c9385d43de0481706fe6084ace25dbbf</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "    </tr>\n",
-       "  </tbody>\n",
-       "</table>\n",
-       "<p>100 rows × 2 columns</p>\n",
-       "</div>"
-      ],
-      "text/plain": [
-       "                           image_ids  \\\n",
-       "0   a259009c4eeacf9ccf4f8db4bf3e7714   \n",
-       "1   ac2a615b3861212f9a2ada6acd077fd9   \n",
-       "2   211fb0b1fae0691e21159bcff77672a7   \n",
-       "3   003cfe5ce5c0ec5163138eb3b740e328   \n",
-       "4   3fb2fa3cceb68338ecf497cb3a2a318d   \n",
-       "..                               ...   \n",
-       "95  0fa3a43de5d5204d9be82a1969c1b6c8   \n",
-       "96  d69c970d9c790b8813f5b0d0964e6a55   \n",
-       "97  a0af7d64eecad23a41730cef8dbf2f11   \n",
-       "98  fb40ca51c74b4be05cc855629211b406   \n",
-       "99  c9385d43de0481706fe6084ace25dbbf   \n",
-       "\n",
-       "                                           class_name  \n",
-       "0                [No finding, No finding, No finding]  \n",
-       "1   [Aortic enlargement, Pleural thickening, Pleur...  \n",
-       "2                [No finding, No finding, No finding]  \n",
-       "3                [No finding, No finding, No finding]  \n",
-       "4                [No finding, No finding, No finding]  \n",
-       "..                                                ...  \n",
-       "95               [No finding, No finding, No finding]  \n",
-       "96               [No finding, No finding, No finding]  \n",
-       "97               [No finding, No finding, No finding]  \n",
-       "98               [No finding, No finding, No finding]  \n",
-       "99               [No finding, No finding, No finding]  \n",
-       "\n",
-       "[100 rows x 2 columns]"
-      ]
-     },
-     "execution_count": 5,
-     "metadata": {},
-     "output_type": "execute_result"
-    }
-   ],
-   "source": [
-    "for idc, id_ in enumerate(ids_):\n",
-    "    data.loc[idc,'class_name'] = train_df[train_df.image_id == str(id_)].class_name.values\n",
-    "    \n",
-    "data "
-   ]
-  },
-  {
-   "cell_type": "code",
-   "execution_count": 6,
-   "metadata": {},
-   "outputs": [
-    {
-     "data": {
-      "text/html": [
-       "<div>\n",
-       "<style scoped>\n",
-       "    .dataframe tbody tr th:only-of-type {\n",
-       "        vertical-align: middle;\n",
-       "    }\n",
-       "\n",
-       "    .dataframe tbody tr th {\n",
-       "        vertical-align: top;\n",
-       "    }\n",
-       "\n",
-       "    .dataframe thead th {\n",
-       "        text-align: right;\n",
-       "    }\n",
-       "</style>\n",
-       "<table border=\"1\" class=\"dataframe\">\n",
-       "  <thead>\n",
-       "    <tr style=\"text-align: right;\">\n",
-       "      <th></th>\n",
-       "      <th>image_ids</th>\n",
-       "      <th>class_name</th>\n",
-       "      <th>Aortic enlargement</th>\n",
-       "      <th>Atelectasis</th>\n",
-       "      <th>Calcification</th>\n",
-       "      <th>Cardiomegaly</th>\n",
-       "      <th>Consolidation</th>\n",
-       "      <th>ILD</th>\n",
-       "      <th>Infiltration</th>\n",
-       "      <th>Lung Opacity</th>\n",
-       "      <th>Nodule/Mass</th>\n",
-       "      <th>Other lesion</th>\n",
-       "      <th>Pleural effusion</th>\n",
-       "      <th>Pleural thickening</th>\n",
-       "      <th>Pneumothorax</th>\n",
-       "      <th>Pulmonary fibrosis</th>\n",
-       "    </tr>\n",
-       "  </thead>\n",
-       "  <tbody>\n",
-       "    <tr>\n",
-       "      <th>0</th>\n",
-       "      <td>a259009c4eeacf9ccf4f8db4bf3e7714</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>1</th>\n",
-       "      <td>ac2a615b3861212f9a2ada6acd077fd9</td>\n",
-       "      <td>[Aortic enlargement, Pleural thickening, Pleur...</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>2</th>\n",
-       "      <td>211fb0b1fae0691e21159bcff77672a7</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>3</th>\n",
-       "      <td>003cfe5ce5c0ec5163138eb3b740e328</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>4</th>\n",
-       "      <td>3fb2fa3cceb68338ecf497cb3a2a318d</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>...</th>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>95</th>\n",
-       "      <td>0fa3a43de5d5204d9be82a1969c1b6c8</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>96</th>\n",
-       "      <td>d69c970d9c790b8813f5b0d0964e6a55</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>97</th>\n",
-       "      <td>a0af7d64eecad23a41730cef8dbf2f11</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>98</th>\n",
-       "      <td>fb40ca51c74b4be05cc855629211b406</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>99</th>\n",
-       "      <td>c9385d43de0481706fe6084ace25dbbf</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "    </tr>\n",
-       "  </tbody>\n",
-       "</table>\n",
-       "<p>100 rows × 16 columns</p>\n",
-       "</div>"
-      ],
-      "text/plain": [
-       "                           image_ids  \\\n",
-       "0   a259009c4eeacf9ccf4f8db4bf3e7714   \n",
-       "1   ac2a615b3861212f9a2ada6acd077fd9   \n",
-       "2   211fb0b1fae0691e21159bcff77672a7   \n",
-       "3   003cfe5ce5c0ec5163138eb3b740e328   \n",
-       "4   3fb2fa3cceb68338ecf497cb3a2a318d   \n",
-       "..                               ...   \n",
-       "95  0fa3a43de5d5204d9be82a1969c1b6c8   \n",
-       "96  d69c970d9c790b8813f5b0d0964e6a55   \n",
-       "97  a0af7d64eecad23a41730cef8dbf2f11   \n",
-       "98  fb40ca51c74b4be05cc855629211b406   \n",
-       "99  c9385d43de0481706fe6084ace25dbbf   \n",
-       "\n",
-       "                                           class_name  Aortic enlargement  \\\n",
-       "0                [No finding, No finding, No finding]                 0.0   \n",
-       "1   [Aortic enlargement, Pleural thickening, Pleur...                 1.0   \n",
-       "2                [No finding, No finding, No finding]                 0.0   \n",
-       "3                [No finding, No finding, No finding]                 0.0   \n",
-       "4                [No finding, No finding, No finding]                 0.0   \n",
-       "..                                                ...                 ...   \n",
-       "95               [No finding, No finding, No finding]                 0.0   \n",
-       "96               [No finding, No finding, No finding]                 0.0   \n",
-       "97               [No finding, No finding, No finding]                 0.0   \n",
-       "98               [No finding, No finding, No finding]                 0.0   \n",
-       "99               [No finding, No finding, No finding]                 0.0   \n",
-       "\n",
-       "    Atelectasis  Calcification  Cardiomegaly  Consolidation  ILD  \\\n",
-       "0           0.0            0.0           0.0            0.0  0.0   \n",
-       "1           0.0            0.0           1.0            0.0  0.0   \n",
-       "2           0.0            0.0           0.0            0.0  0.0   \n",
-       "3           0.0            0.0           0.0            0.0  0.0   \n",
-       "4           0.0            0.0           0.0            0.0  0.0   \n",
-       "..          ...            ...           ...            ...  ...   \n",
-       "95          0.0            0.0           0.0            0.0  0.0   \n",
-       "96          0.0            0.0           0.0            0.0  0.0   \n",
-       "97          0.0            0.0           0.0            0.0  0.0   \n",
-       "98          0.0            0.0           0.0            0.0  0.0   \n",
-       "99          0.0            0.0           0.0            0.0  0.0   \n",
-       "\n",
-       "    Infiltration  Lung Opacity  Nodule/Mass  Other lesion  Pleural effusion  \\\n",
-       "0            0.0           0.0          0.0           0.0               0.0   \n",
-       "1            1.0           1.0          0.0           0.0               0.0   \n",
-       "2            0.0           0.0          0.0           0.0               0.0   \n",
-       "3            0.0           0.0          0.0           0.0               0.0   \n",
-       "4            0.0           0.0          0.0           0.0               0.0   \n",
-       "..           ...           ...          ...           ...               ...   \n",
-       "95           0.0           0.0          0.0           0.0               0.0   \n",
-       "96           0.0           0.0          0.0           0.0               0.0   \n",
-       "97           0.0           0.0          0.0           0.0               0.0   \n",
-       "98           0.0           0.0          0.0           0.0               0.0   \n",
-       "99           0.0           0.0          0.0           0.0               0.0   \n",
-       "\n",
-       "    Pleural thickening  Pneumothorax  Pulmonary fibrosis  \n",
-       "0                  0.0           0.0                 0.0  \n",
-       "1                  1.0           0.0                 0.0  \n",
-       "2                  0.0           0.0                 0.0  \n",
-       "3                  0.0           0.0                 0.0  \n",
-       "4                  0.0           0.0                 0.0  \n",
-       "..                 ...           ...                 ...  \n",
-       "95                 0.0           0.0                 0.0  \n",
-       "96                 0.0           0.0                 0.0  \n",
-       "97                 0.0           0.0                 0.0  \n",
-       "98                 0.0           0.0                 0.0  \n",
-       "99                 0.0           0.0                 0.0  \n",
-       "\n",
-       "[100 rows x 16 columns]"
-      ]
-     },
-     "execution_count": 6,
-     "metadata": {},
-     "output_type": "execute_result"
-    }
-   ],
-   "source": [
-    "classes = ['Aortic enlargement', 'Atelectasis', 'Calcification', 'Cardiomegaly', 'Consolidation', 'ILD',\n",
-    "              'Infiltration', 'Lung Opacity', 'Nodule/Mass', 'Other lesion', 'Pleural effusion', 'Pleural thickening',\n",
-    "              'Pneumothorax', 'Pulmonary fibrosis']\n",
-    "\n",
-    "for idc in range(0, len(data)):\n",
-    "    for c in classes:\n",
-    "        data.loc[idc, c] = 1 if c in data.loc[idc, 'class_name'] else 0\n",
-    "\n",
-    "data "
-   ]
-  },
-  {
-   "cell_type": "code",
-   "execution_count": 7,
-   "metadata": {},
-   "outputs": [
-    {
-     "data": {
-      "text/html": [
-       "<div>\n",
-       "<style scoped>\n",
-       "    .dataframe tbody tr th:only-of-type {\n",
-       "        vertical-align: middle;\n",
-       "    }\n",
-       "\n",
-       "    .dataframe tbody tr th {\n",
-       "        vertical-align: top;\n",
-       "    }\n",
-       "\n",
-       "    .dataframe thead th {\n",
-       "        text-align: right;\n",
-       "    }\n",
-       "</style>\n",
-       "<table border=\"1\" class=\"dataframe\">\n",
-       "  <thead>\n",
-       "    <tr style=\"text-align: right;\">\n",
-       "      <th></th>\n",
-       "      <th>image_ids</th>\n",
-       "      <th>class_name</th>\n",
-       "      <th>Aortic enlargement</th>\n",
-       "      <th>Atelectasis</th>\n",
-       "      <th>Calcification</th>\n",
-       "      <th>Cardiomegaly</th>\n",
-       "      <th>Consolidation</th>\n",
-       "      <th>ILD</th>\n",
-       "      <th>Infiltration</th>\n",
-       "      <th>Lung Opacity</th>\n",
-       "      <th>Nodule/Mass</th>\n",
-       "      <th>Other lesion</th>\n",
-       "      <th>Pleural effusion</th>\n",
-       "      <th>Pleural thickening</th>\n",
-       "      <th>Pneumothorax</th>\n",
-       "      <th>Pulmonary fibrosis</th>\n",
-       "      <th>image_paths</th>\n",
-       "    </tr>\n",
-       "  </thead>\n",
-       "  <tbody>\n",
-       "    <tr>\n",
-       "      <th>0</th>\n",
-       "      <td>a259009c4eeacf9ccf4f8db4bf3e7714</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>1</th>\n",
-       "      <td>ac2a615b3861212f9a2ada6acd077fd9</td>\n",
-       "      <td>[Aortic enlargement, Pleural thickening, Pleur...</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>2</th>\n",
-       "      <td>211fb0b1fae0691e21159bcff77672a7</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>3</th>\n",
-       "      <td>003cfe5ce5c0ec5163138eb3b740e328</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>4</th>\n",
-       "      <td>3fb2fa3cceb68338ecf497cb3a2a318d</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>...</th>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>95</th>\n",
-       "      <td>0fa3a43de5d5204d9be82a1969c1b6c8</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>96</th>\n",
-       "      <td>d69c970d9c790b8813f5b0d0964e6a55</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>97</th>\n",
-       "      <td>a0af7d64eecad23a41730cef8dbf2f11</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>98</th>\n",
-       "      <td>fb40ca51c74b4be05cc855629211b406</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>99</th>\n",
-       "      <td>c9385d43de0481706fe6084ace25dbbf</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "  </tbody>\n",
-       "</table>\n",
-       "<p>100 rows × 17 columns</p>\n",
-       "</div>"
-      ],
-      "text/plain": [
-       "                           image_ids  \\\n",
-       "0   a259009c4eeacf9ccf4f8db4bf3e7714   \n",
-       "1   ac2a615b3861212f9a2ada6acd077fd9   \n",
-       "2   211fb0b1fae0691e21159bcff77672a7   \n",
-       "3   003cfe5ce5c0ec5163138eb3b740e328   \n",
-       "4   3fb2fa3cceb68338ecf497cb3a2a318d   \n",
-       "..                               ...   \n",
-       "95  0fa3a43de5d5204d9be82a1969c1b6c8   \n",
-       "96  d69c970d9c790b8813f5b0d0964e6a55   \n",
-       "97  a0af7d64eecad23a41730cef8dbf2f11   \n",
-       "98  fb40ca51c74b4be05cc855629211b406   \n",
-       "99  c9385d43de0481706fe6084ace25dbbf   \n",
-       "\n",
-       "                                           class_name  Aortic enlargement  \\\n",
-       "0                [No finding, No finding, No finding]                 0.0   \n",
-       "1   [Aortic enlargement, Pleural thickening, Pleur...                 1.0   \n",
-       "2                [No finding, No finding, No finding]                 0.0   \n",
-       "3                [No finding, No finding, No finding]                 0.0   \n",
-       "4                [No finding, No finding, No finding]                 0.0   \n",
-       "..                                                ...                 ...   \n",
-       "95               [No finding, No finding, No finding]                 0.0   \n",
-       "96               [No finding, No finding, No finding]                 0.0   \n",
-       "97               [No finding, No finding, No finding]                 0.0   \n",
-       "98               [No finding, No finding, No finding]                 0.0   \n",
-       "99               [No finding, No finding, No finding]                 0.0   \n",
-       "\n",
-       "    Atelectasis  Calcification  Cardiomegaly  Consolidation  ILD  \\\n",
-       "0           0.0            0.0           0.0            0.0  0.0   \n",
-       "1           0.0            0.0           1.0            0.0  0.0   \n",
-       "2           0.0            0.0           0.0            0.0  0.0   \n",
-       "3           0.0            0.0           0.0            0.0  0.0   \n",
-       "4           0.0            0.0           0.0            0.0  0.0   \n",
-       "..          ...            ...           ...            ...  ...   \n",
-       "95          0.0            0.0           0.0            0.0  0.0   \n",
-       "96          0.0            0.0           0.0            0.0  0.0   \n",
-       "97          0.0            0.0           0.0            0.0  0.0   \n",
-       "98          0.0            0.0           0.0            0.0  0.0   \n",
-       "99          0.0            0.0           0.0            0.0  0.0   \n",
-       "\n",
-       "    Infiltration  Lung Opacity  Nodule/Mass  Other lesion  Pleural effusion  \\\n",
-       "0            0.0           0.0          0.0           0.0               0.0   \n",
-       "1            1.0           1.0          0.0           0.0               0.0   \n",
-       "2            0.0           0.0          0.0           0.0               0.0   \n",
-       "3            0.0           0.0          0.0           0.0               0.0   \n",
-       "4            0.0           0.0          0.0           0.0               0.0   \n",
-       "..           ...           ...          ...           ...               ...   \n",
-       "95           0.0           0.0          0.0           0.0               0.0   \n",
-       "96           0.0           0.0          0.0           0.0               0.0   \n",
-       "97           0.0           0.0          0.0           0.0               0.0   \n",
-       "98           0.0           0.0          0.0           0.0               0.0   \n",
-       "99           0.0           0.0          0.0           0.0               0.0   \n",
-       "\n",
-       "    Pleural thickening  Pneumothorax  Pulmonary fibrosis  \\\n",
-       "0                  0.0           0.0                 0.0   \n",
-       "1                  1.0           0.0                 0.0   \n",
-       "2                  0.0           0.0                 0.0   \n",
-       "3                  0.0           0.0                 0.0   \n",
-       "4                  0.0           0.0                 0.0   \n",
-       "..                 ...           ...                 ...   \n",
-       "95                 0.0           0.0                 0.0   \n",
-       "96                 0.0           0.0                 0.0   \n",
-       "97                 0.0           0.0                 0.0   \n",
-       "98                 0.0           0.0                 0.0   \n",
-       "99                 0.0           0.0                 0.0   \n",
-       "\n",
-       "                                          image_paths  \n",
-       "0   /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "1   /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "2   /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "3   /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "4   /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "..                                                ...  \n",
-       "95  /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "96  /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "97  /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "98  /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "99  /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "\n",
-       "[100 rows x 17 columns]"
-      ]
-     },
-     "execution_count": 7,
-     "metadata": {},
-     "output_type": "execute_result"
-    }
-   ],
-   "source": [
-    "train_path = '/Users/HPhuc/Practice/12. classification/vinbigdata/data/train/'\n",
-    "data['image_paths'] = f'{train_path}' + data['image_ids'] + '.png'\n",
-    "data "
-   ]
-  },
-  {
-   "cell_type": "code",
-   "execution_count": 8,
-   "metadata": {},
-   "outputs": [
-    {
-     "data": {
-      "text/html": [
-       "<div>\n",
-       "<style scoped>\n",
-       "    .dataframe tbody tr th:only-of-type {\n",
-       "        vertical-align: middle;\n",
-       "    }\n",
-       "\n",
-       "    .dataframe tbody tr th {\n",
-       "        vertical-align: top;\n",
-       "    }\n",
-       "\n",
-       "    .dataframe thead th {\n",
-       "        text-align: right;\n",
-       "    }\n",
-       "</style>\n",
-       "<table border=\"1\" class=\"dataframe\">\n",
-       "  <thead>\n",
-       "    <tr style=\"text-align: right;\">\n",
-       "      <th></th>\n",
-       "      <th>image_ids</th>\n",
-       "      <th>class_name</th>\n",
-       "      <th>Aortic enlargement</th>\n",
-       "      <th>Atelectasis</th>\n",
-       "      <th>Calcification</th>\n",
-       "      <th>Cardiomegaly</th>\n",
-       "      <th>Consolidation</th>\n",
-       "      <th>ILD</th>\n",
-       "      <th>Infiltration</th>\n",
-       "      <th>Lung Opacity</th>\n",
-       "      <th>Nodule Mass</th>\n",
-       "      <th>Other lesion</th>\n",
-       "      <th>Pleural effusion</th>\n",
-       "      <th>Pleural thickening</th>\n",
-       "      <th>Pneumothorax</th>\n",
-       "      <th>Pulmonary fibrosis</th>\n",
-       "      <th>image_paths</th>\n",
-       "    </tr>\n",
-       "  </thead>\n",
-       "  <tbody>\n",
-       "    <tr>\n",
-       "      <th>0</th>\n",
-       "      <td>a259009c4eeacf9ccf4f8db4bf3e7714</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>1</th>\n",
-       "      <td>ac2a615b3861212f9a2ada6acd077fd9</td>\n",
-       "      <td>[Aortic enlargement, Pleural thickening, Pleur...</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>1.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>2</th>\n",
-       "      <td>211fb0b1fae0691e21159bcff77672a7</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>3</th>\n",
-       "      <td>003cfe5ce5c0ec5163138eb3b740e328</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>4</th>\n",
-       "      <td>3fb2fa3cceb68338ecf497cb3a2a318d</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>...</th>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>95</th>\n",
-       "      <td>0fa3a43de5d5204d9be82a1969c1b6c8</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>96</th>\n",
-       "      <td>d69c970d9c790b8813f5b0d0964e6a55</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>97</th>\n",
-       "      <td>a0af7d64eecad23a41730cef8dbf2f11</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>98</th>\n",
-       "      <td>fb40ca51c74b4be05cc855629211b406</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>99</th>\n",
-       "      <td>c9385d43de0481706fe6084ace25dbbf</td>\n",
-       "      <td>[No finding, No finding, No finding]</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>0.0</td>\n",
-       "      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\n",
-       "    </tr>\n",
-       "  </tbody>\n",
-       "</table>\n",
-       "<p>100 rows × 17 columns</p>\n",
-       "</div>"
-      ],
-      "text/plain": [
-       "                           image_ids  \\\n",
-       "0   a259009c4eeacf9ccf4f8db4bf3e7714   \n",
-       "1   ac2a615b3861212f9a2ada6acd077fd9   \n",
-       "2   211fb0b1fae0691e21159bcff77672a7   \n",
-       "3   003cfe5ce5c0ec5163138eb3b740e328   \n",
-       "4   3fb2fa3cceb68338ecf497cb3a2a318d   \n",
-       "..                               ...   \n",
-       "95  0fa3a43de5d5204d9be82a1969c1b6c8   \n",
-       "96  d69c970d9c790b8813f5b0d0964e6a55   \n",
-       "97  a0af7d64eecad23a41730cef8dbf2f11   \n",
-       "98  fb40ca51c74b4be05cc855629211b406   \n",
-       "99  c9385d43de0481706fe6084ace25dbbf   \n",
-       "\n",
-       "                                           class_name  Aortic enlargement  \\\n",
-       "0                [No finding, No finding, No finding]                 0.0   \n",
-       "1   [Aortic enlargement, Pleural thickening, Pleur...                 1.0   \n",
-       "2                [No finding, No finding, No finding]                 0.0   \n",
-       "3                [No finding, No finding, No finding]                 0.0   \n",
-       "4                [No finding, No finding, No finding]                 0.0   \n",
-       "..                                                ...                 ...   \n",
-       "95               [No finding, No finding, No finding]                 0.0   \n",
-       "96               [No finding, No finding, No finding]                 0.0   \n",
-       "97               [No finding, No finding, No finding]                 0.0   \n",
-       "98               [No finding, No finding, No finding]                 0.0   \n",
-       "99               [No finding, No finding, No finding]                 0.0   \n",
-       "\n",
-       "    Atelectasis  Calcification  Cardiomegaly  Consolidation  ILD  \\\n",
-       "0           0.0            0.0           0.0            0.0  0.0   \n",
-       "1           0.0            0.0           1.0            0.0  0.0   \n",
-       "2           0.0            0.0           0.0            0.0  0.0   \n",
-       "3           0.0            0.0           0.0            0.0  0.0   \n",
-       "4           0.0            0.0           0.0            0.0  0.0   \n",
-       "..          ...            ...           ...            ...  ...   \n",
-       "95          0.0            0.0           0.0            0.0  0.0   \n",
-       "96          0.0            0.0           0.0            0.0  0.0   \n",
-       "97          0.0            0.0           0.0            0.0  0.0   \n",
-       "98          0.0            0.0           0.0            0.0  0.0   \n",
-       "99          0.0            0.0           0.0            0.0  0.0   \n",
-       "\n",
-       "    Infiltration  Lung Opacity  Nodule Mass  Other lesion  Pleural effusion  \\\n",
-       "0            0.0           0.0          0.0           0.0               0.0   \n",
-       "1            1.0           1.0          0.0           0.0               0.0   \n",
-       "2            0.0           0.0          0.0           0.0               0.0   \n",
-       "3            0.0           0.0          0.0           0.0               0.0   \n",
-       "4            0.0           0.0          0.0           0.0               0.0   \n",
-       "..           ...           ...          ...           ...               ...   \n",
-       "95           0.0           0.0          0.0           0.0               0.0   \n",
-       "96           0.0           0.0          0.0           0.0               0.0   \n",
-       "97           0.0           0.0          0.0           0.0               0.0   \n",
-       "98           0.0           0.0          0.0           0.0               0.0   \n",
-       "99           0.0           0.0          0.0           0.0               0.0   \n",
-       "\n",
-       "    Pleural thickening  Pneumothorax  Pulmonary fibrosis  \\\n",
-       "0                  0.0           0.0                 0.0   \n",
-       "1                  1.0           0.0                 0.0   \n",
-       "2                  0.0           0.0                 0.0   \n",
-       "3                  0.0           0.0                 0.0   \n",
-       "4                  0.0           0.0                 0.0   \n",
-       "..                 ...           ...                 ...   \n",
-       "95                 0.0           0.0                 0.0   \n",
-       "96                 0.0           0.0                 0.0   \n",
-       "97                 0.0           0.0                 0.0   \n",
-       "98                 0.0           0.0                 0.0   \n",
-       "99                 0.0           0.0                 0.0   \n",
-       "\n",
-       "                                          image_paths  \n",
-       "0   /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "1   /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "2   /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "3   /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "4   /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "..                                                ...  \n",
-       "95  /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "96  /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "97  /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "98  /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "99  /Users/HPhuc/Practice/12. classification/vinbi...  \n",
-       "\n",
-       "[100 rows x 17 columns]"
-      ]
-     },
-     "execution_count": 8,
-     "metadata": {},
-     "output_type": "execute_result"
-    }
-   ],
-   "source": [
-    "data = data.rename(columns={'Nodule/Mass': 'Nodule Mass'})\n",
-    "\n",
-    "import parameter as para \n",
-    "data.to_csv(os.path.join(para.csv_path, 'data_train.csv')) \n",
-    "data        "
-   ]
-  },
-  {
-   "cell_type": "code",
-   "execution_count": null,
-   "metadata": {},
-   "outputs": [],
-   "source": []
-  },
-  {
-   "cell_type": "code",
-   "execution_count": null,
-   "metadata": {},
-   "outputs": [],
-   "source": []
-  }
- ],
- "metadata": {
-  "interpreter": {
-   "hash": "1065cd61f4fbf1eab7a9bc88e7524a6479972e6508f98f8d7dc39b91729afe7a"
-  },
-  "kernelspec": {
-   "display_name": "Python 3.8.5 ('base')",
-   "language": "python",
-   "name": "python3"
-  },
-  "language_info": {
-   "codemirror_mode": {
-    "name": "ipython",
-    "version": 3
-   },
-   "file_extension": ".py",
-   "mimetype": "text/x-python",
-   "name": "python",
-   "nbconvert_exporter": "python",
-   "pygments_lexer": "ipython3",
-   "version": "3.8.5"
-  },
-  "orig_nbformat": 4
- },
- "nbformat": 4,
- "nbformat_minor": 2
-}
Index: notebooks/weights.ipynb
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>{\n \"cells\": [\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 2,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"import pandas as pd \\n\",\n    \"import numpy as np\\n\",\n    \"import os \\n\",\n    \"import sys\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 3,\n   \"metadata\": {},\n   \"outputs\": [\n    {\n     \"data\": {\n      \"text/plain\": [\n       \"array(['Aortic enlargement', 'Atelectasis', 'Calcification',\\n\",\n       \"       'Cardiomegaly', 'Consolidation', 'ILD', 'Infiltration',\\n\",\n       \"       'Lung Opacity', 'Nodule Mass', 'Other lesion', 'Pleural effusion',\\n\",\n       \"       'Pleural thickening', 'Pneumothorax', 'Pulmonary fibrosis'],\\n\",\n       \"      dtype='<U18')\"\n      ]\n     },\n     \"execution_count\": 3,\n     \"metadata\": {},\n     \"output_type\": \"execute_result\"\n    }\n   ],\n   \"source\": [\n    \"classes = np.load('/Users/HPhuc/Practice/12. classification/vinbigdata/output/columns_14.npy')\\n\",\n    \"classes \"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 9,\n   \"metadata\": {},\n   \"outputs\": [\n    {\n     \"data\": {\n      \"text/html\": [\n       \"<div>\\n\",\n       \"<style scoped>\\n\",\n       \"    .dataframe tbody tr th:only-of-type {\\n\",\n       \"        vertical-align: middle;\\n\",\n       \"    }\\n\",\n       \"\\n\",\n       \"    .dataframe tbody tr th {\\n\",\n       \"        vertical-align: top;\\n\",\n       \"    }\\n\",\n       \"\\n\",\n       \"    .dataframe thead th {\\n\",\n       \"        text-align: right;\\n\",\n       \"    }\\n\",\n       \"</style>\\n\",\n       \"<table border=\\\"1\\\" class=\\\"dataframe\\\">\\n\",\n       \"  <thead>\\n\",\n       \"    <tr style=\\\"text-align: right;\\\">\\n\",\n       \"      <th></th>\\n\",\n       \"      <th>image_ids</th>\\n\",\n       \"      <th>Aortic enlargement</th>\\n\",\n       \"      <th>Atelectasis</th>\\n\",\n       \"      <th>Calcification</th>\\n\",\n       \"      <th>Cardiomegaly</th>\\n\",\n       \"      <th>Consolidation</th>\\n\",\n       \"      <th>ILD</th>\\n\",\n       \"      <th>Infiltration</th>\\n\",\n       \"      <th>Lung Opacity</th>\\n\",\n       \"      <th>Nodule Mass</th>\\n\",\n       \"      <th>Other lesion</th>\\n\",\n       \"      <th>Pleural effusion</th>\\n\",\n       \"      <th>Pleural thickening</th>\\n\",\n       \"      <th>Pneumothorax</th>\\n\",\n       \"      <th>Pulmonary fibrosis</th>\\n\",\n       \"      <th>image_paths</th>\\n\",\n       \"      <th>Images</th>\\n\",\n       \"    </tr>\\n\",\n       \"  </thead>\\n\",\n       \"  <tbody>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>0</th>\\n\",\n       \"      <td>50a418190bc3fb1ef1633bf9678929b3</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/vinbig...</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/Source...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>1</th>\\n\",\n       \"      <td>21a10246a5ec7af151081d0cd6d65dc9</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/vinbig...</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/Source...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>2</th>\\n\",\n       \"      <td>9a5094b2563a1ef3ff50dc5c7ff71345</td>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/vinbig...</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/Source...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>3</th>\\n\",\n       \"      <td>051132a778e61a86eb147c7c6f564dfe</td>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/vinbig...</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/Source...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>4</th>\\n\",\n       \"      <td>063319de25ce7edb9b1c6b8881290140</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/vinbig...</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/Source...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>...</th>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>14995</th>\\n\",\n       \"      <td>7c0ddf911bdb68fca14d7172486827cb</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/vinbig...</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/Source...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>14996</th>\\n\",\n       \"      <td>209e3a5c73c1195d805dd25d086b3c6d</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/vinbig...</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/Source...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>14997</th>\\n\",\n       \"      <td>1bea772246421c37929f8cbc43dba729</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/vinbig...</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/Source...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>14998</th>\\n\",\n       \"      <td>ae86eabab95525b41b8e79883ff1cef9</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/vinbig...</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/Source...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>14999</th>\\n\",\n       \"      <td>839b2311ffad9bdd9aa98c74aad6e251</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/vinbig...</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/Source...</td>\\n\",\n       \"    </tr>\\n\",\n       \"  </tbody>\\n\",\n       \"</table>\\n\",\n       \"<p>15000 rows × 17 columns</p>\\n\",\n       \"</div>\"\n      ],\n      \"text/plain\": [\n       \"                              image_ids  Aortic enlargement  Atelectasis  \\\\\\n\",\n       \"0      50a418190bc3fb1ef1633bf9678929b3                 0.0          0.0   \\n\",\n       \"1      21a10246a5ec7af151081d0cd6d65dc9                 0.0          0.0   \\n\",\n       \"2      9a5094b2563a1ef3ff50dc5c7ff71345                 1.0          0.0   \\n\",\n       \"3      051132a778e61a86eb147c7c6f564dfe                 1.0          0.0   \\n\",\n       \"4      063319de25ce7edb9b1c6b8881290140                 0.0          0.0   \\n\",\n       \"...                                 ...                 ...          ...   \\n\",\n       \"14995  7c0ddf911bdb68fca14d7172486827cb                 0.0          0.0   \\n\",\n       \"14996  209e3a5c73c1195d805dd25d086b3c6d                 0.0          0.0   \\n\",\n       \"14997  1bea772246421c37929f8cbc43dba729                 0.0          0.0   \\n\",\n       \"14998  ae86eabab95525b41b8e79883ff1cef9                 0.0          0.0   \\n\",\n       \"14999  839b2311ffad9bdd9aa98c74aad6e251                 0.0          0.0   \\n\",\n       \"\\n\",\n       \"       Calcification  Cardiomegaly  Consolidation  ILD  Infiltration  \\\\\\n\",\n       \"0                0.0           0.0            0.0  0.0           0.0   \\n\",\n       \"1                0.0           0.0            0.0  0.0           0.0   \\n\",\n       \"2                0.0           1.0            0.0  0.0           0.0   \\n\",\n       \"3                0.0           1.0            0.0  0.0           0.0   \\n\",\n       \"4                0.0           0.0            0.0  0.0           0.0   \\n\",\n       \"...              ...           ...            ...  ...           ...   \\n\",\n       \"14995            0.0           0.0            0.0  0.0           0.0   \\n\",\n       \"14996            0.0           0.0            0.0  0.0           0.0   \\n\",\n       \"14997            0.0           0.0            0.0  0.0           0.0   \\n\",\n       \"14998            0.0           0.0            0.0  0.0           0.0   \\n\",\n       \"14999            0.0           0.0            0.0  0.0           0.0   \\n\",\n       \"\\n\",\n       \"       Lung Opacity  Nodule Mass  Other lesion  Pleural effusion  \\\\\\n\",\n       \"0               0.0          0.0           0.0               0.0   \\n\",\n       \"1               0.0          0.0           0.0               0.0   \\n\",\n       \"2               0.0          0.0           0.0               1.0   \\n\",\n       \"3               0.0          0.0           0.0               0.0   \\n\",\n       \"4               0.0          0.0           0.0               0.0   \\n\",\n       \"...             ...          ...           ...               ...   \\n\",\n       \"14995           0.0          0.0           0.0               0.0   \\n\",\n       \"14996           0.0          0.0           0.0               0.0   \\n\",\n       \"14997           0.0          0.0           0.0               0.0   \\n\",\n       \"14998           0.0          0.0           0.0               0.0   \\n\",\n       \"14999           0.0          0.0           0.0               0.0   \\n\",\n       \"\\n\",\n       \"       Pleural thickening  Pneumothorax  Pulmonary fibrosis  \\\\\\n\",\n       \"0                     0.0           0.0                 0.0   \\n\",\n       \"1                     0.0           0.0                 0.0   \\n\",\n       \"2                     1.0           0.0                 0.0   \\n\",\n       \"3                     1.0           0.0                 0.0   \\n\",\n       \"4                     0.0           0.0                 0.0   \\n\",\n       \"...                   ...           ...                 ...   \\n\",\n       \"14995                 0.0           0.0                 0.0   \\n\",\n       \"14996                 0.0           0.0                 0.0   \\n\",\n       \"14997                 0.0           0.0                 0.0   \\n\",\n       \"14998                 0.0           0.0                 0.0   \\n\",\n       \"14999                 0.0           0.0                 0.0   \\n\",\n       \"\\n\",\n       \"                                             image_paths  \\\\\\n\",\n       \"0      /content/drive/MyDrive/Classification2D/vinbig...   \\n\",\n       \"1      /content/drive/MyDrive/Classification2D/vinbig...   \\n\",\n       \"2      /content/drive/MyDrive/Classification2D/vinbig...   \\n\",\n       \"3      /content/drive/MyDrive/Classification2D/vinbig...   \\n\",\n       \"4      /content/drive/MyDrive/Classification2D/vinbig...   \\n\",\n       \"...                                                  ...   \\n\",\n       \"14995  /content/drive/MyDrive/Classification2D/vinbig...   \\n\",\n       \"14996  /content/drive/MyDrive/Classification2D/vinbig...   \\n\",\n       \"14997  /content/drive/MyDrive/Classification2D/vinbig...   \\n\",\n       \"14998  /content/drive/MyDrive/Classification2D/vinbig...   \\n\",\n       \"14999  /content/drive/MyDrive/Classification2D/vinbig...   \\n\",\n       \"\\n\",\n       \"                                                  Images  \\n\",\n       \"0      /content/drive/MyDrive/Classification2D/Source...  \\n\",\n       \"1      /content/drive/MyDrive/Classification2D/Source...  \\n\",\n       \"2      /content/drive/MyDrive/Classification2D/Source...  \\n\",\n       \"3      /content/drive/MyDrive/Classification2D/Source...  \\n\",\n       \"4      /content/drive/MyDrive/Classification2D/Source...  \\n\",\n       \"...                                                  ...  \\n\",\n       \"14995  /content/drive/MyDrive/Classification2D/Source...  \\n\",\n       \"14996  /content/drive/MyDrive/Classification2D/Source...  \\n\",\n       \"14997  /content/drive/MyDrive/Classification2D/Source...  \\n\",\n       \"14998  /content/drive/MyDrive/Classification2D/Source...  \\n\",\n       \"14999  /content/drive/MyDrive/Classification2D/Source...  \\n\",\n       \"\\n\",\n       \"[15000 rows x 17 columns]\"\n      ]\n     },\n     \"execution_count\": 9,\n     \"metadata\": {},\n     \"output_type\": \"execute_result\"\n    }\n   ],\n   \"source\": [\n    \"data = pd.read_csv('/Users/HPhuc/Practice/12. classification/vinbigdata/output/csv/data.csv', index_col=0)\\n\",\n    \"data\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 10,\n   \"metadata\": {},\n   \"outputs\": [\n    {\n     \"data\": {\n      \"text/html\": [\n       \"<div>\\n\",\n       \"<style scoped>\\n\",\n       \"    .dataframe tbody tr th:only-of-type {\\n\",\n       \"        vertical-align: middle;\\n\",\n       \"    }\\n\",\n       \"\\n\",\n       \"    .dataframe tbody tr th {\\n\",\n       \"        vertical-align: top;\\n\",\n       \"    }\\n\",\n       \"\\n\",\n       \"    .dataframe thead th {\\n\",\n       \"        text-align: right;\\n\",\n       \"    }\\n\",\n       \"</style>\\n\",\n       \"<table border=\\\"1\\\" class=\\\"dataframe\\\">\\n\",\n       \"  <thead>\\n\",\n       \"    <tr style=\\\"text-align: right;\\\">\\n\",\n       \"      <th></th>\\n\",\n       \"      <th>0.0</th>\\n\",\n       \"      <th>1.0</th>\\n\",\n       \"    </tr>\\n\",\n       \"  </thead>\\n\",\n       \"  <tbody>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Aortic enlargement</th>\\n\",\n       \"      <td>11933</td>\\n\",\n       \"      <td>3067</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Atelectasis</th>\\n\",\n       \"      <td>14814</td>\\n\",\n       \"      <td>186</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Calcification</th>\\n\",\n       \"      <td>14548</td>\\n\",\n       \"      <td>452</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Cardiomegaly</th>\\n\",\n       \"      <td>12700</td>\\n\",\n       \"      <td>2300</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Consolidation</th>\\n\",\n       \"      <td>14647</td>\\n\",\n       \"      <td>353</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>ILD</th>\\n\",\n       \"      <td>14614</td>\\n\",\n       \"      <td>386</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Infiltration</th>\\n\",\n       \"      <td>14387</td>\\n\",\n       \"      <td>613</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Lung Opacity</th>\\n\",\n       \"      <td>13678</td>\\n\",\n       \"      <td>1322</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Nodule Mass</th>\\n\",\n       \"      <td>14174</td>\\n\",\n       \"      <td>826</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Other lesion</th>\\n\",\n       \"      <td>13866</td>\\n\",\n       \"      <td>1134</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Pleural effusion</th>\\n\",\n       \"      <td>13968</td>\\n\",\n       \"      <td>1032</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Pleural thickening</th>\\n\",\n       \"      <td>13019</td>\\n\",\n       \"      <td>1981</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Pneumothorax</th>\\n\",\n       \"      <td>14904</td>\\n\",\n       \"      <td>96</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Pulmonary fibrosis</th>\\n\",\n       \"      <td>13383</td>\\n\",\n       \"      <td>1617</td>\\n\",\n       \"    </tr>\\n\",\n       \"  </tbody>\\n\",\n       \"</table>\\n\",\n       \"</div>\"\n      ],\n      \"text/plain\": [\n       \"                      0.0   1.0\\n\",\n       \"Aortic enlargement  11933  3067\\n\",\n       \"Atelectasis         14814   186\\n\",\n       \"Calcification       14548   452\\n\",\n       \"Cardiomegaly        12700  2300\\n\",\n       \"Consolidation       14647   353\\n\",\n       \"ILD                 14614   386\\n\",\n       \"Infiltration        14387   613\\n\",\n       \"Lung Opacity        13678  1322\\n\",\n       \"Nodule Mass         14174   826\\n\",\n       \"Other lesion        13866  1134\\n\",\n       \"Pleural effusion    13968  1032\\n\",\n       \"Pleural thickening  13019  1981\\n\",\n       \"Pneumothorax        14904    96\\n\",\n       \"Pulmonary fibrosis  13383  1617\"\n      ]\n     },\n     \"execution_count\": 10,\n     \"metadata\": {},\n     \"output_type\": \"execute_result\"\n    }\n   ],\n   \"source\": [\n    \"counts = pd.DataFrame([data[c].value_counts() for c in classes])\\n\",\n    \"counts \"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 11,\n   \"metadata\": {},\n   \"outputs\": [\n    {\n     \"data\": {\n      \"text/html\": [\n       \"<div>\\n\",\n       \"<style scoped>\\n\",\n       \"    .dataframe tbody tr th:only-of-type {\\n\",\n       \"        vertical-align: middle;\\n\",\n       \"    }\\n\",\n       \"\\n\",\n       \"    .dataframe tbody tr th {\\n\",\n       \"        vertical-align: top;\\n\",\n       \"    }\\n\",\n       \"\\n\",\n       \"    .dataframe thead th {\\n\",\n       \"        text-align: right;\\n\",\n       \"    }\\n\",\n       \"</style>\\n\",\n       \"<table border=\\\"1\\\" class=\\\"dataframe\\\">\\n\",\n       \"  <thead>\\n\",\n       \"    <tr style=\\\"text-align: right;\\\">\\n\",\n       \"      <th></th>\\n\",\n       \"      <th>0.0</th>\\n\",\n       \"      <th>1.0</th>\\n\",\n       \"    </tr>\\n\",\n       \"  </thead>\\n\",\n       \"  <tbody>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Aortic enlargement</th>\\n\",\n       \"      <td>0.000122</td>\\n\",\n       \"      <td>0.000361</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Atelectasis</th>\\n\",\n       \"      <td>0.000106</td>\\n\",\n       \"      <td>0.005410</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Calcification</th>\\n\",\n       \"      <td>0.000107</td>\\n\",\n       \"      <td>0.002246</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Cardiomegaly</th>\\n\",\n       \"      <td>0.000117</td>\\n\",\n       \"      <td>0.000469</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Consolidation</th>\\n\",\n       \"      <td>0.000107</td>\\n\",\n       \"      <td>0.002866</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>ILD</th>\\n\",\n       \"      <td>0.000107</td>\\n\",\n       \"      <td>0.002624</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Infiltration</th>\\n\",\n       \"      <td>0.000108</td>\\n\",\n       \"      <td>0.001665</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Lung Opacity</th>\\n\",\n       \"      <td>0.000111</td>\\n\",\n       \"      <td>0.000790</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Nodule Mass</th>\\n\",\n       \"      <td>0.000109</td>\\n\",\n       \"      <td>0.001244</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Other lesion</th>\\n\",\n       \"      <td>0.000111</td>\\n\",\n       \"      <td>0.000916</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Pleural effusion</th>\\n\",\n       \"      <td>0.000110</td>\\n\",\n       \"      <td>0.001003</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Pleural thickening</th>\\n\",\n       \"      <td>0.000115</td>\\n\",\n       \"      <td>0.000539</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Pneumothorax</th>\\n\",\n       \"      <td>0.000106</td>\\n\",\n       \"      <td>0.010450</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Pulmonary fibrosis</th>\\n\",\n       \"      <td>0.000113</td>\\n\",\n       \"      <td>0.000652</td>\\n\",\n       \"    </tr>\\n\",\n       \"  </tbody>\\n\",\n       \"</table>\\n\",\n       \"</div>\"\n      ],\n      \"text/plain\": [\n       \"                         0.0       1.0\\n\",\n       \"Aortic enlargement  0.000122  0.000361\\n\",\n       \"Atelectasis         0.000106  0.005410\\n\",\n       \"Calcification       0.000107  0.002246\\n\",\n       \"Cardiomegaly        0.000117  0.000469\\n\",\n       \"Consolidation       0.000107  0.002866\\n\",\n       \"ILD                 0.000107  0.002624\\n\",\n       \"Infiltration        0.000108  0.001665\\n\",\n       \"Lung Opacity        0.000111  0.000790\\n\",\n       \"Nodule Mass         0.000109  0.001244\\n\",\n       \"Other lesion        0.000111  0.000916\\n\",\n       \"Pleural effusion    0.000110  0.001003\\n\",\n       \"Pleural thickening  0.000115  0.000539\\n\",\n       \"Pneumothorax        0.000106  0.010450\\n\",\n       \"Pulmonary fibrosis  0.000113  0.000652\"\n      ]\n     },\n     \"execution_count\": 11,\n     \"metadata\": {},\n     \"output_type\": \"execute_result\"\n    }\n   ],\n   \"source\": [\n    \"N = counts.iloc[0, 0] + counts.iloc[0, 1] \\n\",\n    \"beta = (N - 1) / N\\n\",\n    \"weights = (1 - beta) / ( 1 - (beta ** counts))\\n\",\n    \"weights \"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 12,\n   \"metadata\": {},\n   \"outputs\": [\n    {\n     \"data\": {\n      \"text/html\": [\n       \"<div>\\n\",\n       \"<style scoped>\\n\",\n       \"    .dataframe tbody tr th:only-of-type {\\n\",\n       \"        vertical-align: middle;\\n\",\n       \"    }\\n\",\n       \"\\n\",\n       \"    .dataframe tbody tr th {\\n\",\n       \"        vertical-align: top;\\n\",\n       \"    }\\n\",\n       \"\\n\",\n       \"    .dataframe thead th {\\n\",\n       \"        text-align: right;\\n\",\n       \"    }\\n\",\n       \"</style>\\n\",\n       \"<table border=\\\"1\\\" class=\\\"dataframe\\\">\\n\",\n       \"  <thead>\\n\",\n       \"    <tr style=\\\"text-align: right;\\\">\\n\",\n       \"      <th></th>\\n\",\n       \"      <th>0.0</th>\\n\",\n       \"      <th>1.0</th>\\n\",\n       \"    </tr>\\n\",\n       \"  </thead>\\n\",\n       \"  <tbody>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Aortic enlargement</th>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>2.967017</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Atelectasis</th>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>50.921016</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Calcification</th>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>20.915692</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Cardiomegaly</th>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>4.017779</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Consolidation</th>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>26.800952</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>ILD</th>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>24.503893</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Infiltration</th>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>15.402668</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Lung Opacity</th>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>7.091168</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Nodule Mass</th>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>11.409301</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Other lesion</th>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>8.284558</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Pleural effusion</th>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>9.113293</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Pleural thickening</th>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>4.689524</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Pneumothorax</th>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>98.713635</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Pulmonary fibrosis</th>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>5.775748</td>\\n\",\n       \"    </tr>\\n\",\n       \"  </tbody>\\n\",\n       \"</table>\\n\",\n       \"</div>\"\n      ],\n      \"text/plain\": [\n       \"                    0.0        1.0\\n\",\n       \"Aortic enlargement  1.0   2.967017\\n\",\n       \"Atelectasis         1.0  50.921016\\n\",\n       \"Calcification       1.0  20.915692\\n\",\n       \"Cardiomegaly        1.0   4.017779\\n\",\n       \"Consolidation       1.0  26.800952\\n\",\n       \"ILD                 1.0  24.503893\\n\",\n       \"Infiltration        1.0  15.402668\\n\",\n       \"Lung Opacity        1.0   7.091168\\n\",\n       \"Nodule Mass         1.0  11.409301\\n\",\n       \"Other lesion        1.0   8.284558\\n\",\n       \"Pleural effusion    1.0   9.113293\\n\",\n       \"Pleural thickening  1.0   4.689524\\n\",\n       \"Pneumothorax        1.0  98.713635\\n\",\n       \"Pulmonary fibrosis  1.0   5.775748\"\n      ]\n     },\n     \"execution_count\": 12,\n     \"metadata\": {},\n     \"output_type\": \"execute_result\"\n    }\n   ],\n   \"source\": [\n    \"normalized_weight = weights / weights.values.sum(axis=1)[:, np.newaxis] * 2 \\n\",\n    \"normalized_weight = normalized_weight / normalized_weight.values[:, 0, np.newaxis]\\n\",\n    \"normalized_weight\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 13,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"from pathlib import Path \\n\",\n    \"import parameter as para \\n\",\n    \"\\n\",\n    \"normalized_weight.to_csv(Path(f'{para.output_path}' + '/weights_14.csv'))\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": null,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": []\n  }\n ],\n \"metadata\": {\n  \"interpreter\": {\n   \"hash\": \"16fd0be27b59a639c645e56c43a95ce42e074baabdf12dcb6efea33a336ac199\"\n  },\n  \"kernelspec\": {\n   \"display_name\": \"Python 3.7.12 ('env1')\",\n   \"language\": \"python\",\n   \"name\": \"python3\"\n  },\n  \"language_info\": {\n   \"codemirror_mode\": {\n    \"name\": \"ipython\",\n    \"version\": 3\n   },\n   \"file_extension\": \".py\",\n   \"mimetype\": \"text/x-python\",\n   \"name\": \"python\",\n   \"nbconvert_exporter\": \"python\",\n   \"pygments_lexer\": \"ipython3\",\n   \"version\": \"3.7.12\"\n  },\n  \"orig_nbformat\": 4\n },\n \"nbformat\": 4,\n \"nbformat_minor\": 2\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/notebooks/weights.ipynb b/notebooks/weights.ipynb
--- a/notebooks/weights.ipynb	(revision 914c0e7bb37d00d1a25c112f282b7b36d5b80d23)
+++ b/notebooks/weights.ipynb	(date 1675851533035)
@@ -823,11 +823,8 @@
   }
  ],
  "metadata": {
-  "interpreter": {
-   "hash": "16fd0be27b59a639c645e56c43a95ce42e074baabdf12dcb6efea33a336ac199"
-  },
   "kernelspec": {
-   "display_name": "Python 3.7.12 ('env1')",
+   "display_name": "venv",
    "language": "python",
    "name": "python3"
   },
@@ -841,9 +838,14 @@
    "name": "python",
    "nbconvert_exporter": "python",
    "pygments_lexer": "ipython3",
-   "version": "3.7.12"
+   "version": "3.7.16"
   },
-  "orig_nbformat": 4
+  "orig_nbformat": 4,
+  "vscode": {
+   "interpreter": {
+    "hash": "572ac709a4723f93826c4758b1d2d0b69d22c7b56265776d12836d04ab7ee591"
+   }
+  }
  },
  "nbformat": 4,
  "nbformat_minor": 2
Index: requirements.txt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>albumentations==1.3.0\nappnope==0.1.2\nbackcall==0.2.0\ncertifi @ file:///private/var/folders/sy/f16zz6x50xz3113nwtb9bvq00000gp/T/abs_0ek9yztvu3/croot/certifi_1665076692562/work/certifi\ncharset-normalizer==2.1.1\nclick==8.1.3\ncycler==0.11.0\ndecorator==4.4.2\ndocker-pycreds==0.4.0\nfilelock==3.8.0\nfonttools==4.38.0\ngitdb==4.0.9\nGitPython==3.1.29\nhuggingface-hub==0.10.1\nidna==3.4\nimageio==2.22.2\nimportlib-metadata==5.0.0\nipython-genutils==0.2.0\njedi==0.18.0\njoblib==1.2.0\nkiwisolver==1.4.4\nmatplotlib==3.5.3\nnetworkx==2.6.3\nnumpy==1.21.6\nopencv-python==4.6.0.66\nopencv-python-headless==4.6.0.66\npackaging==21.3\npandas==1.3.5\nparso==0.8.1\npathtools==0.1.2\npexpect==4.8.0\npickleshare==0.7.5\nPillow==9.2.0\npromise==2.3\nprompt-toolkit==3.0.16\nprotobuf==4.21.9\npsutil==5.9.3\nptyprocess==0.7.0\nPygments==2.8.0\npyparsing==3.0.9\npython-dateutil==2.8.2\npytz==2022.5\nPyWavelets==1.3.0\nPyYAML==6.0\nqudida==0.0.4\nregex==2022.9.13\nrequests==2.28.1\nscikit-image==0.19.3\nscikit-learn==1.0.2\nscipy==1.7.3\nsentry-sdk==1.10.1\nsetproctitle==1.3.2\nshortuuid==1.0.9\nsix==1.16.0\nsmmap==5.0.0\nthreadpoolctl==3.1.0\ntifffile==2021.11.2\ntokenizers==0.13.1\ntorch==1.12.1\ntorchvision==0.13.1\ntqdm==4.64.1\ntransformers==4.23.1\ntyping_extensions==4.4.0\nurllib3==1.26.12\nwandb==0.13.4\nwcwidth==0.2.5\nzipp==3.10.0\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/requirements.txt b/requirements.txt
--- a/requirements.txt	(revision 914c0e7bb37d00d1a25c112f282b7b36d5b80d23)
+++ b/requirements.txt	(date 1676709082671)
@@ -1,67 +1,144 @@
+absl-py==1.4.0
 albumentations==1.3.0
 appnope==0.1.2
+astunparse==1.6.3
+attrs==22.1.0
+autopep8 @ file:///opt/conda/conda-bld/autopep8_1650463822033/work
 backcall==0.2.0
-certifi @ file:///private/var/folders/sy/f16zz6x50xz3113nwtb9bvq00000gp/T/abs_0ek9yztvu3/croot/certifi_1665076692562/work/certifi
+black==22.10.0
+blessed==1.19.1
+cachetools==5.3.0
+certifi @ file:///private/var/folders/sy/f16zz6x50xz3113nwtb9bvq00000gp/T/abs_477u68wvzm/croot/certifi_1671487773341/work/certifi
 charset-normalizer==2.1.1
 click==8.1.3
+colorama==0.4.6
+commonmark==0.9.1
 cycler==0.11.0
+dataclasses==0.6
+debugpy @ file:///opt/concourse/worker/volumes/live/32b11d06-4d64-4ec8-497a-cf4fc97343d2/volume/debugpy_1637091821874/work
 decorator==4.4.2
+Deprecated==1.2.13
 docker-pycreds==0.4.0
+efficientnet-pytorch-3d @ git+https://github.com/shijianjian/EfficientNet-PyTorch-3D@3e79bcd06216b2e831bf3300fff9636cce2cd0d1
+entrypoints @ file:///opt/concourse/worker/volumes/live/194c0a28-55ce-4e83-6a87-0d9f2e06ab2c/volume/entrypoints_1649926487944/work
+fastjsonschema==2.16.2
 filelock==3.8.0
+flatbuffers==23.1.21
 fonttools==4.38.0
+gast==0.4.0
+gensim==4.2.0
 gitdb==4.0.9
 GitPython==3.1.29
+google-auth==2.16.0
+google-auth-oauthlib==0.4.6
+google-pasta==0.2.0
+gpustat==1.0.0
+grpcio==1.51.1
+h5py==3.8.0
 huggingface-hub==0.10.1
+humanize==4.5.0
 idna==3.4
 imageio==2.22.2
 importlib-metadata==5.0.0
+importlib-resources==5.10.0
+ipykernel @ file:///private/var/folders/sy/f16zz6x50xz3113nwtb9bvq00000gp/T/abs_05yte6zd0k/croots/recipe/ipykernel_1662361808878/work
+ipython==7.34.0
 ipython-genutils==0.2.0
+isort==5.11.5
 jedi==0.18.0
 joblib==1.2.0
+jsonschema==4.16.0
+jupyter_client @ file:///private/var/folders/sy/f16zz6x50xz3113nwtb9bvq00000gp/T/abs_8dsejoebqs/croot/jupyter_client_1671703053245/work
+jupyter_core==4.11.2
+keras==2.11.0
 kiwisolver==1.4.4
+libclang==15.0.6.1
+Markdown==3.4.1
+MarkupSafe==2.1.2
 matplotlib==3.5.3
+matplotlib-inline @ file:///private/var/folders/sy/f16zz6x50xz3113nwtb9bvq00000gp/T/abs_9ddl71oqte/croots/recipe/matplotlib-inline_1662014471815/work
+mypy-extensions==0.4.3
+nbformat==5.7.0
+nest-asyncio @ file:///private/var/folders/sy/f16zz6x50xz3113nwtb9bvq00000gp/T/abs_64pfm74mxq/croot/nest-asyncio_1672387129786/work
 networkx==2.6.3
+nibabel==4.0.2
 numpy==1.21.6
+nvidia-ml-py==11.495.46
+oauthlib==3.2.2
 opencv-python==4.6.0.66
 opencv-python-headless==4.6.0.66
+opt-einsum==3.3.0
 packaging==21.3
 pandas==1.3.5
 parso==0.8.1
+pathspec==0.10.1
 pathtools==0.1.2
 pexpect==4.8.0
 pickleshare==0.7.5
 Pillow==9.2.0
+pkgutil_resolve_name==1.3.10
+platformdirs==2.5.2
+plotly==5.11.0
 promise==2.3
 prompt-toolkit==3.0.16
-protobuf==4.21.9
+protobuf==3.19.6
 psutil==5.9.3
 ptyprocess==0.7.0
+pyasn1==0.4.8
+pyasn1-modules==0.2.8
+pycodestyle @ file:///private/var/folders/sy/f16zz6x50xz3113nwtb9bvq00000gp/T/abs_a7riaf725h/croot/pycodestyle_1674267226642/work
 Pygments==2.8.0
 pyparsing==3.0.9
-python-dateutil==2.8.2
+pyrsistent==0.18.1
+python-dateutil @ file:///tmp/build/80754af9/python-dateutil_1626374649649/work
 pytz==2022.5
 PyWavelets==1.3.0
 PyYAML==6.0
+pyzmq @ file:///private/var/folders/sy/f16zz6x50xz3113nwtb9bvq00000gp/T/abs_15f7a459-ad98-422b-b8da-cbf1f626e2115nt0ocwy/croots/recipe/pyzmq_1657724193704/work
 qudida==0.0.4
 regex==2022.9.13
 requests==2.28.1
+requests-oauthlib==1.3.1
+rich==12.6.0
+rsa==4.9
 scikit-image==0.19.3
 scikit-learn==1.0.2
 scipy==1.7.3
 sentry-sdk==1.10.1
 setproctitle==1.3.2
+shellingham==1.5.0.post1
 shortuuid==1.0.9
-six==1.16.0
+SimpleITK==2.2.1
+six @ file:///tmp/build/80754af9/six_1644875935023/work
+smart-open==6.2.0
 smmap==5.0.0
+tenacity==8.1.0
+tensorboard==2.11.2
+tensorboard-data-server==0.6.1
+tensorboard-plugin-wit==1.8.1
+tensorflow==2.11.0
+tensorflow-estimator==2.11.0
+tensorflow-io-gcs-filesystem==0.30.0
+termcolor==2.2.0
 threadpoolctl==3.1.0
 tifffile==2021.11.2
 tokenizers==0.13.1
+toml @ file:///tmp/build/80754af9/toml_1616166611790/work
+tomli==2.0.1
 torch==1.12.1
+torchio==0.18.87
 torchvision==0.13.1
+tornado @ file:///private/var/folders/sy/f16zz6x50xz3113nwtb9bvq00000gp/T/abs_1fimz6o0gc/croots/recipe/tornado_1662061695695/work
 tqdm==4.64.1
-transformers==4.23.1
+traitlets @ file:///private/var/folders/sy/f16zz6x50xz3113nwtb9bvq00000gp/T/abs_0dtilxc0bw/croot/traitlets_1671143889152/work
+transformers==4.25.1
+typed-ast==1.5.4
+typer==0.7.0
 typing_extensions==4.4.0
 urllib3==1.26.12
 wandb==0.13.4
 wcwidth==0.2.5
+Werkzeug==2.2.3
+wikiextractor==3.0.6
+wrapt==1.14.1
 zipp==3.10.0
Index: .gitignore
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>.vscode/*\n!.vscode/settings.json\n!.vscode/tasks.json\n!.vscode/launch.json\n!.vscode/extensions.json\n!.vscode/*.code-snippets\n\n# Local History for Visual Studio Code\n.history/\n\n# Built Visual Studio Code Extensions\n*.vsix\n\nvinbigdata-dataset\noutput/\n\n__pycache__
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.gitignore b/.gitignore
--- a/.gitignore	(revision 914c0e7bb37d00d1a25c112f282b7b36d5b80d23)
+++ b/.gitignore	(date 1685260651805)
@@ -13,5 +13,6 @@
 
 vinbigdata-dataset
 output/
+data
 
 __pycache__
\ No newline at end of file
Index: notebooks/crop_lung.ipynb
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>{\n \"cells\": [\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 1,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"import os \\n\",\n    \"import pandas as pd \\n\",\n    \"import numpy as np \\n\",\n    \"import cv2\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 5,\n   \"metadata\": {},\n   \"outputs\": [\n    {\n     \"data\": {\n      \"text/html\": [\n       \"<div>\\n\",\n       \"<style scoped>\\n\",\n       \"    .dataframe tbody tr th:only-of-type {\\n\",\n       \"        vertical-align: middle;\\n\",\n       \"    }\\n\",\n       \"\\n\",\n       \"    .dataframe tbody tr th {\\n\",\n       \"        vertical-align: top;\\n\",\n       \"    }\\n\",\n       \"\\n\",\n       \"    .dataframe thead th {\\n\",\n       \"        text-align: right;\\n\",\n       \"    }\\n\",\n       \"</style>\\n\",\n       \"<table border=\\\"1\\\" class=\\\"dataframe\\\">\\n\",\n       \"  <thead>\\n\",\n       \"    <tr style=\\\"text-align: right;\\\">\\n\",\n       \"      <th></th>\\n\",\n       \"      <th>image_ids</th>\\n\",\n       \"      <th>class_name</th>\\n\",\n       \"      <th>Aortic enlargement</th>\\n\",\n       \"      <th>Atelectasis</th>\\n\",\n       \"      <th>Calcification</th>\\n\",\n       \"      <th>Cardiomegaly</th>\\n\",\n       \"      <th>Consolidation</th>\\n\",\n       \"      <th>ILD</th>\\n\",\n       \"      <th>Infiltration</th>\\n\",\n       \"      <th>Lung Opacity</th>\\n\",\n       \"      <th>Nodule Mass</th>\\n\",\n       \"      <th>Other lesion</th>\\n\",\n       \"      <th>Pleural effusion</th>\\n\",\n       \"      <th>Pleural thickening</th>\\n\",\n       \"      <th>Pneumothorax</th>\\n\",\n       \"      <th>Pulmonary fibrosis</th>\\n\",\n       \"      <th>image_paths</th>\\n\",\n       \"      <th>Images</th>\\n\",\n       \"    </tr>\\n\",\n       \"  </thead>\\n\",\n       \"  <tbody>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>0</th>\\n\",\n       \"      <td>a259009c4eeacf9ccf4f8db4bf3e7714</td>\\n\",\n       \"      <td>['No finding' 'No finding' 'No finding']</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\\n\",\n       \"      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>1</th>\\n\",\n       \"      <td>ac2a615b3861212f9a2ada6acd077fd9</td>\\n\",\n       \"      <td>['Aortic enlargement' 'Pleural thickening' 'Pl...</td>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\\n\",\n       \"      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>2</th>\\n\",\n       \"      <td>211fb0b1fae0691e21159bcff77672a7</td>\\n\",\n       \"      <td>['No finding' 'No finding' 'No finding']</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\\n\",\n       \"      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>3</th>\\n\",\n       \"      <td>003cfe5ce5c0ec5163138eb3b740e328</td>\\n\",\n       \"      <td>['No finding' 'No finding' 'No finding']</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\\n\",\n       \"      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>4</th>\\n\",\n       \"      <td>3fb2fa3cceb68338ecf497cb3a2a318d</td>\\n\",\n       \"      <td>['No finding' 'No finding' 'No finding']</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\\n\",\n       \"      <td>/Users/HPhuc/Practice/12. classification/vinbi...</td>\\n\",\n       \"    </tr>\\n\",\n       \"  </tbody>\\n\",\n       \"</table>\\n\",\n       \"</div>\"\n      ],\n      \"text/plain\": [\n       \"                          image_ids  \\\\\\n\",\n       \"0  a259009c4eeacf9ccf4f8db4bf3e7714   \\n\",\n       \"1  ac2a615b3861212f9a2ada6acd077fd9   \\n\",\n       \"2  211fb0b1fae0691e21159bcff77672a7   \\n\",\n       \"3  003cfe5ce5c0ec5163138eb3b740e328   \\n\",\n       \"4  3fb2fa3cceb68338ecf497cb3a2a318d   \\n\",\n       \"\\n\",\n       \"                                          class_name  Aortic enlargement  \\\\\\n\",\n       \"0           ['No finding' 'No finding' 'No finding']                 0.0   \\n\",\n       \"1  ['Aortic enlargement' 'Pleural thickening' 'Pl...                 1.0   \\n\",\n       \"2           ['No finding' 'No finding' 'No finding']                 0.0   \\n\",\n       \"3           ['No finding' 'No finding' 'No finding']                 0.0   \\n\",\n       \"4           ['No finding' 'No finding' 'No finding']                 0.0   \\n\",\n       \"\\n\",\n       \"   Atelectasis  Calcification  Cardiomegaly  Consolidation  ILD  Infiltration  \\\\\\n\",\n       \"0          0.0            0.0           0.0            0.0  0.0           0.0   \\n\",\n       \"1          0.0            0.0           1.0            0.0  0.0           1.0   \\n\",\n       \"2          0.0            0.0           0.0            0.0  0.0           0.0   \\n\",\n       \"3          0.0            0.0           0.0            0.0  0.0           0.0   \\n\",\n       \"4          0.0            0.0           0.0            0.0  0.0           0.0   \\n\",\n       \"\\n\",\n       \"   Lung Opacity  Nodule Mass  Other lesion  Pleural effusion  \\\\\\n\",\n       \"0           0.0          0.0           0.0               0.0   \\n\",\n       \"1           1.0          0.0           0.0               0.0   \\n\",\n       \"2           0.0          0.0           0.0               0.0   \\n\",\n       \"3           0.0          0.0           0.0               0.0   \\n\",\n       \"4           0.0          0.0           0.0               0.0   \\n\",\n       \"\\n\",\n       \"   Pleural thickening  Pneumothorax  Pulmonary fibrosis  \\\\\\n\",\n       \"0                 0.0           0.0                 0.0   \\n\",\n       \"1                 1.0           0.0                 0.0   \\n\",\n       \"2                 0.0           0.0                 0.0   \\n\",\n       \"3                 0.0           0.0                 0.0   \\n\",\n       \"4                 0.0           0.0                 0.0   \\n\",\n       \"\\n\",\n       \"                                         image_paths  \\\\\\n\",\n       \"0  /Users/HPhuc/Practice/12. classification/vinbi...   \\n\",\n       \"1  /Users/HPhuc/Practice/12. classification/vinbi...   \\n\",\n       \"2  /Users/HPhuc/Practice/12. classification/vinbi...   \\n\",\n       \"3  /Users/HPhuc/Practice/12. classification/vinbi...   \\n\",\n       \"4  /Users/HPhuc/Practice/12. classification/vinbi...   \\n\",\n       \"\\n\",\n       \"                                              Images  \\n\",\n       \"0  /Users/HPhuc/Practice/12. classification/vinbi...  \\n\",\n       \"1  /Users/HPhuc/Practice/12. classification/vinbi...  \\n\",\n       \"2  /Users/HPhuc/Practice/12. classification/vinbi...  \\n\",\n       \"3  /Users/HPhuc/Practice/12. classification/vinbi...  \\n\",\n       \"4  /Users/HPhuc/Practice/12. classification/vinbi...  \"\n      ]\n     },\n     \"execution_count\": 5,\n     \"metadata\": {},\n     \"output_type\": \"execute_result\"\n    }\n   ],\n   \"source\": [\n    \"data = pd.read_csv('/Users/HPhuc/Practice/12. classification/chest-X-rays/output/csv/data_train.csv', index_col=0)\\n\",\n    \"data[:5]\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 9,\n   \"metadata\": {},\n   \"outputs\": [\n    {\n     \"data\": {\n      \"text/plain\": [\n       \"'[{\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}, {\\\"question\\\": 0.0, \\\"answer\\\": 0.0}]'\"\n      ]\n     },\n     \"execution_count\": 9,\n     \"metadata\": {},\n     \"output_type\": \"execute_result\"\n    }\n   ],\n   \"source\": [\n    \"import json \\n\",\n    \"\\n\",\n    \"feedback_items = [{\\n\",\n    \"                    \\\"question\\\": data[\\\"Atelectasis\\\"].to_list()[idc],\\n\",\n    \"                    \\\"answer\\\": data['Calcification'].to_list()[idc],\\n\",\n    \"                } for idc in range(len(data))]\\n\",\n    \"json.dumps(feedback_items)                \"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 3,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"import os \\n\",\n    \"import cv2\\n\",\n    \"from keras.models import load_model\\n\",\n    \"\\n\",\n    \"IMG_W = 1024\\n\",\n    \"IMG_H = 1024\\n\",\n    \"IMG_C = 3\\n\",\n    \"\\n\",\n    \"unet_path = '/Users/HPhuc/Practice/12. classification/vinbigdata/output/best_model.h5'\\n\",\n    \"img_path = '/Users/HPhuc/Practice/12. classification/vinbigdata/data/train/0e130f7333967146f0d7bbd94a8ae047.png'\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 4,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"# import multiprocessing\\n\",\n    \"# multiprocessing.cpu_count()\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 5,\n   \"metadata\": {},\n   \"outputs\": [\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"...multiprocessing...\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"100%|██████████| 100/100 [00:00<00:00, 110.72it/s]\\n\"\n     ]\n    }\n   ],\n   \"source\": [\n    \"from reposcv.utils import multiprocess\\n\",\n    \"\\n\",\n    \"def get_imgs(idc):\\n\",\n    \"  row = data.iloc[idc]\\n\",\n    \"  img_path = row['image_paths']\\n\",\n    \"  id_ = row['image_ids']\\n\",\n    \"  img = cv2.imread(img_path)\\n\",\n    \"\\n\",\n    \"  return img, id_\\n\",\n    \"\\n\",\n    \"ds = multiprocess(get_imgs, range(0, len(data)), workers=4)\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 13,\n   \"metadata\": {},\n   \"outputs\": [\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(1, 1024, 1024, 3)\\n\"\n     ]\n    }\n   ],\n   \"source\": [\n    \"img, id_ = get_imgs(0)\\n\",\n    \"img = np.array(img[np.newaxis])\\n\",\n    \"print(img.shape)\\n\",\n    \"unet = load_model(unet_path, compile=False)\\n\",\n    \"msk = unet.predict(img)\\n\",\n    \"\\n\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 17,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"from torch.utils.data import Dataset, DataLoader, RandomSampler, SequentialSampler\\n\",\n    \"\\n\",\n    \"dloader = DataLoader(ds, batch_size=64, num_workers=6)\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 18,\n   \"metadata\": {},\n   \"outputs\": [\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"100%|██████████| 2/2 [02:46<00:00, 83.49s/it] \\n\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(100, 1024, 1024, 3)\\n\",\n      \"(100, 1024, 1024, 1)\\n\",\n      \"(100,)\\n\"\n     ]\n    }\n   ],\n   \"source\": [\n    \"from tqdm import tqdm \\n\",\n    \"from repos.utils import get_progress\\n\",\n    \"\\n\",\n    \"unet = load_model(unet_path, compile=False)\\n\",\n    \"\\n\",\n    \"def predict_msk(dloader):\\n\",\n    \"  final_msks = []\\n\",\n    \"  final_ids  = []\\n\",\n    \"  final_imgs = []\\n\",\n    \"\\n\",\n    \"  for imgs, ids in tqdm(dloader): \\n\",\n    \"    imgs = np.array(imgs)\\n\",\n    \"    msks = unet.predict(imgs)\\n\",\n    \"    msks = (msks*255).astype(np.uint8)\\n\",\n    \"    msks = (msks>127).astype(int)\\n\",\n    \"     \\n\",\n    \"    final_imgs.append(imgs)\\n\",\n    \"    final_msks.append(msks)\\n\",\n    \"    final_ids.append(ids)\\n\",\n    \"  \\n\",\n    \"  final_imgs = np.concatenate(final_imgs)\\n\",\n    \"  final_msks = np.concatenate(final_msks)\\n\",\n    \"  final_ids  = np.concatenate(final_ids)\\n\",\n    \"  \\n\",\n    \"  return final_imgs, final_msks, final_ids\\n\",\n    \"\\n\",\n    \"final_imgs, final_msks, final_ids = predict_msk(dloader)\\n\",\n    \"print(final_imgs.shape)\\n\",\n    \"print(final_msks.shape)\\n\",\n    \"print(final_ids.shape)\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 20,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"def pad_image(img, axes, crop_size):\\n\",\n    \"    shapes = np.array(img.shape)\\n\",\n    \"    axes = np.array(axes)\\n\",\n    \"    sizes = np.array(shapes[axes])\\n\",\n    \"    diffs = sizes - np.array(crop_size)\\n\",\n    \"    for diff, axis in zip(diffs, axes):\\n\",\n    \"        left = abs(diff) // 2\\n\",\n    \"        right = (left + 1) if diff % 2 != 0 else left\\n\",\n    \"        if diff >= 0: \\n\",\n    \"          continue\\n\",\n    \"        elif diff < 0:\\n\",\n    \"          img = np.pad(img, [(left, right) if i == axis else (0, 0) for i in range(len(shapes))])\\n\",\n    \"    return img\\n\",\n    \"    \"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 26,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"from scipy import ndimage\\n\",\n    \"import skimage\\n\",\n    \"from matplotlib.patches import Rectangle\\n\",\n    \"from skimage.measure import label\\n\",\n    \"import matplotlib.pyplot as plt\\n\",\n    \"\\n\",\n    \"train_path = '/Users/HPhuc/Practice/12. classification/vinbigdata/output/output_xray/'\\n\",\n    \"\\n\",\n    \"def Crop_LCP(idc, size, return_path):\\n\",\n    \"    # Toạ độ của largest connected component\\n\",\n    \"    msk = final_msks[idc]\\n\",\n    \"    img = final_imgs[idc]\\n\",\n    \"    id_ = final_ids[idc]\\n\",\n    \"    slice_y, slice_x = ndimage.find_objects(msk.squeeze(), 1)[0]\\n\",\n    \"\\n\",\n    \"    x_min = slice_x.start \\n\",\n    \"    x_max = slice_x.stop\\n\",\n    \"    y_min = slice_y.start\\n\",\n    \"    y_max = slice_y.stop\\n\",\n    \"\\n\",\n    \"    xy = (slice_x.start, slice_y.start)\\n\",\n    \"    h, w = slice_y.stop - slice_y.start, slice_x.stop - slice_x.start\\n\",\n    \"    nw, nh = int(w/0.875), int(h/0.875)\\n\",\n    \"    dw, dh = (nw-w)//2, (nh-h)//2\\n\",\n    \"\\n\",\n    \"    top   = max(slice_y.start-dh, 0)\\n\",\n    \"    left  = max(slice_x.start-dw, 0)\\n\",\n    \"    bot   = min(slice_y.stop+dh, 1024)\\n\",\n    \"    right = min(slice_x.stop+dw, 1024)\\n\",\n    \"\\n\",\n    \"    img_crop = img[top : bot, left : right]\\n\",\n    \"    \\n\",\n    \"    \\\"\\\"\\\" Check whether img size > = 256, if not -> padding\\n\",\n    \"    \\\"\\\"\\\"\\n\",\n    \"    if np.any(np.array(img_crop.shape[:2]) < size): \\n\",\n    \"      img_crop = pad_image(img=img_crop, axes=(0,1), crop_size=[size,size])\\n\",\n    \"      print('padding:', img_crop.shape)\\n\",\n    \"\\n\",\n    \"    assert np.all(np.array(img_crop.shape[:2]) >= size), f'{id_}' + ' crop size' + f'{img_crop.shape[:2]}' ' must be larger than' + f'{size, size}'\\n\",\n    \"\\n\",\n    \"    if return_path: np.save(f'{train_path}' + id_ + '.png', img_crop)\\n\",\n    \"\\n\",\n    \"    if idc % 100 == 0:\\n\",\n    \"      fig, ax1 = plt.subplots(1, 1, figsize=(12,8))\\n\",\n    \"      ax1.imshow(img_crop, cmap=plt.cm.gray)\\n\",\n    \"      plt.show()\\n\",\n    \"\\n\",\n    \"    print(img_crop.shape)\\n\",\n    \"\\n\",\n    \"    # return img_crop \\n\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 28,\n   \"metadata\": {},\n   \"outputs\": [\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"...multiprocessing...\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"  0%|          | 0/100 [00:00<?, ?it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(632, 737, 3)\\n\",\n      \"(611, 792, 3)\\n\",\n      \"(633, 833, 3)\\n\",\n      \"(499, 848, 3)\\n\",\n      \"(584, 929, 3)\\n\",\n      \"(811, 995, 3)\\n\",\n      \"(720, 817, 3)\\n\",\n      \"(619, 881, 3)\\n\",\n      \"(673, 1009, 3)\\n\",\n      \"(589, 820, 3)\\n\",\n      \"(677, 946, 3)\\n\",\n      \"(762, 921, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"  1%|          | 1/100 [00:00<01:15,  1.32it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(694, 768, 3)\\n\",\n      \"(738, 882, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 13%|█▎        | 13/100 [00:00<00:05, 16.82it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(576, 744, 3)\\n\",\n      \"(611, 900, 3)\\n\",\n      \"(571, 848, 3)\\n\",\n      \"(661, 853, 3)\\n\",\n      \"(555, 845, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 17%|█▋        | 17/100 [00:01<00:04, 18.04it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(513, 833, 3)\\n\",\n      \"(538, 816, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 21%|██        | 21/100 [00:01<00:03, 20.72it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(513, 840, 3)\\n\",\n      \"(633, 787, 3)\\n\",\n      \"(636, 825, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 24%|██▍       | 24/100 [00:01<00:03, 21.88it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(649, 929, 3)\\n\",\n      \"(630, 898, 3)\\n\",\n      \"(630, 832, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 27%|██▋       | 27/100 [00:01<00:03, 21.76it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(594, 913, 3)\\n\",\n      \"(584, 857, 3)\\n\",\n      \"(570, 851, 3)\\n\",\n      \"(699, 875, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 30%|███       | 30/100 [00:01<00:03, 18.89it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(725, 844, 3)\\n\",\n      \"(594, 910, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 33%|███▎      | 33/100 [00:01<00:03, 20.68it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(645, 883, 3)\\n\",\n      \"(597, 852, 3)\\n\",\n      \"(598, 728, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 36%|███▌      | 36/100 [00:02<00:03, 20.84it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(748, 825, 3)\\n\",\n      \"(613, 876, 3)(608, 854, 3)\\n\",\n      \"\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 39%|███▉      | 39/100 [00:02<00:03, 19.27it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(706, 851, 3)\\n\",\n      \"(613, 842, 3)\\n\",\n      \"(528, 931, 3)\\n\",\n      \"(662, 834, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 42%|████▏     | 42/100 [00:02<00:03, 17.86it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(693, 996, 3)\\n\",\n      \"(593, 820, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 45%|████▌     | 45/100 [00:02<00:02, 19.75it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(592, 796, 3)\\n\",\n      \"(636, 891, 3)\\n\",\n      \"(661, 802, 3)\\n\",\n      \"(615, 868, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 48%|████▊     | 48/100 [00:02<00:02, 19.19it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(589, 864, 3)\\n\",\n      \"(725, 842, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 51%|█████     | 51/100 [00:02<00:02, 21.39it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(652, 893, 3)\\n\",\n      \"(615, 850, 3)\\n\",\n      \"(626, 896, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 54%|█████▍    | 54/100 [00:02<00:02, 19.58it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(636, 1007, 3)\\n\",\n      \"(614, 916, 3)\\n\",\n      \"(701, 883, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 57%|█████▋    | 57/100 [00:03<00:02, 20.52it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(530, 843, 3)(663, 858, 3)\\n\",\n      \"\\n\",\n      \"(650, 726, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 60%|██████    | 60/100 [00:03<00:01, 20.69it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(489, 650, 3)\\n\",\n      \"(679, 885, 3)\\n\",\n      \"(628, 937, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 63%|██████▎   | 63/100 [00:03<00:01, 21.38it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(545, 854, 3)\\n\",\n      \"(706, 844, 3)\\n\",\n      \"(741, 884, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 66%|██████▌   | 66/100 [00:03<00:01, 20.87it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(673, 872, 3)\\n\",\n      \"(572, 842, 3)\\n\",\n      \"(680, 786, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 69%|██████▉   | 69/100 [00:03<00:01, 22.23it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(625, 826, 3)\\n\",\n      \"(498, 824, 3)\\n\",\n      \"(679, 856, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 72%|███████▏  | 72/100 [00:03<00:01, 21.65it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(689, 841, 3)\\n\",\n      \"(666, 864, 3)\\n\",\n      \"(617, 780, 3)\\n\",\n      \"(610, 935, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 75%|███████▌  | 75/100 [00:03<00:01, 19.66it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(473, 833, 3)\\n\",\n      \"(659, 985, 3)\\n\",\n      \"(516, 791, 3)\\n\",\n      \"(587, 838, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 79%|███████▉  | 79/100 [00:04<00:00, 21.00it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(597, 873, 3)\\n\",\n      \"(742, 856, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 82%|████████▏ | 82/100 [00:04<00:00, 21.64it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(603, 832, 3)\\n\",\n      \"(565, 834, 3)\\n\",\n      \"(576, 764, 3)\\n\",\n      \"(613, 905, 3)\\n\",\n      \"(714, 940, 3)\\n\",\n      \"(630, 822, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 85%|████████▌ | 85/100 [00:04<00:00, 19.38it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(441, 868, 3)\\n\",\n      \"(579, 908, 3)\\n\",\n      \"(644, 928, 3)\\n\",\n      \"(646, 971, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 89%|████████▉ | 89/100 [00:04<00:00, 20.23it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(647, 869, 3)\\n\",\n      \"(565, 872, 3)\\n\",\n      \"(608, 867, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 93%|█████████▎| 93/100 [00:04<00:00, 21.68it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"(636, 981, 3)\\n\",\n      \"(634, 876, 3)\\n\",\n      \"(614, 774, 3)\\n\",\n      \"(678, 773, 3)\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \" 97%|█████████▋| 97/100 [00:04<00:00, 22.34it/s]\"\n     ]\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"\\n\",\n      \"(690, 873, 3)\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"100%|██████████| 100/100 [00:05<00:00, 19.97it/s]\\n\"\n     ]\n    }\n   ],\n   \"source\": [\n    \"crop_lung = multiprocess(Crop_LCP, range(len(data)), size=256, return_path=True)\\n\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 29,\n   \"metadata\": {},\n   \"outputs\": [\n    {\n     \"data\": {\n      \"text/plain\": [\n       \"100\"\n      ]\n     },\n     \"execution_count\": 29,\n     \"metadata\": {},\n     \"output_type\": \"execute_result\"\n    }\n   ],\n   \"source\": [\n    \"import os \\n\",\n    \"\\n\",\n    \"len(os.listdir(train_path))\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": null,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": []\n  }\n ],\n \"metadata\": {\n  \"kernelspec\": {\n   \"display_name\": \"Python 3.7.13 ('env1')\",\n   \"language\": \"python\",\n   \"name\": \"python3\"\n  },\n  \"language_info\": {\n   \"codemirror_mode\": {\n    \"name\": \"ipython\",\n    \"version\": 3\n   },\n   \"file_extension\": \".py\",\n   \"mimetype\": \"text/x-python\",\n   \"name\": \"python\",\n   \"nbconvert_exporter\": \"python\",\n   \"pygments_lexer\": \"ipython3\",\n   \"version\": \"3.7.13\"\n  },\n  \"orig_nbformat\": 4,\n  \"vscode\": {\n   \"interpreter\": {\n    \"hash\": \"73debb880a198c180bbd222a47dda85b4338a84f60caf5c95fac3f32e5ae8937\"\n   }\n  }\n },\n \"nbformat\": 4,\n \"nbformat_minor\": 2\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/notebooks/crop_lung.ipynb b/notebooks/crop_lung.ipynb
--- a/notebooks/crop_lung.ipynb	(revision 914c0e7bb37d00d1a25c112f282b7b36d5b80d23)
+++ b/notebooks/crop_lung.ipynb	(date 1676786316615)
@@ -407,7 +407,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 20,
+   "execution_count": 1,
    "metadata": {},
    "outputs": [],
    "source": [
@@ -429,7 +429,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 26,
+   "execution_count": 2,
    "metadata": {},
    "outputs": [],
    "source": [
@@ -487,499 +487,18 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 28,
+   "execution_count": 3,
    "metadata": {},
    "outputs": [
     {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "...multiprocessing...\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      "  0%|          | 0/100 [00:00<?, ?it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(632, 737, 3)\n",
-      "(611, 792, 3)\n",
-      "(633, 833, 3)\n",
-      "(499, 848, 3)\n",
-      "(584, 929, 3)\n",
-      "(811, 995, 3)\n",
-      "(720, 817, 3)\n",
-      "(619, 881, 3)\n",
-      "(673, 1009, 3)\n",
-      "(589, 820, 3)\n",
-      "(677, 946, 3)\n",
-      "(762, 921, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      "  1%|          | 1/100 [00:00<01:15,  1.32it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(694, 768, 3)\n",
-      "(738, 882, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 13%|█▎        | 13/100 [00:00<00:05, 16.82it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(576, 744, 3)\n",
-      "(611, 900, 3)\n",
-      "(571, 848, 3)\n",
-      "(661, 853, 3)\n",
-      "(555, 845, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 17%|█▋        | 17/100 [00:01<00:04, 18.04it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(513, 833, 3)\n",
-      "(538, 816, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 21%|██        | 21/100 [00:01<00:03, 20.72it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(513, 840, 3)\n",
-      "(633, 787, 3)\n",
-      "(636, 825, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 24%|██▍       | 24/100 [00:01<00:03, 21.88it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(649, 929, 3)\n",
-      "(630, 898, 3)\n",
-      "(630, 832, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 27%|██▋       | 27/100 [00:01<00:03, 21.76it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(594, 913, 3)\n",
-      "(584, 857, 3)\n",
-      "(570, 851, 3)\n",
-      "(699, 875, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 30%|███       | 30/100 [00:01<00:03, 18.89it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(725, 844, 3)\n",
-      "(594, 910, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 33%|███▎      | 33/100 [00:01<00:03, 20.68it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(645, 883, 3)\n",
-      "(597, 852, 3)\n",
-      "(598, 728, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 36%|███▌      | 36/100 [00:02<00:03, 20.84it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(748, 825, 3)\n",
-      "(613, 876, 3)(608, 854, 3)\n",
-      "\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 39%|███▉      | 39/100 [00:02<00:03, 19.27it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(706, 851, 3)\n",
-      "(613, 842, 3)\n",
-      "(528, 931, 3)\n",
-      "(662, 834, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 42%|████▏     | 42/100 [00:02<00:03, 17.86it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(693, 996, 3)\n",
-      "(593, 820, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 45%|████▌     | 45/100 [00:02<00:02, 19.75it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(592, 796, 3)\n",
-      "(636, 891, 3)\n",
-      "(661, 802, 3)\n",
-      "(615, 868, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 48%|████▊     | 48/100 [00:02<00:02, 19.19it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(589, 864, 3)\n",
-      "(725, 842, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 51%|█████     | 51/100 [00:02<00:02, 21.39it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(652, 893, 3)\n",
-      "(615, 850, 3)\n",
-      "(626, 896, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 54%|█████▍    | 54/100 [00:02<00:02, 19.58it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(636, 1007, 3)\n",
-      "(614, 916, 3)\n",
-      "(701, 883, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 57%|█████▋    | 57/100 [00:03<00:02, 20.52it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(530, 843, 3)(663, 858, 3)\n",
-      "\n",
-      "(650, 726, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 60%|██████    | 60/100 [00:03<00:01, 20.69it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(489, 650, 3)\n",
-      "(679, 885, 3)\n",
-      "(628, 937, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 63%|██████▎   | 63/100 [00:03<00:01, 21.38it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(545, 854, 3)\n",
-      "(706, 844, 3)\n",
-      "(741, 884, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 66%|██████▌   | 66/100 [00:03<00:01, 20.87it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(673, 872, 3)\n",
-      "(572, 842, 3)\n",
-      "(680, 786, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 69%|██████▉   | 69/100 [00:03<00:01, 22.23it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(625, 826, 3)\n",
-      "(498, 824, 3)\n",
-      "(679, 856, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 72%|███████▏  | 72/100 [00:03<00:01, 21.65it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(689, 841, 3)\n",
-      "(666, 864, 3)\n",
-      "(617, 780, 3)\n",
-      "(610, 935, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 75%|███████▌  | 75/100 [00:03<00:01, 19.66it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(473, 833, 3)\n",
-      "(659, 985, 3)\n",
-      "(516, 791, 3)\n",
-      "(587, 838, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 79%|███████▉  | 79/100 [00:04<00:00, 21.00it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(597, 873, 3)\n",
-      "(742, 856, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 82%|████████▏ | 82/100 [00:04<00:00, 21.64it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(603, 832, 3)\n",
-      "(565, 834, 3)\n",
-      "(576, 764, 3)\n",
-      "(613, 905, 3)\n",
-      "(714, 940, 3)\n",
-      "(630, 822, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 85%|████████▌ | 85/100 [00:04<00:00, 19.38it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(441, 868, 3)\n",
-      "(579, 908, 3)\n",
-      "(644, 928, 3)\n",
-      "(646, 971, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 89%|████████▉ | 89/100 [00:04<00:00, 20.23it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(647, 869, 3)\n",
-      "(565, 872, 3)\n",
-      "(608, 867, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 93%|█████████▎| 93/100 [00:04<00:00, 21.68it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "(636, 981, 3)\n",
-      "(634, 876, 3)\n",
-      "(614, 774, 3)\n",
-      "(678, 773, 3)"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      " 97%|█████████▋| 97/100 [00:04<00:00, 22.34it/s]"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "\n",
-      "(690, 873, 3)\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      "100%|██████████| 100/100 [00:05<00:00, 19.97it/s]\n"
+     "ename": "NameError",
+     "evalue": "name 'multiprocess' is not defined",
+     "output_type": "error",
+     "traceback": [
+      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
+      "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
+      "\u001b[0;32m/var/folders/kv/zlv1d6k97jx3lbs487816pj80000gn/T/ipykernel_51486/137957460.py\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mcrop_lung\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmultiprocess\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mCrop_LCP\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mrange\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msize\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m256\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mreturn_path\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
+      "\u001b[0;31mNameError\u001b[0m: name 'multiprocess' is not defined"
      ]
     }
    ],
@@ -989,7 +508,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 29,
+   "execution_count": null,
    "metadata": {},
    "outputs": [
     {
@@ -1010,6 +529,109 @@
    ]
   },
   {
+   "cell_type": "code",
+   "execution_count": 1,
+   "metadata": {},
+   "outputs": [],
+   "source": [
+    "# !pip install lungs-segmentation"
+   ]
+  },
+  {
+   "cell_type": "code",
+   "execution_count": 2,
+   "metadata": {},
+   "outputs": [
+    {
+     "name": "stderr",
+     "output_type": "stream",
+     "text": [
+      "/Users/HPhuc/miniconda3/envs/venv/lib/python3.7/site-packages/tqdm/auto.py:22: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html\n",
+      "  from .autonotebook import tqdm as notebook_tqdm\n"
+     ]
+    }
+   ],
+   "source": [
+    "import matplotlib.pyplot as plt\n",
+    "\n",
+    "from lungs_segmentation.pre_trained_models import create_model\n",
+    "import lungs_segmentation.inference as inference\n"
+   ]
+  },
+  {
+   "cell_type": "code",
+   "execution_count": 3,
+   "metadata": {},
+   "outputs": [],
+   "source": [
+    "import torch \n",
+    "device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')\n",
+    "\n",
+    "model = create_model(\"resnet34\")\n",
+    "model = model.to(device)\n",
+    "\n",
+    "img_path = \"/Users/HPhuc/Practice/12. classification/chextnet/data/images_001/images/00000001_000.png\"\n",
+    "img1_path = \"/Users/HPhuc/Practice/12. classification/chextnet/data/images_001/images/00000001_001.png\"\n",
+    "\n",
+    "image, mask = inference.inference(model, img_path, 0.2)\n"
+   ]
+  },
+  {
+   "cell_type": "code",
+   "execution_count": 7,
+   "metadata": {},
+   "outputs": [
+    {
+     "data": {
+      "text/plain": [
+       "(512, 512)"
+      ]
+     },
+     "execution_count": 7,
+     "metadata": {},
+     "output_type": "execute_result"
+    }
+   ],
+   "source": [
+    "import numpy as np \n",
+    "lungs = np.max(mask, axis=0)\n",
+    "lungs.shape"
+   ]
+  },
+  {
+   "cell_type": "code",
+   "execution_count": 8,
+   "metadata": {},
+   "outputs": [
+    {
+     "data": {
+      "text/plain": [
+       "<matplotlib.image.AxesImage at 0x7fca5f7ff810>"
+      ]
+     },
+     "execution_count": 8,
+     "metadata": {},
+     "output_type": "execute_result"
+    },
+    {
+     "data": {
+      "image/png": "iVBORw0KGgoAAAANSUhEUgAABkYAAAY9CAYAAACbruD/AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAPYQAAD2EBqD+naQAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjMsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+AADFEAAAgAElEQVR4nOzdQW4b9x2G4XHALH0BIrkDD9A9gR64APc9AO8QgBfIskXcRRph5JqqKJH8z8z7PJuqRRcD29LQePH7/OXbt2/fJgAAAAAAgICfRj8AAAAAAADAswgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGTsRj/AR/zxxx/T5XKZvn79On358mX04wAAAAAAAAN9+/Zt+v3336f9fj/99NPbNyGrDCOXy2X69ddfRz8GAAAAAACwIL/99tv0yy+/vPn/WWUY+fr16zRN0/S36e/Tbvp58NMAAAAAAAAj/Xv61/TP6R8v/eAtqwwjf81n7aafp90XYQQAAAAAANK+/fkf7/nnN/zj6wAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZOxGPwAAAAAs3elyHv0I/+O4P4x+BACAVXIxAgAAAAAAZAgjAAAAAABAhiktAAAA+K8lTmZdc+uzmt4CAPiTixEAAAAAACBDGAEAAAAAADJMaQEAALBZa5rGerQl/1qY+QIAnsnFCAAAAAAAkCGMAAAAAAAAGaa0AAAAWKUlT0Nxm/f8XprbAgDuxcUIAAAAAACQIYwAAAAAAAAZprQAAABYDfNZXdd+701sAQC3cjECAAAAAABkCCMAAAAAAECGKS0AAAAWzXwWbzGxBQDcysUIAAAAAACQIYwAAAAAAAAZprQAAAAYxkwWj2JiCwC4xsUIAAAAAACQIYwAAAAAAAAZprQAAACAjPfOt5ncAoDtcjECAAAAAABkCCMAAAAAAECGKS0AAAAe7r3zRbAU1/7MmtgCgPVzMQIAAAAAAGQIIwAAAAAAQIYpLQAAAO7GZBZbN/8zblYLANbJxQgAAAAAAJAhjAAAAAAAABmmtACAtK1Ovpj2AIDHu/VzhPczACyDixEAAAAAACBDGAEAAAAAADJMaQEAm7LVaaxbfebXwcwH8B5+3sLt5t833rcAMI6LEQAAAAAAIEMYAQAAAAAAMkxpAQCLY55lrI/8+psDAYDbmNUCgHFcjAAAAAAAABnCCAAAAAAAkGFKCwB4GhNZ2/We31szIbB+fo7DY1z73vLuBIDHcDECAAAAAABkCCMAAAAAAECGKS0A4MNMqnCLz/x5MSUC4/hZD+PMv/+8CwHgflyMAAAAAAAAGcIIAAAAAACQYUoLAPgh0ykAAMthVgsA7sfFCAAAAAAAkCGMAAAAAAAAGaa0ACDITBZr854/s2ZF4H68J2DZzGoBwOe4GAEAAAAAADKEEQAAAAAAIMOUFgBsmCkUSsyKAFDk/QcAt3MxAgAAAAAAZAgjAAAAAABAhiktANgY81nwvu8DcyPwmvcHrN+172PvPAB4zcUIAAAAAACQIYwAAAAAAAAZprQAYKVMnsDnzL+HTIwAAAB0uBgBAAAAAAAyhBEAAAAAACDDlBYALJzJLHi8a99nJrbYOu8YaPCeA4DXXIwAAAAAAAAZwggAAAAAAJBhSgsAFsKcCQAAAMDjuRgBAAAAAAAyhBEAAAAAACDDlBYADGQ+C5bt2vfocX948pPA/Xj3AH/xngOgysUIAAAAAACQIYwAAAAAAAAZprQA4MlMmAAAAACM42IEAAAAAADIEEYAAAAAAIAMU1oA8EmmsaDn2vf9cX948pMAwP15zwGwdS5GAAAAAACADGEEAAAAAADIMKUFAAB3Mp8eMTcCAACwTC5GAAAAAACADGEEAAAAAADIMKUFAO80n8gB+H/MarEk3mHAPVz7WeI9B8DauBgBAAAAAAAyhBEAAAAAACBDGAEAAAAAADL8GyMA8Aab7MA9+PdGGME7DHgW7zkA1sbFCAAAAAAAkCGMAAAAAAAAGaa0AGAyNwI8j7kRALbMew6ANXAxAgAAAAAAZAgjAAAAAABAhiktALLMZwEAwOOY1QJgqVyMAAAAAAAAGcIIAAAAAACQYUoLgM0zmQUslYkRACqufSb3/gNgBBcjAAAAAABAhjACAAAAAABkmNICAIAFMKvFPZiPBNbG+w+AEVyMAAAAAAAAGcIIAAAAAACQYUoLgM0wHwJAkfcfsBXXfp6Z2ALg3lyMAAAAAAAAGcIIAAAAAACQYUoLgNUyHQIAAADArVyMAAAAAAAAGcIIAAAAAACQYUoLgFUxnwUUzH/WHfeHgU8CAON5LwJwby5GAAAAAACADGEEAAAAAADIMKUFwCKZzAIAAL5nVguAe3AxAgAAAAAAZAgjAAAAAABAhiktABbDfBbA/zIZAgA/5h0JwEe5GAEAAAAAADKEEQAAAAAAIMOUFgBDmc8CgNt5fwK89v3PRdNaALzFxQgAAAAAAJAhjAAAAAAAABmmtAB4CpMfAPA53qUAAHAfLkYAAAAAAIAMYQQAAAAAAMgwpQUAACsxn1I67g8DnwQAls07E4C3uBgBAAAAAAAyhBEAAAAAACDDlBYAdzU/WQcAABjNrBYA33MxAgAAAAAAZAgjAAAAAABAhiktAD7NfBYA3J/3K8D9mdUCYJpcjAAAAAAAACHCCAAAAAAAkGFKC4APMe8BMJYpkG3yfgV4Hu9SgC4XIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkCCMAAAAAAEDGbvQDALBsp8t59CMAAAA81LW/9xz3hyc/CQDP4GIEAAAAAADIEEYAAAAAAIAMU1oAAAAA8APziS2zWgDb4WIEAAAAAADIEEYAAAAAAIAMU1oATNP0+kQcAACA18xqAWyHixEAAAAAACBDGAEAAAAAADJMaQEAwMqZ9gAAAHg/FyMAAAAAAECGMAIAAAAAAGSY0gKImc+tAAAAcLtrf68yaQmwDi5GAAAAAACADGEEAAAAAADIEEYAAAAAAIAMYQQAAAAAAMgQRgAAAAAAgIzd6AcA4PFOl/PoRwDgSeY/84/7w8AnAYAe72GAdXAxAgAAAAAAZAgjAAAAAABAhiktgI0ynwUAADCOWS2A5XIxAgAAAAAAZAgjAAAAAABAhiktgA0xnwUAAAAAb3MxAgAAAAAAZAgjAAAAAABAhiktgJUznwUAALBs87+3HfeHgU8CwDS5GAEAAAAAAEKEEQAAAAAAIMOUFgAAAAA8iVktgPFcjAAAAAAAABnCCAAAAAAAkGFKC2CF5qfXAAAAAMD7uRgBAAAAAAAyhBEAAAAAACDDlBbASpjPAgAA2Jb53/OO+8PAJwFocTECAAAAAABkCCMAAAAAAECGKS0AAAAAGMysFsDzuBgBAAAAAAAyhBEAAAAAACDDlBbAgs1PqQGAbfK+BwCA53IxAgAAAAAAZAgjAAAAAABAhiktgIUxpwHAvXz/TjnuD4OeBAAAYDlcjAAAAAAAABnCCAAAAAAAkGFKCwAAAAAWZD6HaQoT4P5cjAAAAAAAABnCCAAAAAAAkGFKC2AB5mfSAAAA8BezWgD352IEAAAAAADIEEYAAAAAAIAMU1oAg5jPAuDZTHEAwLp5lwPch4sRAAAAAAAgQxgBAAAAAAAyTGkBPJH5LAAAAAAYy8UIAAAAAACQIYwAAAAAAAAZwggAAAAAAJDh3xgBAAAAgJWZ/xuWx/1h4JMArI+LEQAAAAAAIEMYAQAAAAAAMkxpATzY/LwZAAAAABjLxQgAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQsRv9AABbdLqcRz8CALASx/3h5WufIQAA4PFcjAAAAAAAABnCCAAAAAAAkGFKC+BOTF8AAAAwwvzvo/OJRgB+zMUIAAAAAACQIYwAAAAAAAAZprQAAAAAYCPMagH8fy5GAAAAAACADGEEAAAAAADIMKUF8AnzE2UAgM+aT574nAEAAI/hYgQAAAAAAMgQRgAAAAAAgAxTWgAAAACwQfNZxvlcI0CdixEAAAAAACBDGAEAAAAAADJMaQHcaH6KDAAAAACsi4sRAAAAAAAgQxgBAAAAAAAyTGkBAAAs0HF/ePXfzXkCAMB9uBgBAAAAAAAyhBEAAAAAACDDlBYAAAAAbNx8kvH7uUaAGhcjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQMZu9AMArMHpch79CAAAAADAHbgYAQAAAAAAMoQRAAAAAAAgw5QWAADAChz3h5evzXwCAMDHuRgBAAAAAAAyhBEAAAAAACDDlBbAFSYqAAAA2KL533fnU40AFS5GAAAAAACADGEEAAAAAADIEEYAAAAAAIAMYQQAAAAAAMgQRgAAAAAAgIzd6AcAWJLT5Tz6EQAAAOBp5n8PPu4PA58E4HlcjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZu9EPADDS6XIe/QgAMMT8HXjcHwY+CR8x/z3zeQYAAG7jYgQAAAAAAMgQRgAAAAAAgAxhBAAAAAAAyBBGAAAAAACADGEEAAAAAADI2I1+AAAAAD7uuD+8fH26nAc+CQBrN3+PzN8vAFvjYgQAAAAAAMgQRgAAAAAAgAxhBAAAAAAAyBBGAAAAAACADGEEAAAAAADI2I1+AIBnO13Oox8BAOAhjvvDy9c+8wAAwI+5GAEAAAAAADKEEQAAAAAAIMOUFgAAwAaZ1QLgM+bvjvk7BWALXIwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGbvRDwDwDKfLefQjAAAMc9wfXr72uQgAgDoXIwAAAAAAQIYwAgAAAAAAZJjSAgAACJnPal1jbgsAgC1zMQIAAAAAAGQIIwAAAAAAQIYpLQAAAF6Zz22Z1QIAYGtcjAAAAAAAABnCCAAAAAAAkGFKCwAAgKvMagEAsDUuRgAAAAAAgAxhBAAAAAAAyDClBWyWqQcAuG4+jwTvZVYLAIAtcDECAAAAAABkCCMAAAAAAECGKS0AAABudm2OzcQWwPbMf7ab4wS2wMUIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkLEb/QAA93S6nEc/AgBA2nF/ePnaZzOA7Zn/bJ//zAdYExcjAAAAAABAhjACAAAAAABkmNICAADgIcxqAQCwRC5GAAAAAACADGEEAAAAAADIMKUFAADAw5nVAgBgKVyMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkLEb/QAAn3W6nEc/AgCswnF/GP0IME3T6z+LPssBAPBsLkYAAAAAAIAMYQQAAAAAAMgQRgAAAAAAgAxhBAAAAAAAyBBGAAAAAACAjN3oBwD4iNPlPPoRAAC4g+P+8PK1z3gA6zL/uT3/eQ6wdC5GAAAAAACADGEEAAAAAADIEEYAAAAAAIAMYQQAAAAAAMgQRgAAAAAAgIzd6AcAAAAe47g/jH4EuMn8z+zpch74JAAAbJmLEQAAAAAAIEMYAQAAAAAAMkxpAQAAAACfMp9ANOcJLJ2LEQAAAAAAIEMYAQAAAAAAMkxpAasxP8sFAAAAAPgIFyMAAAAAAECGMAIAAAAAAGSY0gIAgA057g+jHwEAAGDRXIwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJCxG/0AAADA5xz3h9GPAADw4nQ5v3ztcwqwRC5GAAAAAACADGEEAAAAAADIMKUFAADA4synV+aTLAAA8FkuRgAAAAAAgAxhBAAAAAAAyDClBQAAKzSfGQIAAOD9XIwAAAAAAAAZwggAAAAAAJBhSgtYtNPlPPoRAAAAAIANcTECAAAAAABkCCMAAAAAAECGKS0AAFiJ4/4w+hEAAG4yn8j2WQZYChcjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQMZu9AMAAADXHfeH0Y8AAACwKS5GAAAAAACADGEEAAAAAADIMKUFAAALYz4LAADgcVyMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABm70Q8AAABM03F/GP0IAAAACS5GAAAAAACADGEEAAAAAADIMKUFAACDmM8CAEpOl/PL1z4HASO5GAEAAAAAADKEEQAAAAAAIEMYAQAAAAAAMoQRAAAAAAAgQxgBAAAAAAAydqMfAOB7p8t59CMAwMMc94fRjwCrM/++8VkRAIDPcjECAAAAAABkCCMAAAAAAECGKS0AAHgw81kAAADL4WIEAAAAAADIEEYAAAAAAIAMYQQAAAAAAMgQRgAAAAAAgAxhBAAAAAAAyNiNfgAAANii4/4w+hEAAAD4ARcjAAAAAABAhjACAAAAAABkmNICFuF0OY9+BAD4NPNZ8Hjz7zOfIQHW6/uf4T5HAc/kYgQAAAAAAMgQRgAAAAAAgAxTWgAAAKySWS0AAD7CxQgAAAAAAJAhjAAAAAAAABmmtAAA4BPmUz4AAAAsn4sRAAAAAAAgQxgBAAAAAAAyTGkBAACwevNZu9PlPPBJAABYOhcjAAAAAABAhjACAAAAAABkmNICAIAbzSd7gOUxqwUAwFtcjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZu9EPAAAAS3XcH0Y/AgAAAHfmYgQAAAAAAMgQRgAAAAAAgAxTWsAwp8t59CMAALBx80k8nz8BAJgmFyMAAAAAAECIMAIAAAAAAGSY0gIAACBhPqs1Z2ILAKDFxQgAAAAAAJAhjAAAAAAAABmmtAAAYOba1A4AAADb4GIEAAAAAADIEEYAAAAAAIAMU1oAAOSZz4K2+c+A0+U88EkAAHgGFyMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABk7EY/AAAAACzFcX/44f9+upyf/CQAADyKixEAAAAAACBDGAEAAAAAADJMaQEAkHRtLgfgR+Y/M8xq8R/27uW6bWQBAigXjIJRIAvGjCwQBeJ4C8/jtDSCzA+A/tS9Kx6v2hZIE6hTJQCgbxojAAAAAABADMEIAAAAAAAQw5QWAAAxzGcBezCrBQDQN40RAAAAAAAghmAEAAAAAACIYUoLOJWpAQAAAACgJo0RAAAAAAAghmAEAAAAAACIYUoLAAAA3nS/TY/XZmMBAPqgMQIAAAAAAMQQjAAAAAAAADFMaQEAMLRy5gbgSN8/b0xrATyv/Mz0/Q04msYIAAAAAAAQQzACAAAAAADEMKUFAMBwzC8ALSg/i8xqAQC0Q2MEAAAAAACIIRgBAAAAAABimNICAGAI5rOAlpnVAgBoh8YIAAAAAAAQQzACAAAAAADEMKUFAEC3zGcBPTKrBQBQl8YIAAAAAAAQQzACAAAAAADEMKUFAAAAlZjVAgA4n8YIAAAAAAAQQzACAAAAAADEEIwAAAAAAAAxBCMAAAAAAEAMwQgAAAAAABDjWvsAAADwivttqn0EAAAAOqYxAgAAAAAAxBCMAAAAAAAAMUxpAQAAQAO2pgLndTn5JAAAY9MYAQAAAAAAYghGAAAAAACAGKa0AABo3ta8DECC8jPQrBaQoPys8z0QOILGCAAAAAAAEEMwAgAAAAAAxDClBQAAAJ0wqwUA8DmNEQAAAAAAIIZgBAAAAAAAiGFKCwAAADpkVgsA4D0aIwAAAAAAQAzBCAAAAAAAEMOUFgAATSonYgD4nVktAIDnaYwAAAAAAAAxBCMAAAAAAEAMU1oAADTDfBYAAABH0xgBAAAAAABiCEYAAAAAAIAYprQAAABgIOUs4bwuFU8CANAmjREAAAAAACCGYAQAAAAAAIghGAEAAAAAAGIIRgAAAAAAgBiCEQAAAAAAIMa19gEAAMh2v021jwAwrPIzdl6XiicBAGiHxggAAAAAABBDMAIAAAAAAMQwpQUAAAABzGoBAPyhMQIAAAAAAMQQjAAAAAAAADFMaQEAcLpyzgWA85nVAnpRfkb5DgnsRWMEAAAAAACIIRgBAAAAAABimNICAACAYGa1AIA0GiMAAAAAAEAMwQgAAAAAABDDlBYAAABwuVzMagEAGTRGAAAAAACAGIIRAAAAAAAghiktAAAA4D/MagEAo9IYAQAAAAAAYghGAAAAAACAGKa0gMOp3QNwuXydZAGgL2a1AICRaIwAAAAAAAAxBCMAAAAAAEAMU1oAAADA08xqAQC90xgBAAAAAABiCEYAAAAAAIAYprQAADhMObcCwHi2PudNbAEALdMYAQAAAAAAYghGAAAAAACAGKa0AAAAAIDmlTN9JluBT2iMAAAAAAAAMQQjAAAAAABADFNaAAAAwK7KiZty+gYAoAUaIwAAAAAAQAzBCAAAAAAAEMOUFgAAAHAYs1oAQGs0RgAAAAAAgBiCEQAAAAAAIIYpLQAAAOAU5axWycQWAHAmjREAAAAAACCGYAQAAAAAAIhhSgsAgF1tzaQAwJby/w6zWgDA0TRGAAAAAACAGIIRAAAAAAAghmAEAAAAAACIIRgBAAAAAABiCEYAAAAAAIAYghEAAAAAACDGtfYBAAAAAP7vfpser+d1qXgSAGBUGiMAAAAAAEAMwQgAAAAAABDDlBYAAB8rZ08AYC9mtQCAI2iMAAAAAAAAMQQjAAAAAABADFNaAAAAQPPMagEAe9EYAQAAAAAAYghGAJ3UXTwAACAASURBVAAAAACAGKa0AAAAgK6Y1QIAPqExAgAAAAAAxBCMAAAAAAAAMUxpAYdQZwcYXzljAgAAAL3QGAEAAAAAAGIIRgAAAAAAgBimtAAAAIBubU07mveFsZXvcROvwKs0RgAAAAAAgBiCEQAAAAAAIIYpLQAAnmKiAAAAgBFojAAAAAAAADEEIwAAAAAAQAxTWgAAAMBwygnIeV0qngQAaI3GCAAAAAAAEEMwAgAAAAAAxBCMAAAAAAAAMQQjAAAAAABADMEIAAAAAAAQ41r7AAAAAABHut+mx+t5XSqeBABogcYIAAAAAAAQQzACAAAAAADEMKUFAAAAxDCrBQBojAAAAAAAADEEIwAAAAAAQAxTWgAAbCrnRgBgNGa1YAzl+9f3V+AZGiMAAAAAAEAMwQgAAAAAABDDlBYAAAAQ7/v8jmktABiXxggAAAAAABBDMAIAAAAAAMQwpQUAAADwTTmtZVYLAMaiMQIAAAAAAMQQjAAAAAAAADFMaQEAAAD8wqwWAIxFYwQAAAAAAIghGAEAAAAAAGKY0gJ2o1IOAACMzqwWAPRPYwQAAAAAAIghGAEAAAAAAGKY0gIA4ItyIgQA2GZWCwD6pDECAAAAAADEEIwAAAAAAAAxTGkBAAAAfMisFgD0Q2MEAAAAAACIIRgBAAAAAABiCEYAAAAAAIAYghEAAAAAACCGYAQAAAAAAIhxrX0AAAAAgJHcb9Pj9bwuFU8CAPxEYwQAAAAAAIghGAEAAAAAAGKY0gIA4MvkBwAAAIxMYwQAAAAAAIghGAEAAAAAAGKY0gIAAAA4SDlXOa9LxZNAhvJ9Zi4W2KIxAgAAAAAAxBCMAAAAAAAAMUxpAQCEMi0AAABAIo0RAAAAAAAghmAEAAAAAACIYUoLAAAA4ARbM5bzupx8EgDIpjECAAAAAADEEIwAAAAAAAAxBCMAAAAAAEAMwQgAAAAAABBDMAIAAAAAAMS41j4AAAAAQLL7bXq8ntel4klgLOX7qXyfAWiMAAAAAAAAMQQjAAAAAABADFNaAABBTAgAQNvMagHA8TRGAAAAAACAGIIRAAAAAAAghikt4COq3QDtM58FAH0yqwUAx9AYAQAAAAAAYghGAAAAAACAGKa0AAAAABpnVgsA9qMxAgAAAAAAxBCMAAAAAAAAMUxpAQAMqJzbAADGYlYLAD6jMQIAAAAAAMQQjAAAAAAAADFMaQEADMJ8FgDk2fr/38QWAGzTGAEAAAAAAGIIRgAAAAAAgBimtAAAAAAGU05smdUCgK80RgAAAAAAgBiCEQAAAAAAIIZgBAAAAAAAiCEYAQAAAAAAYghGAAAAAACAGNfaBwAA4DX321T7CABAR7a+O8zrcvJJAKANGiMAAAAAAEAMwQgAAAAAABDDlBYAAABAoHJiy6wWAEk0RgAAAAAAgBiCEQAAAAAAIIYpLeBlKtYAAABjMasFQBKNEQAAAAAAIIZgBAAAAAAAiGFKCwCgA+W8BQDAkcxqATA6jREAAAAAACCGYAQAAAAAAIghGAEAAAAAAGL4HSMAAAAA/Gjr95z53SP0prxm/f4+QGMEAAAAAACIIRgBAAAAAABimNICAAAA4CXlFJFZLQB6ozECAAAAAADEEIwAAAAAAAAxTGkBT1GNBjhfOVEBANAqs1oA9EZjBAAAAAAAiCEYAQAAAAAAYghGAAAAAACAGIIRAAAAAAAghmAEAAAAAACIca19AAAAAADGcL9NP/75vC4nnwS2ldfj1jULjE1jBAAAAAAAiCEYAQAAAAAAYpjSAgAAAOBQ5VyRWS0AatMYAQAAAAAAYghGAAAAAACAGIIRAAAAAAAghmAEAAAAAACIIRgBAAAAAABiXGsfAACAf91vU+0jAAAcqvy+M69LxZMAkEpjBAAAAAAAiCEYAQAAAAAAYpjSAjapNAMAAHCkrRlR96MAHEljBAAAAAAAiCEYAQAAAAAAYpjSAgAAAKAp5cSWWS0A9qYxAgAAAAAAxBCMAAAAAAAAMUxpAQBUVk5FAAAA5ymn2nwvhxwaIwAAAAAAQAzBCAAAAAAAEMOUFgAAAADNKueNytkjAHiXxggAAAAAABBDMAIAAAAAAMQwpQV8oZYMAABAq8xqAbAHjREAAAAAACCGYAQAAAAAAIhhSgsAoIJyBgIAAKivnGfzfR3GpjECAAAAAADEEIwAAAAAAAAxTGkBAJxEHR8AYD/ld6tyAgkA/kZjBAAAAAAAiCEYAQAAAAAAYpjSAgAAAKBr3ydLTWsB8BuNEQAAAAAAIIZgBAAAAAAAiGFKCwAAAIChlNNaZrUA+E5jBAAAAAAAiCEYAQAAAAAAYghGAAAAAACAGIIRAAAAAAAghmAEAAAAAACIca19AKC+eV1qHwEAAAAOcb9Nj9fuf3lWea2U1xAwBo0RAAAAAAAghmAEAAAAAACIIRgBAAAAAABiCEYAAAAAAIAYghEAAAAAACDGtfYBgDrmdal9BIBh3W9T7SMAAPCD8nua+2KAXBojAAAAAABADMEIAAAAAAAQQzACAAAAAADEEIwAAAAAAAAxBCMAAAAAAECMa+0DAAAAAMDZ7rfp8Xpel4onoXXl9VFeN0C/NEYAAAAAAIAYghEAAAAAACCGYAQAAAAAAIghGAEAAAAAAGIIRgAAAAAAgBjX2gcAzjOvS+0jAAzrfptqHwEAgDeV3+XcOwOMT2MEAAAAAACIIRgBAAAAAABimNICAAAAgH+Y1QIYn8YIAAAAAAAQQzACAAAAAADEMKUFg1P7BQAAANhH+ZylnF0D+qIxAgAAAAAAxBCMAAAAAAAAMQQjAAAAAABADMEIAAAAAAAQQzACAAAAAADEuNY+AAAAAAC06H6bHq/ndal4ElpUXhPltQK0T2MEAAAAAACIIRgBAAAAAABimNICAAAAgL8wqwUwDo0RAAAAAAAghmAEAAAAAACIYUoLAAAAAF5gVgugbxojAAAAAABADMEIAAAAAAAQw5QWDEiNFwAAAM5hVgugPxojAAAAAABADMEIAAAAAAAQw5QWAMCbytkEAAAwq5Wr/Hm7T4D2aYwAAAAAAAAxBCMAAAAAAEAMwQgAAAAAABBDMAIAAAAAAMQQjAAAAAAAADGutQ8A7GNel9pHAAAAAP5xv02P1+7Zs5Q/7/I6ANqhMQIAAAAAAMQQjAAAAAAAADEEIwAAAAAAQAzBCAAAAAAAEEMwAgAAAAAAxLjWPgDwvnldah8BAAAA+Iv7bXq8di8PUJ/GCAAAAAAAEEMwAgAAAAAAxBCMAAAAAAAAMQQjAAAAAABADMEIAAAAAAAQQzACAAAAAADEuNY+APCaeV1qHwEAAAB40/02PV67xx9f+TMuf/ZAXRojAAAAAABADMEIAAAAAAAQw5QWAMCb1OIBAACgPxojAAAAAABADMEIAAAAAAAQw5QWAAAAAFRQzrGWM62MyRQvtENjBAAAAAAAiCEYAQAAAAAAYghGAAAAAACAGIIRAAAAAAAghmAEAAAAAACIca19AODv5nWpfQQAAAAAdlI+67nfpoongUwaIwAAAAAAQAzBCAAAAAAAEMOUFgDADlThAQD4RPkd0qQ2wLE0RgAAAAAAgBiCEQAAAAAAIIYpLWiU2iwAAADA+Mzywvk0RgAAAAAAgBiCEQAAAAAAIIZgBAAAAAAAiCEYAQAAAAAAYghGAAAAAACAGNfaBwD+Na9L7SMAAAAAld1v0+O1ZwVZyp93eR0A+9IYAQAAAAAAYghGAAAAAACAGKa0AAAAAKBRZrUA9qcxAgAAAAAAxBCMAAAAAAAAMUxpAQAAAAA0ppxOKyfVgM9pjAAAAAAAADEEIwAAAAAAQAxTWlBZWYsEYAwq7wAAANAujREAAAAAACCGYAQAAAAAAIhhSgsA4EBmtQAA2Ev5fdI0N8D7NEYAAAAAAIAYghEAAAAAACCGKS0AgAOZzwIAAD5lohf2pTECAAAAAADEEIwAAAAAAAAxTGlBBWX9EQAAAACeZVYLPqcxAgAAAAAAxBCMAAAAAAAAMUxpAQAAAEBnygklk90Ar9EYAQAAAAAAYghGAAAAAACAGKa04CRqrQAAAAAA9WmMAAAAAAAAMQQjAAAAAABADFNaAAAAAAAdKqfb77ep4kmgLxojAAAAAABADMEIAAAAAAAQQzACAAAAAADEEIwAAAAAAAAxBCMAAAAAAECMa+0DAACMbF6Xx+v7bap4EgAAAOBy0RgBAAAAAACCCEYAAAAAAIAYprTgQOV8CgAAAAAcxYwvPE9jBAAAAAAAiCEYAQAAAAAAYghGAAAAAACAGIIRAAAAAAAghmAEAAAAAACIca19ABjNvC61jwAAAABAsPL51P02VTwJtEljBAAAAAAAiCEYAQAAAAAAYghGAAAAAACAGIIRAAAAAAAghmAEAAAAAACIca19AAAAAAAAjjGvy+P1/TZVPAm0Q2MEAAAAAACIIRgBAAAAAABiCEYAAAAAAIAYghEAAAAAACCGYAQAAAAAAIhxrX0AAIAU87r8+Of323TySQAAACCXxggAAAAAABBDMAIAAAAAAMQwpQUf2ppFAQAAAACgPRojAAAAAABADMEIAAAAAAAQw5QWvMF8FgB7Kv9fud+miicBAABG5t4D/tAYAQAAAAAAYghGAAAAAACAGKa0AAAaotoOAAAAx9IYAQAAAAAAYghGAAAAAACAGKa0AAAaZVYLAAA4ivsNkmmMAAAAAAAAMQQjAAAAAABADMEIAAAAAAAQQzACAAAAAADEEIwAAAAAAAAxrrUPAL2Y16X2EQAIVv4/dL9NFU8CAAAAfdMYAQAAAAAAYghGAAAAAACAGIIRAAAAAAAghmAEAAAAAACIIRgBAAAAAABiXGsfAACA18zr8nh9v00VTwIAAAD90RgBAAAAAABiCEYAAAAAAIAYghEAAAAAACCG3zECvyg33AGgRX7fCAAA8Cn3FaTRGAEAAAAAAGIIRgAAAAAAgBimtAAAAAAAuFwuZrXIoDECAAAAAADEEIwAAAAAAAAxTGkBAAxC5R0AAAD+TmMEAAAAAACIIRgBAAAAAABimNIC4BS9zvqU00TQE7NaAAAA8DONEQAAAAAAIIZgBAAAAAAAiGFKC74xmwPbEud4Xv07+wyhRWa1AAAA4F8aIwAAAAAAQAzBCAAAAAAAEMOUFsCgzOXUsde/u0kujmJWCwAAgHQaIwAAAAAAQAzBCAAAAAAAEMOUFsBAzOKMo/xZmtXiKFvXls8SAADgcjHFy7g0RgAAAAAAgBiCEQAAAAAAIIYpLbiYqaFdaqpcLma1AAAAAPakMQIAAAAAAMQQjAAAAAAAADFMaQE0wGQWAAAArzCzC/A+jREAAAAAACCGYAQAAAAAAIhhSgvgRCaz+NTWNaRGz57K68nnFgAAcLm4T2AsGiMAAAAAAEAMwQgAAAAAABDDlBbAwdRLOUN5nZnVYk/q8gAAAIxGYwQAAAAAAIghGAEAAAAAAGKY0iKWqRn2ZmKGVmxdiz73AAAAADRGAAAAAACAIIIRAAAAAAAghiktgA+Yz6InJrYAAAAANEYAAAAAAIAgghEAAAAAACCGKS2ADWaySPHqtW56CwAA6vBdnFZ8vxY9Q6E3GiMAAAAAAEAMwQgAAAAAABDDlBZRVE4BPldWpH2uAgDAsXznBtifxggAAAAAABBDMAIAAAAAAMQwpQVEKyeBgNc98x5S/e+Pz0YAgPP53kzPyuvX/QQ90BgBAAAAAABiCEYAAAAAAIAYprSAOCqdAAAAtMB8FkAdGiMAAAAAAEAMwQgAAAAAABDDlBYQwXwW1PPb+890wPl8HgIAAJBOYwQAAAAAAIghGAEAAAAAAGKY0gKGZS4G2le+T81qAQAAAGfQGAEAAAAAAGIIRgAAAAAAgBimtIChmM+Cfm29f5Mntl6dGvMZCAAA1Fbeu7hHoVUaIwAAAAAAQAzBCAAAAAAAEMOUFsNLnmBJoZYJY3t1Tqpln3xe+awDAACAfWiMAAAAAAAAMQQjAAAAAABADFNaQDfMyADPfA7UmtvyGQUAwKtGmo0F6InGCAAAAAAAEEMwAgAAAAAAxDClBQAMxaQVAAA9MqvFiMpr2b0aLdEYAQAAAAAAYghGAAAAAACAGKa0GJLKad9UKwEAAACAo2iMAAAAAAAAMQQjAAAAAABADFNaQBPMZwEAAMAfW/fIpsMB9qExAgAAAAAAxBCMAAAAAAAAMUxpAdWYzwIAAAAAzqYxAgAAAAAAxBCMAAAAAAAAMUxpAacynwUAAADvKe+p53WpeBJ4XXnNej5EbRojAAAAAABADMEIAAAAAAAQw5QWw1AhbYtKJAAAABxn677b8xF6YFaL2jRGAAAAAACAGIIRAAAAAAAghiktYDeqjwAAAFBXeW9uVgvgZxojAAAAAABADMEIAAAAAAAQw5QW8BHzWQAAANCmrXt2E1tAOo0RAAAAAAAghmAEAAAAAACIYUoLeJn5LAAAAOiXiS0gncYIAAAAAAAQQzACAAAAAADEMKVF11Q8j2UyCwAAAHI88xzAsxj2Vl5TnkVxFo0RAAAAAAAghmAEAAAAAACIYUoL+EJlEQAAANhSPjcwqwX0SmMEAAAAAACIIRgBAAAAAABimNKCUCazAAAAgE8882zB3BavKK8Xz644ksYIAAAAAAAQQzACAAAAAADEMKUFg1M7BAAAAGrZei5hYguoSWMEAAAAAACIIRgBAAAAAABimNKCAZnPAgAAAFr2zrML81vAXjRGAAAAAACAGIIRAAAAAAAghiktAAAAAKB55fyWWa3xlT9js/HsTWMEAAAAAACIIRgBAAAAAABiCEYAAAAAAIAYfscI3UnfkLSpCAAAAKT75PlI+rMlQGMEAAAAAAAIIhgBAAAAAABimNKCDpjPAgAAANjH1nMWE1vtKn82npOxB40RAAAAAAAghmAEAAAAAACIYUoLGqUWCAAAAHCeZ57FmNuCMWiMAAAAAAAAMQQjAAAAAABADFNaAAAAAABPKOe2zGpBvzRGAAAAAACAGIIRAAAAAAAghiktujByNbGsYAIAAADQh2ee6Yz8TAt6pjECAAAAAADEEIwAAAAAAAAxTGlBBeazAAAAAMZXPgMyqwXt0BgBAAAAAABiCEYAAAAAAIAYprTgJOazAAAAAHJtPRsysfWa8t/L8zbepTECAAAAAADEEIwAAAAAAAAxTGnBgdT5AAAAAPhN+fzIrBacQ2MEAAAAAACIIRgBAAAAAABimNKCD5nLAgAAAGAPZrVeU/4beUbHKzRGAAAAAACAGIIRAAAAAAAghikteINqHgAAAABHMqsFx9EYAQAAAAAAYghGAAAAAACAGKa04EnmswAAAACoYeu5lIkteI/GCAAAAAAAEEMwAgAAAAAAxDClBb8wnwUAAABAq8pnV2a14HkaIwAAAAAAQAzBCAAAAAAAEMOUFs1S/wMAAACA52xNwnvGBv+lMQIAAAAAAMQQjAAAAAAAADFMacE3W7VDAAAAAOhN+azLrBb8oTECAAAAAADEEIwAAAAAAAAxTGnBxXwWAAAAAOMbeVar/Pt41sffaIwAAAAAAAAxBCMAAAAAAEAMU1rEUqkDAAAAINXIs1rwNxojAAAAAABADMEIAAAAAAAQw5QWAAAAAADDKKfBzOnzE40RAAAAAAAghmAEAAAAAACIYUqLKKpzAAAAAPBV+cysnKGCUWmMAAAAAAAAMQQjAAAAAABADFNaDM98FgAAAAA8x6wWCTRGAAAAAACAGIIRAAAAAAAghiktmvVJbc98FgAAAAAAP9EYAQAAAAAAYghGAAAAAACAGKa06JrJLAAAAAA4xidT99AyjREAAAAAACCGYAQAAAAAAIhhSosuqO0BAAAAALAHjREAAAAAACCGYAQAAAAAAIhhSovulLNaAAAAAMDxTN0zEo0RAAAAAAAghmAEAAAAAACIIRgBAAAAAABiCEYAAAAAAIAYghEAAAAAACCGYAQAAAAAAIghGAEAAAAAAGIIRgAAAAAAgBiCEQAAAAAAIIZgBAAAAAAAiCEYAQAAAAAAYlxrHwAAAAAAAI4wr8vj9f02VTwJLdEYAQAAAAAAYghGAAAAAACAGIIRAAAAAP7X3h3jtpEEARRtGZMKyucUvAVvvABzH4CnmAswtCFutFwuYMuiYG97/N+LWgAlVf5RRQDIEEYAAAAAAIAMYQQAAAAAAMhYZg8AAAAAAMB+HNfDf34+bedJk8DH2BgBAAAAAAAyhBEAAAAAACBDGAEAAAAAADKEEQAAAAAAIEMYAQAAAAAAMpbZAwAAAAAAsF/H9XB7n7bzxEngfWyMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnL7AEAAAAAANiv03aePQI8xMYIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkLHMHgAAAAAAgP06rofb+7SdJ04C72NjBAAAAAAAyBBGAAAAAACADGEEAAAAAADIEEYAAAAAAIAMYQQAAAAAAMgQRgAAAAAAgIxl9gAAAAAAAOzXaTvPHgEeYmMEAAAAAADIEEYAAAAAAIAMp7QAAAAAAPiw43q4vZ3VYg9sjAAAAAAAABnCCAAAAAAAkOGUFgAAAAAAf6T7M1/wDxsjAAAAAABAhjACAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkLLMHAAAAAADgz3BcD7f3aTtPnAS+z8YIAAAAAACQIYwAAAAAAAAZTmkBAAAAAPDTzTqrdf9/4VtsjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZy+wBAAAAAADgUcf1MHsEdsrGCAAAAAAAkCGMAAAAAAAAGU5pAQAAAADwS92fvTpt54mTgI0RAAAAAAAgRBgBAAAAAAAynNICAAAAAOB/87POat3/7v3fhB+xMQIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZAgjAAAAAABAhjACAAAAAABkLLMHAAAAAACg6bgeHvr8aTv/okkosTECAAAAAABkCCMAAAAAAECGMAIAAAAAAGQIIwAAAAAAQIYwAgAAAAAAZCyzBwAAAAAAgPc4rofb+7SdJ07CntkYAQAAAAAAMoQRAAAAAAAgwyktAAAAAAB25/6sFjzCxggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAA+4NnEgAABBFJREFUAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZwggAAAAAAJAhjAAAAAAAABnCCAAAAAAAkCGMAAAAAAAAGcIIAAAAAACQIYwAAAAAAAAZy+wBPuJ6vY4xxvg6voxxnTwMAAAAAAAw1dfxZYzxbz94yy7DyOVyGWOM8Xn8NXkSAAAAAADgd3G5XMbLy8ubn3m6vief/GZeX1/Htm3j+fl5PD09zR4HAAAAAACY6Hq9jsvlMtZ1HZ8+vf0tIrsMIwAAAAAAAB/hy9cBAAAAAIAMYQQAAAAAAMgQRgAAAAAAgAxhBAAAAAAAyBBGAAAAAACADGEEAAAAAADIEEYAAAAAAIAMYQQAAAAAAMgQRgAAAAAAgAxhBAAAAAAAyBBGAAAAAACADGEEAAAAAADIEEYAAAAAAIAMYQQAAAAAAMgQRgAAAAAAgAxhBAAAAAAAyBBGAAAAAACADGEEAAAAAADIEEYAAAAAAIAMYQQAAAAAAMgQRgAAAAAAgAxhBAAAAAAAyBBGAAAAAACADGEEAAAAAADIEEYAAAAAAIAMYQQAAAAAAMgQRgAAAAAAgAxhBAAAAAAAyBBGAAAAAACADGEEAAAAAADIEEYAAAAAAICMvwHkqupA3j0TxAAAAABJRU5ErkJggg==",
+      "text/plain": [
+       "<Figure size 2000x4000 with 1 Axes>"
+      ]
+     },
+     "metadata": {},
+     "output_type": "display_data"
+    }
+   ],
+   "source": [
+    "plt.figure(figsize=(20,40))\n",
+    "\n",
+    "plt.subplot(1,1,1)\n",
+    "plt.imshow(lungs)"
+   ]
+  },
+  {
    "cell_type": "code",
    "execution_count": null,
    "metadata": {},
@@ -1019,7 +641,7 @@
  ],
  "metadata": {
   "kernelspec": {
-   "display_name": "Python 3.7.13 ('env1')",
+   "display_name": "venv",
    "language": "python",
    "name": "python3"
   },
@@ -1033,12 +655,12 @@
    "name": "python",
    "nbconvert_exporter": "python",
    "pygments_lexer": "ipython3",
-   "version": "3.7.13"
+   "version": "3.7.16"
   },
   "orig_nbformat": 4,
   "vscode": {
    "interpreter": {
-    "hash": "73debb880a198c180bbd222a47dda85b4338a84f60caf5c95fac3f32e5ae8937"
+    "hash": "572ac709a4723f93826c4758b1d2d0b69d22c7b56265776d12836d04ab7ee591"
    }
   }
  },
Index: classifier/training/run.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import os\nimport sys\nimport pandas as pd \nimport torch \nfrom typing import Optional, List\nimport wandb\nimport warnings\n\nfrom dataclasses import dataclass, field\nfrom transformers import (\n    HfArgumentParser,\n    TrainingArguments,\n    set_seed,\n)\n\nfrom classifier.utils.file_utils import logging\nfrom classifier.training.trainer.standard_trainer import Trainer\nfrom classifier.training.trainer.config_runner import ConfigTrainer\nfrom classifier.data.data_loaders import get_dloader\nfrom classifier.models.classifier import classifier\n\nsys.dont_write_bytecode = True\nwarnings.filterwarnings(\"ignore\")\n\n@dataclass\nclass ModelArguments:\n    \"\"\"\n    Arguments pertaining to which model/config/tokenizer we are going to fine-tune from.\n    \"\"\"\n    model_path: Optional[str] = field(\n        default=None,\n        metadata={\"help\": \"Path to pretrained model or model identifier from ...\"},\n    )\n    \n    cache_dir: Optional[str] = field(\n        default=None,\n        metadata={\"help\": \"Where do you want to store the pretrained models\"},\n    )\n\n@dataclass\nclass DataTrainingArguments:\n    \"\"\"\n    Arguments pertaining to which model/config/tokenizer we are going to fine-tune from.\n    \"\"\"\n    data_path: Optional[str] = field(\n        default=None,\n        metadata={\"help\": \"Pretrained tokenizer name or path if not the same as model_name\"},\n    )\n\n@dataclass\nclass TrainingArguments:\n    \"\"\"\n    Arguments pertaining to which model/config/tokenizer we are going to fine-tune from.\n    \"\"\"\n    output_dir: str = field(\n        default = None, \n        metadata={\"help\": \"The output directory where the model predictions and checkpoints will be written.\"},\n    )\n\n    local_rank: int = field(default=-1, metadata={\"help\": \"For distributed training: local_rank\"})\n    seed: int = field(default=42, metadata={\"help\": \"Random seed that will be set at the beginning of training.\"})\n    report_to: Optional[List[str]] = field(\n        default=None, metadata={\"help\": \"The list of integrations to report the results and logs to.\"}\n    )\n    train_batch_size: int = field(\n        default=4, metadata={\"help\": \"Batch size per GPU/TPU core/CPU for training.\"}\n    )\n    eval_batch_size: int = field(\n        default=4, metadata={\"help\": \"Batch size per GPU/TPU core/CPU for evaluation.\"}\n    )\n    config_path: Optional[str] = field(\n        default=None, metadata={\"help\": \"Pretrained tokenizer name or path if not the same as model_name\"},\n    )\n    \n    num_train_epochs: int = field(\n        default=4, metadata={\"help\": \"Batch size per GPU/TPU core/CPU for evaluation.\"}\n    )\n\n    do_train: bool = field(default=True, metadata={\"help\": \"Whether to run training.\"})\n    do_eval: bool = field(default=False, metadata={\"help\": \"Whether to run eval on the dev set.\"})\n    \n    save_model: bool = field(default=False, metadata={\"help\": \"Whether to save model.\"})\n\n    fp16: bool = field(\n        default=False,\n        metadata={\"help\": \"Whether to use fp16 (mixed) precision instead of 32-bit\"},\n    )\n\ndef main(args_file=None):\n    parser = HfArgumentParser((ModelArguments, DataTrainingArguments, TrainingArguments))\n\n    if (len(sys.argv) == 2 and sys.argv[1].endswith(\".json\")) or args_file is not None:\n        # If we pass only one argument to the script and it's the path to a json file,\n        # let's parse it to get our arguments.\n        args_file_path = os.path.abspath(sys.argv[1]) if args_file is None else args_file\n        model_args, data_args, training_args = parser.parse_json_file(json_file=args_file_path)\n    else:\n        model_args, data_args, training_args = parser.parse_args_into_dataclasses()\n    \n    # Setup logging\n    logging.basicConfig(\n        format=\"%(asctime)s - %(levelname)s - %(name)s -   %(message)s\",\n        datefmt=\"%m/%d/%Y %H:%M:%S\",\n        level=logging.INFO #if training_args.local_rank in [-1, 0] else logging.WARN,\n    )\n    \n    logging.warning(\n        \"Device: %s, n_gpu: %s\",\n        torch.device(\"cuda:0\" if torch.cuda.is_available() else \"cpu\"),\n        torch.cuda.device_count(),\n    )\n\n    # Set seed\n    set_seed(training_args.seed)\n    \n    # Setup wandb\n    if training_args.report_to is not None:\n        if training_args.report_to == \"wandb\":\n            wandb.login()\n            wandb.init(\n                project=\"chexnet-classifier\",\n                name=model_args.model_name_or_path,\n                group=model_args.model_type,\n                tags=[\"baseline\", \"chextnet\"],\n                job_type=\"train\",\n            )\n\n    # Load datasets\n    logging.info(\"Loading dataset\")\n    data = pd.read_csv(data_args.data_path, index_col=0)\n    train_dataloader, val_dataloader  = get_dloader(df=data, fold=0)\n\n    # Load pretrained model\n    model = classifier(gcn = False, pretrained_path = model_args.model_path, freeze_feature = False, n_class=14)\n\n    # Initialize our Trainer\n    configs = ConfigTrainer(model_config = model, config_path=training_args.config_path, verbose=None)()\n    trainer = Trainer(\n                model = model, \n                train_data = train_dataloader,\n                val_data = val_dataloader,  \n                loss = configs[\"loss\"], \n                optimizer = configs[\"opt\"], \n                scheduler = configs[\"scheduler\"], \n                metric = configs[\"metric\"],\n                num_train_epochs = training_args.num_train_epochs,\n                output_dir = training_args.output_dir,\n                save_model = training_args.save_model,\n                fp16 = training_args.fp16\n    )\n    logging.getLogger(\"wandb.run_manager\").setLevel(logging.WARNING)\n\n    # Training\n    if training_args.do_train:\n        trainer.run(mode = [\"train\"])\n\n    # Evaluation \n    if training_args.do_eval:\n        logging.info(\"*** Evaluation ***\")\n        trainer.run(mode = [\"valid\"])\n\nif __name__ == \"__main__\":\n    main()\n\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/classifier/training/run.py b/classifier/training/run.py
--- a/classifier/training/run.py	(revision 914c0e7bb37d00d1a25c112f282b7b36d5b80d23)
+++ b/classifier/training/run.py	(date 1675858868867)
@@ -17,7 +17,7 @@
 from classifier.training.trainer.standard_trainer import Trainer
 from classifier.training.trainer.config_runner import ConfigTrainer
 from classifier.data.data_loaders import get_dloader
-from classifier.models.classifier import classifier
+from classifier.models.classify import classifier
 
 sys.dont_write_bytecode = True
 warnings.filterwarnings("ignore")
Index: notebooks/eda.ipynb
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>{\n \"cells\": [\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 1,\n   \"metadata\": {},\n   \"outputs\": [\n    {\n     \"data\": {\n      \"text/html\": [\n       \"<div>\\n\",\n       \"<style scoped>\\n\",\n       \"    .dataframe tbody tr th:only-of-type {\\n\",\n       \"        vertical-align: middle;\\n\",\n       \"    }\\n\",\n       \"\\n\",\n       \"    .dataframe tbody tr th {\\n\",\n       \"        vertical-align: top;\\n\",\n       \"    }\\n\",\n       \"\\n\",\n       \"    .dataframe thead th {\\n\",\n       \"        text-align: right;\\n\",\n       \"    }\\n\",\n       \"</style>\\n\",\n       \"<table border=\\\"1\\\" class=\\\"dataframe\\\">\\n\",\n       \"  <thead>\\n\",\n       \"    <tr style=\\\"text-align: right;\\\">\\n\",\n       \"      <th></th>\\n\",\n       \"      <th>image_ids</th>\\n\",\n       \"      <th>Aortic enlargement</th>\\n\",\n       \"      <th>Atelectasis</th>\\n\",\n       \"      <th>Calcification</th>\\n\",\n       \"      <th>Cardiomegaly</th>\\n\",\n       \"      <th>Consolidation</th>\\n\",\n       \"      <th>ILD</th>\\n\",\n       \"      <th>Infiltration</th>\\n\",\n       \"      <th>Lung Opacity</th>\\n\",\n       \"      <th>Nodule Mass</th>\\n\",\n       \"      <th>Other lesion</th>\\n\",\n       \"      <th>Pleural effusion</th>\\n\",\n       \"      <th>Pleural thickening</th>\\n\",\n       \"      <th>Pneumothorax</th>\\n\",\n       \"      <th>Pulmonary fibrosis</th>\\n\",\n       \"      <th>image_paths</th>\\n\",\n       \"      <th>Images</th>\\n\",\n       \"    </tr>\\n\",\n       \"  </thead>\\n\",\n       \"  <tbody>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>0</th>\\n\",\n       \"      <td>50a418190bc3fb1ef1633bf9678929b3</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/vinbig...</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/Source...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>1</th>\\n\",\n       \"      <td>21a10246a5ec7af151081d0cd6d65dc9</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/vinbig...</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/Source...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>2</th>\\n\",\n       \"      <td>9a5094b2563a1ef3ff50dc5c7ff71345</td>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/vinbig...</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/Source...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>3</th>\\n\",\n       \"      <td>051132a778e61a86eb147c7c6f564dfe</td>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>1.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/vinbig...</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/Source...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>4</th>\\n\",\n       \"      <td>063319de25ce7edb9b1c6b8881290140</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/vinbig...</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/Source...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>...</th>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>14995</th>\\n\",\n       \"      <td>7c0ddf911bdb68fca14d7172486827cb</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/vinbig...</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/Source...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>14996</th>\\n\",\n       \"      <td>209e3a5c73c1195d805dd25d086b3c6d</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/vinbig...</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/Source...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>14997</th>\\n\",\n       \"      <td>1bea772246421c37929f8cbc43dba729</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/vinbig...</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/Source...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>14998</th>\\n\",\n       \"      <td>ae86eabab95525b41b8e79883ff1cef9</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/vinbig...</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/Source...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>14999</th>\\n\",\n       \"      <td>839b2311ffad9bdd9aa98c74aad6e251</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>0.0</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/vinbig...</td>\\n\",\n       \"      <td>/content/drive/MyDrive/Classification2D/Source...</td>\\n\",\n       \"    </tr>\\n\",\n       \"  </tbody>\\n\",\n       \"</table>\\n\",\n       \"<p>15000 rows × 17 columns</p>\\n\",\n       \"</div>\"\n      ],\n      \"text/plain\": [\n       \"                              image_ids  Aortic enlargement  Atelectasis  \\\\\\n\",\n       \"0      50a418190bc3fb1ef1633bf9678929b3                 0.0          0.0   \\n\",\n       \"1      21a10246a5ec7af151081d0cd6d65dc9                 0.0          0.0   \\n\",\n       \"2      9a5094b2563a1ef3ff50dc5c7ff71345                 1.0          0.0   \\n\",\n       \"3      051132a778e61a86eb147c7c6f564dfe                 1.0          0.0   \\n\",\n       \"4      063319de25ce7edb9b1c6b8881290140                 0.0          0.0   \\n\",\n       \"...                                 ...                 ...          ...   \\n\",\n       \"14995  7c0ddf911bdb68fca14d7172486827cb                 0.0          0.0   \\n\",\n       \"14996  209e3a5c73c1195d805dd25d086b3c6d                 0.0          0.0   \\n\",\n       \"14997  1bea772246421c37929f8cbc43dba729                 0.0          0.0   \\n\",\n       \"14998  ae86eabab95525b41b8e79883ff1cef9                 0.0          0.0   \\n\",\n       \"14999  839b2311ffad9bdd9aa98c74aad6e251                 0.0          0.0   \\n\",\n       \"\\n\",\n       \"       Calcification  Cardiomegaly  Consolidation  ILD  Infiltration  \\\\\\n\",\n       \"0                0.0           0.0            0.0  0.0           0.0   \\n\",\n       \"1                0.0           0.0            0.0  0.0           0.0   \\n\",\n       \"2                0.0           1.0            0.0  0.0           0.0   \\n\",\n       \"3                0.0           1.0            0.0  0.0           0.0   \\n\",\n       \"4                0.0           0.0            0.0  0.0           0.0   \\n\",\n       \"...              ...           ...            ...  ...           ...   \\n\",\n       \"14995            0.0           0.0            0.0  0.0           0.0   \\n\",\n       \"14996            0.0           0.0            0.0  0.0           0.0   \\n\",\n       \"14997            0.0           0.0            0.0  0.0           0.0   \\n\",\n       \"14998            0.0           0.0            0.0  0.0           0.0   \\n\",\n       \"14999            0.0           0.0            0.0  0.0           0.0   \\n\",\n       \"\\n\",\n       \"       Lung Opacity  Nodule Mass  Other lesion  Pleural effusion  \\\\\\n\",\n       \"0               0.0          0.0           0.0               0.0   \\n\",\n       \"1               0.0          0.0           0.0               0.0   \\n\",\n       \"2               0.0          0.0           0.0               1.0   \\n\",\n       \"3               0.0          0.0           0.0               0.0   \\n\",\n       \"4               0.0          0.0           0.0               0.0   \\n\",\n       \"...             ...          ...           ...               ...   \\n\",\n       \"14995           0.0          0.0           0.0               0.0   \\n\",\n       \"14996           0.0          0.0           0.0               0.0   \\n\",\n       \"14997           0.0          0.0           0.0               0.0   \\n\",\n       \"14998           0.0          0.0           0.0               0.0   \\n\",\n       \"14999           0.0          0.0           0.0               0.0   \\n\",\n       \"\\n\",\n       \"       Pleural thickening  Pneumothorax  Pulmonary fibrosis  \\\\\\n\",\n       \"0                     0.0           0.0                 0.0   \\n\",\n       \"1                     0.0           0.0                 0.0   \\n\",\n       \"2                     1.0           0.0                 0.0   \\n\",\n       \"3                     1.0           0.0                 0.0   \\n\",\n       \"4                     0.0           0.0                 0.0   \\n\",\n       \"...                   ...           ...                 ...   \\n\",\n       \"14995                 0.0           0.0                 0.0   \\n\",\n       \"14996                 0.0           0.0                 0.0   \\n\",\n       \"14997                 0.0           0.0                 0.0   \\n\",\n       \"14998                 0.0           0.0                 0.0   \\n\",\n       \"14999                 0.0           0.0                 0.0   \\n\",\n       \"\\n\",\n       \"                                             image_paths  \\\\\\n\",\n       \"0      /content/drive/MyDrive/Classification2D/vinbig...   \\n\",\n       \"1      /content/drive/MyDrive/Classification2D/vinbig...   \\n\",\n       \"2      /content/drive/MyDrive/Classification2D/vinbig...   \\n\",\n       \"3      /content/drive/MyDrive/Classification2D/vinbig...   \\n\",\n       \"4      /content/drive/MyDrive/Classification2D/vinbig...   \\n\",\n       \"...                                                  ...   \\n\",\n       \"14995  /content/drive/MyDrive/Classification2D/vinbig...   \\n\",\n       \"14996  /content/drive/MyDrive/Classification2D/vinbig...   \\n\",\n       \"14997  /content/drive/MyDrive/Classification2D/vinbig...   \\n\",\n       \"14998  /content/drive/MyDrive/Classification2D/vinbig...   \\n\",\n       \"14999  /content/drive/MyDrive/Classification2D/vinbig...   \\n\",\n       \"\\n\",\n       \"                                                  Images  \\n\",\n       \"0      /content/drive/MyDrive/Classification2D/Source...  \\n\",\n       \"1      /content/drive/MyDrive/Classification2D/Source...  \\n\",\n       \"2      /content/drive/MyDrive/Classification2D/Source...  \\n\",\n       \"3      /content/drive/MyDrive/Classification2D/Source...  \\n\",\n       \"4      /content/drive/MyDrive/Classification2D/Source...  \\n\",\n       \"...                                                  ...  \\n\",\n       \"14995  /content/drive/MyDrive/Classification2D/Source...  \\n\",\n       \"14996  /content/drive/MyDrive/Classification2D/Source...  \\n\",\n       \"14997  /content/drive/MyDrive/Classification2D/Source...  \\n\",\n       \"14998  /content/drive/MyDrive/Classification2D/Source...  \\n\",\n       \"14999  /content/drive/MyDrive/Classification2D/Source...  \\n\",\n       \"\\n\",\n       \"[15000 rows x 17 columns]\"\n      ]\n     },\n     \"execution_count\": 1,\n     \"metadata\": {},\n     \"output_type\": \"execute_result\"\n    }\n   ],\n   \"source\": [\n    \"import pandas as pd \\n\",\n    \"import numpy as np \\n\",\n    \"import torch\\n\",\n    \"import torch.nn as nn \\n\",\n    \"\\n\",\n    \"classes = np.load('/Users/HPhuc/Practice/12. classification/vinbigdata/output/columns_14.npy')\\n\",\n    \" \\n\",\n    \"data = pd.read_csv('/Users/HPhuc/Practice/12. classification/vinbigdata/output/csv/data.csv', index_col=0)\\n\",\n    \"data\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 2,\n   \"metadata\": {},\n   \"outputs\": [\n    {\n     \"data\": {\n      \"text/html\": [\n       \"<div>\\n\",\n       \"<style scoped>\\n\",\n       \"    .dataframe tbody tr th:only-of-type {\\n\",\n       \"        vertical-align: middle;\\n\",\n       \"    }\\n\",\n       \"\\n\",\n       \"    .dataframe tbody tr th {\\n\",\n       \"        vertical-align: top;\\n\",\n       \"    }\\n\",\n       \"\\n\",\n       \"    .dataframe thead th {\\n\",\n       \"        text-align: right;\\n\",\n       \"    }\\n\",\n       \"</style>\\n\",\n       \"<table border=\\\"1\\\" class=\\\"dataframe\\\">\\n\",\n       \"  <thead>\\n\",\n       \"    <tr style=\\\"text-align: right;\\\">\\n\",\n       \"      <th></th>\\n\",\n       \"      <th>0.0</th>\\n\",\n       \"      <th>1.0</th>\\n\",\n       \"    </tr>\\n\",\n       \"  </thead>\\n\",\n       \"  <tbody>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Aortic enlargement</th>\\n\",\n       \"      <td>11933</td>\\n\",\n       \"      <td>3067</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Atelectasis</th>\\n\",\n       \"      <td>14814</td>\\n\",\n       \"      <td>186</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Calcification</th>\\n\",\n       \"      <td>14548</td>\\n\",\n       \"      <td>452</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Cardiomegaly</th>\\n\",\n       \"      <td>12700</td>\\n\",\n       \"      <td>2300</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Consolidation</th>\\n\",\n       \"      <td>14647</td>\\n\",\n       \"      <td>353</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>ILD</th>\\n\",\n       \"      <td>14614</td>\\n\",\n       \"      <td>386</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Infiltration</th>\\n\",\n       \"      <td>14387</td>\\n\",\n       \"      <td>613</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Lung Opacity</th>\\n\",\n       \"      <td>13678</td>\\n\",\n       \"      <td>1322</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Nodule Mass</th>\\n\",\n       \"      <td>14174</td>\\n\",\n       \"      <td>826</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Other lesion</th>\\n\",\n       \"      <td>13866</td>\\n\",\n       \"      <td>1134</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Pleural effusion</th>\\n\",\n       \"      <td>13968</td>\\n\",\n       \"      <td>1032</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Pleural thickening</th>\\n\",\n       \"      <td>13019</td>\\n\",\n       \"      <td>1981</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Pneumothorax</th>\\n\",\n       \"      <td>14904</td>\\n\",\n       \"      <td>96</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Pulmonary fibrosis</th>\\n\",\n       \"      <td>13383</td>\\n\",\n       \"      <td>1617</td>\\n\",\n       \"    </tr>\\n\",\n       \"  </tbody>\\n\",\n       \"</table>\\n\",\n       \"</div>\"\n      ],\n      \"text/plain\": [\n       \"                      0.0   1.0\\n\",\n       \"Aortic enlargement  11933  3067\\n\",\n       \"Atelectasis         14814   186\\n\",\n       \"Calcification       14548   452\\n\",\n       \"Cardiomegaly        12700  2300\\n\",\n       \"Consolidation       14647   353\\n\",\n       \"ILD                 14614   386\\n\",\n       \"Infiltration        14387   613\\n\",\n       \"Lung Opacity        13678  1322\\n\",\n       \"Nodule Mass         14174   826\\n\",\n       \"Other lesion        13866  1134\\n\",\n       \"Pleural effusion    13968  1032\\n\",\n       \"Pleural thickening  13019  1981\\n\",\n       \"Pneumothorax        14904    96\\n\",\n       \"Pulmonary fibrosis  13383  1617\"\n      ]\n     },\n     \"execution_count\": 2,\n     \"metadata\": {},\n     \"output_type\": \"execute_result\"\n    }\n   ],\n   \"source\": [\n    \"pd.DataFrame([data[f'{c}'].value_counts() for i, c in enumerate(classes)], index=classes)\\n\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 3,\n   \"metadata\": {},\n   \"outputs\": [\n    {\n     \"data\": {\n      \"image/png\": \"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\",\n      \"text/plain\": [\n       \"<Figure size 432x288 with 1 Axes>\"\n      ]\n     },\n     \"metadata\": {\n      \"needs_background\": \"light\"\n     },\n     \"output_type\": \"display_data\"\n    }\n   ],\n   \"source\": [\n    \"classes_cnt = pd.DataFrame([data[f'{c}'].value_counts() for i, c in enumerate(classes)], index= [i for i in range(len(classes))])\\n\",\n    \"ax = classes_cnt.plot.bar(rot=0)\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 4,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"classes_cnt = [data[f'{c}'].sum(axis=0) for c in classes]\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 5,\n   \"metadata\": {},\n   \"outputs\": [\n    {\n     \"data\": {\n      \"text/html\": [\n       \"<div>\\n\",\n       \"<style scoped>\\n\",\n       \"    .dataframe tbody tr th:only-of-type {\\n\",\n       \"        vertical-align: middle;\\n\",\n       \"    }\\n\",\n       \"\\n\",\n       \"    .dataframe tbody tr th {\\n\",\n       \"        vertical-align: top;\\n\",\n       \"    }\\n\",\n       \"\\n\",\n       \"    .dataframe thead th {\\n\",\n       \"        text-align: right;\\n\",\n       \"    }\\n\",\n       \"</style>\\n\",\n       \"<table border=\\\"1\\\" class=\\\"dataframe\\\">\\n\",\n       \"  <thead>\\n\",\n       \"    <tr style=\\\"text-align: right;\\\">\\n\",\n       \"      <th></th>\\n\",\n       \"      <th>num.of.diseases</th>\\n\",\n       \"    </tr>\\n\",\n       \"  </thead>\\n\",\n       \"  <tbody>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Aortic enlargement</th>\\n\",\n       \"      <td>3067.0</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Atelectasis</th>\\n\",\n       \"      <td>186.0</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Calcification</th>\\n\",\n       \"      <td>452.0</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Cardiomegaly</th>\\n\",\n       \"      <td>2300.0</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Consolidation</th>\\n\",\n       \"      <td>353.0</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>ILD</th>\\n\",\n       \"      <td>386.0</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Infiltration</th>\\n\",\n       \"      <td>613.0</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Lung Opacity</th>\\n\",\n       \"      <td>1322.0</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Nodule Mass</th>\\n\",\n       \"      <td>826.0</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Other lesion</th>\\n\",\n       \"      <td>1134.0</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Pleural effusion</th>\\n\",\n       \"      <td>1032.0</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Pleural thickening</th>\\n\",\n       \"      <td>1981.0</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Pneumothorax</th>\\n\",\n       \"      <td>96.0</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>Pulmonary fibrosis</th>\\n\",\n       \"      <td>1617.0</td>\\n\",\n       \"    </tr>\\n\",\n       \"  </tbody>\\n\",\n       \"</table>\\n\",\n       \"</div>\"\n      ],\n      \"text/plain\": [\n       \"                    num.of.diseases\\n\",\n       \"Aortic enlargement           3067.0\\n\",\n       \"Atelectasis                   186.0\\n\",\n       \"Calcification                 452.0\\n\",\n       \"Cardiomegaly                 2300.0\\n\",\n       \"Consolidation                 353.0\\n\",\n       \"ILD                           386.0\\n\",\n       \"Infiltration                  613.0\\n\",\n       \"Lung Opacity                 1322.0\\n\",\n       \"Nodule Mass                   826.0\\n\",\n       \"Other lesion                 1134.0\\n\",\n       \"Pleural effusion             1032.0\\n\",\n       \"Pleural thickening           1981.0\\n\",\n       \"Pneumothorax                   96.0\\n\",\n       \"Pulmonary fibrosis           1617.0\"\n      ]\n     },\n     \"execution_count\": 5,\n     \"metadata\": {},\n     \"output_type\": \"execute_result\"\n    }\n   ],\n   \"source\": [\n    \"num_of_disease = pd.DataFrame({'num.of.diseases': classes_cnt}, index=classes)\\n\",\n    \"num_of_disease\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 6,\n   \"metadata\": {},\n   \"outputs\": [\n    {\n     \"data\": {\n      \"image/png\": \"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\",\n      \"text/plain\": [\n       \"<Figure size 432x288 with 1 Axes>\"\n      ]\n     },\n     \"metadata\": {\n      \"needs_background\": \"light\"\n     },\n     \"output_type\": \"display_data\"\n    }\n   ],\n   \"source\": [\n    \"ax = num_of_disease.plot.bar(rot=0)\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": null,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": []\n  }\n ],\n \"metadata\": {\n  \"kernelspec\": {\n   \"display_name\": \"Python 3.7.13 ('env1')\",\n   \"language\": \"python\",\n   \"name\": \"python3\"\n  },\n  \"language_info\": {\n   \"codemirror_mode\": {\n    \"name\": \"ipython\",\n    \"version\": 3\n   },\n   \"file_extension\": \".py\",\n   \"mimetype\": \"text/x-python\",\n   \"name\": \"python\",\n   \"nbconvert_exporter\": \"python\",\n   \"pygments_lexer\": \"ipython3\",\n   \"version\": \"3.7.13\"\n  },\n  \"orig_nbformat\": 4,\n  \"vscode\": {\n   \"interpreter\": {\n    \"hash\": \"73debb880a198c180bbd222a47dda85b4338a84f60caf5c95fac3f32e5ae8937\"\n   }\n  }\n },\n \"nbformat\": 4,\n \"nbformat_minor\": 2\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/notebooks/eda.ipynb b/notebooks/eda.ipynb
--- a/notebooks/eda.ipynb	(revision 914c0e7bb37d00d1a25c112f282b7b36d5b80d23)
+++ b/notebooks/eda.ipynb	(date 1675852089992)
@@ -684,7 +684,7 @@
  ],
  "metadata": {
   "kernelspec": {
-   "display_name": "Python 3.7.13 ('env1')",
+   "display_name": "venv",
    "language": "python",
    "name": "python3"
   },
@@ -698,12 +698,12 @@
    "name": "python",
    "nbconvert_exporter": "python",
    "pygments_lexer": "ipython3",
-   "version": "3.7.13"
+   "version": "3.7.16"
   },
   "orig_nbformat": 4,
   "vscode": {
    "interpreter": {
-    "hash": "73debb880a198c180bbd222a47dda85b4338a84f60caf5c95fac3f32e5ae8937"
+    "hash": "572ac709a4723f93826c4758b1d2d0b69d22c7b56265776d12836d04ab7ee591"
    }
   }
  },
Index: classifier/models/gcn.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import math \nimport torch\nimport torch.nn as nn \nimport numpy as np\nfrom torchvision.models import densenet121\n\nclass GraphLinear(nn.Module):\n    def __init__(self, in_channels, out_channels, adj_mtrix, bias=False):\n        super().__init__()\n        self.weight    = nn.Parameter(torch.Tensor(in_channels, out_channels), requires_grad=True)\n        self.adj_mtrix = nn.Parameter(torch.tensor(adj_mtrix, dtype=torch.float), requires_grad=False)\n        if bias:\n            self.bias = nn.Parameter(torch.Tensor(1, 1, out_channels), requires_grad=True)\n        else:\n            self.register_parameter('bias', None)\n            \n        self.reset_params()\n\n    def reset_params(self):\n        stdv = 1./math.sqrt(self.weight.size(1))\n        self.weight.data.uniform_(-stdv, stdv)\n        if self.bias is not None:\n            self.bias.data.uniform_(-stdv, stdv)\n\n    def forward(self, embedding_nodes):\n        support = torch.matmul(embedding_nodes.float(), self.weight.float())\n        output  = torch.matmul(self.adj_mtrix, support) \n        if self.bias is not None:\n            return output + self.bias\n        else:\n            return output\n\nclass GraphSequential(nn.Module):\n    def __init__(self, embedding_nodes, *args):\n        super().__init__()\n        if not torch.is_tensor(embedding_nodes):\n            embedding_nodes = torch.tensor(embedding_nodes, dtype=float)\n\n        self.embedding_nodes = nn.Parameter(embedding_nodes, requires_grad=False)\n        self.sequential = nn.Sequential(*args)\n\n    def forward(self):\n        return self.sequential(self.embedding_nodes)   # self.embedding_notes là input của self.sequential()\n\nclass GCN(nn.Module):\n    def __init__(self, in_channels, out_channels, embedding_nodes, adj_mtrix, bias=True):\n        super().__init__()\n\n        bottleneck  = int(np.round(out_channels // 2))\n        self.embedding = GraphSequential(embedding_nodes, *[\n            GraphLinear(in_channels, bottleneck, adj_mtrix, bias=bias),\n            nn.LeakyReLU(0.2),\n            GraphLinear(bottleneck, out_channels, adj_mtrix, bias=bias),\n        ])\n        self.sigm = nn.Sigmoid()\n\n    def forward(self, features):\n        embedding = self.embedding().cuda()\n        \"\"\" bias: True -> squeeze()\n        \"\"\"\n        embedding = embedding.squeeze() \n        embedding = torch.transpose(embedding, 0,1)\n        scores = torch.matmul(features, embedding)\n        scores = self.sigm(scores)\n        return scores \n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/classifier/models/gcn.py b/classifier/models/gcn.py
--- a/classifier/models/gcn.py	(revision 914c0e7bb37d00d1a25c112f282b7b36d5b80d23)
+++ b/classifier/models/gcn.py	(date 1675871481697)
@@ -3,6 +3,9 @@
 import torch.nn as nn 
 import numpy as np
 from torchvision.models import densenet121
+import torch.nn.functional as func
+
+device = torch.device("cuda:0" if torch.cuda.is_available() else "cpu")
 
 class GraphLinear(nn.Module):
     def __init__(self, in_channels, out_channels, adj_mtrix, bias=False):
@@ -10,7 +13,7 @@
         self.weight    = nn.Parameter(torch.Tensor(in_channels, out_channels), requires_grad=True)
         self.adj_mtrix = nn.Parameter(torch.tensor(adj_mtrix, dtype=torch.float), requires_grad=False)
         if bias:
-            self.bias = nn.Parameter(torch.Tensor(1, 1, out_channels), requires_grad=True)
+            self.bias = nn.Parameter(torch.zeros(out_channels), requires_grad=True)
         else:
             self.register_parameter('bias', None)
             
@@ -24,11 +27,8 @@
 
     def forward(self, embedding_nodes):
         support = torch.matmul(embedding_nodes.float(), self.weight.float())
-        output  = torch.matmul(self.adj_mtrix, support) 
-        if self.bias is not None:
-            return output + self.bias
-        else:
-            return output
+        output = func.linear(self.adj_mtrix, support.T, self.bias) 
+        return output
 
 class GraphSequential(nn.Module):
     def __init__(self, embedding_nodes, *args):
@@ -43,19 +43,19 @@
         return self.sequential(self.embedding_nodes)   # self.embedding_notes là input của self.sequential()
 
 class GCN(nn.Module):
-    def __init__(self, in_channels, out_channels, embedding_nodes, adj_mtrix, bias=True):
+    def __init__(self, in_channels, out_channels, embedding_nodes, adj_mtrix, bias=True, device="cpu"):
         super().__init__()
-
+        
         bottleneck  = int(np.round(out_channels // 2))
         self.embedding = GraphSequential(embedding_nodes, *[
-            GraphLinear(in_channels, bottleneck, adj_mtrix, bias=bias),
+            GraphLinear(in_channels, bottleneck, adj_mtrix, bias=True),
             nn.LeakyReLU(0.2),
-            GraphLinear(bottleneck, out_channels, adj_mtrix, bias=bias),
+            GraphLinear(bottleneck, out_channels, adj_mtrix, bias=True),
         ])
         self.sigm = nn.Sigmoid()
 
     def forward(self, features):
-        embedding = self.embedding().cuda()
+        embedding = self.embedding().to(device)
         """ bias: True -> squeeze()
         """
         embedding = embedding.squeeze() 
Index: notebooks/embedding.ipynb
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>{\n \"cells\": [\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 2,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"import pandas as pd \\n\",\n    \"import numpy as np\\n\",\n    \"import os \\n\",\n    \"import sys\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 3,\n   \"metadata\": {},\n   \"outputs\": [\n    {\n     \"data\": {\n      \"text/plain\": [\n       \"array(['Aortic enlargement', 'Atelectasis', 'Calcification',\\n\",\n       \"       'Cardiomegaly', 'Consolidation', 'ILD', 'Infiltration',\\n\",\n       \"       'Lung Opacity', 'Nodule Mass', 'Other lesion', 'Pleural effusion',\\n\",\n       \"       'Pleural thickening', 'Pneumothorax', 'Pulmonary fibrosis'],\\n\",\n       \"      dtype='<U18')\"\n      ]\n     },\n     \"execution_count\": 3,\n     \"metadata\": {},\n     \"output_type\": \"execute_result\"\n    }\n   ],\n   \"source\": [\n    \"classes = np.load('/Users/HPhuc/Practice/12. classification/vinbigdata/output/columns_14.npy')\\n\",\n    \"classes \"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 5,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"import torchtext.vocab as vocab\\n\",\n    \"embedding = vocab.GloVe(name='6B')\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 7,\n   \"metadata\": {},\n   \"outputs\": [\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"Aortic enlargement : [tensor(121.8791), tensor(101.9114)]\\n\",\n      \"Atelectasis : [tensor(84.1079)]\\n\",\n      \"Calcification : [tensor(90.7722)]\\n\",\n      \"Cardiomegaly : [tensor(0.)]\\n\",\n      \"Consolidation : [tensor(81.4628)]\\n\",\n      \"ILD : [tensor(90.7017)]\\n\",\n      \"Infiltration : [tensor(94.0361)]\\n\",\n      \"Lung Opacity : [tensor(104.6459), tensor(80.2757)]\\n\",\n      \"Nodule Mass : [tensor(97.4789), tensor(91.6649)]\\n\",\n      \"Other lesion : [tensor(66.4487), tensor(91.0003)]\\n\",\n      \"Pleural effusion : [tensor(113.9009), tensor(95.0730)]\\n\",\n      \"Pleural thickening : [tensor(113.9009), tensor(91.3722)]\\n\",\n      \"Pneumothorax : [tensor(102.7047)]\\n\",\n      \"Pulmonary fibrosis : [tensor(108.6708), tensor(98.1578)]\\n\"\n     ]\n    },\n    {\n     \"data\": {\n      \"text/plain\": [\n       \"(14, 300)\"\n      ]\n     },\n     \"execution_count\": 7,\n     \"metadata\": {},\n     \"output_type\": \"execute_result\"\n    }\n   ],\n   \"source\": [\n    \"vec_ls = []\\n\",\n    \"\\n\",\n    \"for c in classes:\\n\",\n    \"  vec = embedding.get_vecs_by_tokens(c.split(\\\" \\\"), lower_case_backup=True)\\n\",\n    \"  print(c, ':', [v.abs().sum() for v in vec])\\n\",\n    \"  aggre = vec.mean(dim=0)\\n\",\n    \"  vec_ls.append(aggre)\\n\",\n    \"\\n\",\n    \"vecs = np.stack(vec_ls, axis=0)\\n\",\n    \"vecs.shape\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 8,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"import parameter as para \\n\",\n    \"from pathlib import Path\\n\",\n    \"import os \\n\",\n    \"\\n\",\n    \"np.save(Path(f'{para.output_path}' + '/embeddings_14'), vecs)\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": null,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": []\n  }\n ],\n \"metadata\": {\n  \"interpreter\": {\n   \"hash\": \"16fd0be27b59a639c645e56c43a95ce42e074baabdf12dcb6efea33a336ac199\"\n  },\n  \"kernelspec\": {\n   \"display_name\": \"Python 3.7.12 ('env1')\",\n   \"language\": \"python\",\n   \"name\": \"python3\"\n  },\n  \"language_info\": {\n   \"codemirror_mode\": {\n    \"name\": \"ipython\",\n    \"version\": 3\n   },\n   \"file_extension\": \".py\",\n   \"mimetype\": \"text/x-python\",\n   \"name\": \"python\",\n   \"nbconvert_exporter\": \"python\",\n   \"pygments_lexer\": \"ipython3\",\n   \"version\": \"3.7.13\"\n  },\n  \"orig_nbformat\": 4\n },\n \"nbformat\": 4,\n \"nbformat_minor\": 2\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/notebooks/embedding.ipynb b/notebooks/embedding.ipynb
--- a/notebooks/embedding.ipynb	(revision 914c0e7bb37d00d1a25c112f282b7b36d5b80d23)
+++ b/notebooks/embedding.ipynb	(date 1676649067485)
@@ -2,85 +2,76 @@
  "cells": [
   {
    "cell_type": "code",
-   "execution_count": 2,
+   "execution_count": 1,
    "metadata": {},
    "outputs": [],
    "source": [
     "import pandas as pd \n",
-    "import numpy as np\n",
-    "import os \n",
-    "import sys"
+    "import numpy as np"
    ]
   },
   {
    "cell_type": "code",
-   "execution_count": 3,
+   "execution_count": 2,
    "metadata": {},
    "outputs": [
     {
      "data": {
       "text/plain": [
-       "array(['Aortic enlargement', 'Atelectasis', 'Calcification',\n",
-       "       'Cardiomegaly', 'Consolidation', 'ILD', 'Infiltration',\n",
-       "       'Lung Opacity', 'Nodule Mass', 'Other lesion', 'Pleural effusion',\n",
-       "       'Pleural thickening', 'Pneumothorax', 'Pulmonary fibrosis'],\n",
+       "array(['Atelectasis', 'Cardiomegaly', 'Effusion', 'Infiltration', 'Mass',\n",
+       "       'Nodule', 'Pneumonia', 'Pneumothorax', 'Consolidation', 'Edema',\n",
+       "       'Emphysema', 'Fibrosis', 'Pleural Thickening', 'Hernia'],\n",
        "      dtype='<U18')"
       ]
      },
-     "execution_count": 3,
+     "execution_count": 2,
      "metadata": {},
      "output_type": "execute_result"
     }
    ],
    "source": [
-    "classes = np.load('/Users/HPhuc/Practice/12. classification/vinbigdata/output/columns_14.npy')\n",
+    "classes = np.load('/Users/HPhuc/Practice/12. classification/chextnet/output/columns_14.npy')\n",
     "classes "
    ]
   },
   {
    "cell_type": "code",
-   "execution_count": 5,
+   "execution_count": 3,
    "metadata": {},
-   "outputs": [],
+   "outputs": [
+    {
+     "ename": "ModuleNotFoundError",
+     "evalue": "No module named 'torchtext'",
+     "output_type": "error",
+     "traceback": [
+      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
+      "\u001b[0;31mModuleNotFoundError\u001b[0m                       Traceback (most recent call last)",
+      "\u001b[0;32m/var/folders/kv/zlv1d6k97jx3lbs487816pj80000gn/T/ipykernel_16252/701520120.py\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0;32mimport\u001b[0m \u001b[0mtorchtext\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mvocab\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0mvocab\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      2\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0membedding\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mvocab\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mGloVe\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mname\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'6B'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
+      "\u001b[0;31mModuleNotFoundError\u001b[0m: No module named 'torchtext'"
+     ]
+    }
+   ],
    "source": [
     "import torchtext.vocab as vocab\n",
+    "\n",
     "embedding = vocab.GloVe(name='6B')"
    ]
   },
   {
    "cell_type": "code",
-   "execution_count": 7,
+   "execution_count": 4,
    "metadata": {},
    "outputs": [
     {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "Aortic enlargement : [tensor(121.8791), tensor(101.9114)]\n",
-      "Atelectasis : [tensor(84.1079)]\n",
-      "Calcification : [tensor(90.7722)]\n",
-      "Cardiomegaly : [tensor(0.)]\n",
-      "Consolidation : [tensor(81.4628)]\n",
-      "ILD : [tensor(90.7017)]\n",
-      "Infiltration : [tensor(94.0361)]\n",
-      "Lung Opacity : [tensor(104.6459), tensor(80.2757)]\n",
-      "Nodule Mass : [tensor(97.4789), tensor(91.6649)]\n",
-      "Other lesion : [tensor(66.4487), tensor(91.0003)]\n",
-      "Pleural effusion : [tensor(113.9009), tensor(95.0730)]\n",
-      "Pleural thickening : [tensor(113.9009), tensor(91.3722)]\n",
-      "Pneumothorax : [tensor(102.7047)]\n",
-      "Pulmonary fibrosis : [tensor(108.6708), tensor(98.1578)]\n"
+     "ename": "NameError",
+     "evalue": "name 'classes' is not defined",
+     "output_type": "error",
+     "traceback": [
+      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
+      "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
+      "\u001b[0;32m/var/folders/kv/zlv1d6k97jx3lbs487816pj80000gn/T/ipykernel_54002/3779389100.py\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0mvec_ls\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      2\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 3\u001b[0;31m \u001b[0;32mfor\u001b[0m \u001b[0mc\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mclasses\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      4\u001b[0m   \u001b[0mvec\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0membedding\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_vecs_by_tokens\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mc\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msplit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\" \"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlower_case_backup\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m   \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mc\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m':'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mv\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mabs\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msum\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mv\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mvec\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
+      "\u001b[0;31mNameError\u001b[0m: name 'classes' is not defined"
      ]
-    },
-    {
-     "data": {
-      "text/plain": [
-       "(14, 300)"
-      ]
-     },
-     "execution_count": 7,
-     "metadata": {},
-     "output_type": "execute_result"
     }
    ],
    "source": [
@@ -118,11 +109,8 @@
   }
  ],
  "metadata": {
-  "interpreter": {
-   "hash": "16fd0be27b59a639c645e56c43a95ce42e074baabdf12dcb6efea33a336ac199"
-  },
   "kernelspec": {
-   "display_name": "Python 3.7.12 ('env1')",
+   "display_name": "venv",
    "language": "python",
    "name": "python3"
   },
@@ -136,9 +124,14 @@
    "name": "python",
    "nbconvert_exporter": "python",
    "pygments_lexer": "ipython3",
-   "version": "3.7.13"
+   "version": "3.7.16"
   },
-  "orig_nbformat": 4
+  "orig_nbformat": 4,
+  "vscode": {
+   "interpreter": {
+    "hash": "572ac709a4723f93826c4758b1d2d0b69d22c7b56265776d12836d04ab7ee591"
+   }
+  }
  },
  "nbformat": 4,
  "nbformat_minor": 2
Index: notebooks/correlation.ipynb
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>{\n \"cells\": [\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 1,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"import pandas as pd \\n\",\n    \"import numpy as np\\n\",\n    \"import os \\n\",\n    \"import sys\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 2,\n   \"metadata\": {},\n   \"outputs\": [\n    {\n     \"data\": {\n      \"text/html\": [\n       \"<div>\\n\",\n       \"<style scoped>\\n\",\n       \"    .dataframe tbody tr th:only-of-type {\\n\",\n       \"        vertical-align: middle;\\n\",\n       \"    }\\n\",\n       \"\\n\",\n       \"    .dataframe tbody tr th {\\n\",\n       \"        vertical-align: top;\\n\",\n       \"    }\\n\",\n       \"\\n\",\n       \"    .dataframe thead th {\\n\",\n       \"        text-align: right;\\n\",\n       \"    }\\n\",\n       \"</style>\\n\",\n       \"<table border=\\\"1\\\" class=\\\"dataframe\\\">\\n\",\n       \"  <thead>\\n\",\n       \"    <tr style=\\\"text-align: right;\\\">\\n\",\n       \"      <th></th>\\n\",\n       \"      <th>class_name</th>\\n\",\n       \"      <th>class_id</th>\\n\",\n       \"      <th>rad_id</th>\\n\",\n       \"      <th>x_min</th>\\n\",\n       \"      <th>y_min</th>\\n\",\n       \"      <th>x_max</th>\\n\",\n       \"      <th>y_max</th>\\n\",\n       \"      <th>width</th>\\n\",\n       \"      <th>height</th>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>image_id</th>\\n\",\n       \"      <th></th>\\n\",\n       \"      <th></th>\\n\",\n       \"      <th></th>\\n\",\n       \"      <th></th>\\n\",\n       \"      <th></th>\\n\",\n       \"      <th></th>\\n\",\n       \"      <th></th>\\n\",\n       \"      <th></th>\\n\",\n       \"      <th></th>\\n\",\n       \"    </tr>\\n\",\n       \"  </thead>\\n\",\n       \"  <tbody>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>50a418190bc3fb1ef1633bf9678929b3</th>\\n\",\n       \"      <td>No finding</td>\\n\",\n       \"      <td>14</td>\\n\",\n       \"      <td>R11</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>2332</td>\\n\",\n       \"      <td>2580</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>21a10246a5ec7af151081d0cd6d65dc9</th>\\n\",\n       \"      <td>No finding</td>\\n\",\n       \"      <td>14</td>\\n\",\n       \"      <td>R7</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>2954</td>\\n\",\n       \"      <td>3159</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>9a5094b2563a1ef3ff50dc5c7ff71345</th>\\n\",\n       \"      <td>Cardiomegaly</td>\\n\",\n       \"      <td>3</td>\\n\",\n       \"      <td>R10</td>\\n\",\n       \"      <td>691.0</td>\\n\",\n       \"      <td>1375.0</td>\\n\",\n       \"      <td>1653.0</td>\\n\",\n       \"      <td>1831.0</td>\\n\",\n       \"      <td>2080</td>\\n\",\n       \"      <td>2336</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>051132a778e61a86eb147c7c6f564dfe</th>\\n\",\n       \"      <td>Aortic enlargement</td>\\n\",\n       \"      <td>0</td>\\n\",\n       \"      <td>R10</td>\\n\",\n       \"      <td>1264.0</td>\\n\",\n       \"      <td>743.0</td>\\n\",\n       \"      <td>1611.0</td>\\n\",\n       \"      <td>1019.0</td>\\n\",\n       \"      <td>2304</td>\\n\",\n       \"      <td>2880</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>063319de25ce7edb9b1c6b8881290140</th>\\n\",\n       \"      <td>No finding</td>\\n\",\n       \"      <td>14</td>\\n\",\n       \"      <td>R10</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>2540</td>\\n\",\n       \"      <td>3072</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>...</th>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"      <td>...</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>936fd5cff1c058d39817a08f58b72cae</th>\\n\",\n       \"      <td>No finding</td>\\n\",\n       \"      <td>14</td>\\n\",\n       \"      <td>R1</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>2444</td>\\n\",\n       \"      <td>3200</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>ca7e72954550eeb610fe22bf0244b7fa</th>\\n\",\n       \"      <td>No finding</td>\\n\",\n       \"      <td>14</td>\\n\",\n       \"      <td>R1</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>1994</td>\\n\",\n       \"      <td>2430</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>aa17d5312a0fb4a2939436abca7f9579</th>\\n\",\n       \"      <td>No finding</td>\\n\",\n       \"      <td>14</td>\\n\",\n       \"      <td>R8</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>2048</td>\\n\",\n       \"      <td>2500</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>4b56bc6d22b192f075f13231419dfcc8</th>\\n\",\n       \"      <td>Cardiomegaly</td>\\n\",\n       \"      <td>3</td>\\n\",\n       \"      <td>R8</td>\\n\",\n       \"      <td>771.0</td>\\n\",\n       \"      <td>979.0</td>\\n\",\n       \"      <td>1680.0</td>\\n\",\n       \"      <td>1311.0</td>\\n\",\n       \"      <td>1968</td>\\n\",\n       \"      <td>2040</td>\\n\",\n       \"    </tr>\\n\",\n       \"    <tr>\\n\",\n       \"      <th>5e272e3adbdaafb07a7e84a9e62b1a4c</th>\\n\",\n       \"      <td>No finding</td>\\n\",\n       \"      <td>14</td>\\n\",\n       \"      <td>R16</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>NaN</td>\\n\",\n       \"      <td>2048</td>\\n\",\n       \"      <td>2500</td>\\n\",\n       \"    </tr>\\n\",\n       \"  </tbody>\\n\",\n       \"</table>\\n\",\n       \"<p>67914 rows × 9 columns</p>\\n\",\n       \"</div>\"\n      ],\n      \"text/plain\": [\n       \"                                          class_name  class_id rad_id   x_min  \\\\\\n\",\n       \"image_id                                                                        \\n\",\n       \"50a418190bc3fb1ef1633bf9678929b3          No finding        14    R11     NaN   \\n\",\n       \"21a10246a5ec7af151081d0cd6d65dc9          No finding        14     R7     NaN   \\n\",\n       \"9a5094b2563a1ef3ff50dc5c7ff71345        Cardiomegaly         3    R10   691.0   \\n\",\n       \"051132a778e61a86eb147c7c6f564dfe  Aortic enlargement         0    R10  1264.0   \\n\",\n       \"063319de25ce7edb9b1c6b8881290140          No finding        14    R10     NaN   \\n\",\n       \"...                                              ...       ...    ...     ...   \\n\",\n       \"936fd5cff1c058d39817a08f58b72cae          No finding        14     R1     NaN   \\n\",\n       \"ca7e72954550eeb610fe22bf0244b7fa          No finding        14     R1     NaN   \\n\",\n       \"aa17d5312a0fb4a2939436abca7f9579          No finding        14     R8     NaN   \\n\",\n       \"4b56bc6d22b192f075f13231419dfcc8        Cardiomegaly         3     R8   771.0   \\n\",\n       \"5e272e3adbdaafb07a7e84a9e62b1a4c          No finding        14    R16     NaN   \\n\",\n       \"\\n\",\n       \"                                   y_min   x_max   y_max  width  height  \\n\",\n       \"image_id                                                                 \\n\",\n       \"50a418190bc3fb1ef1633bf9678929b3     NaN     NaN     NaN   2332    2580  \\n\",\n       \"21a10246a5ec7af151081d0cd6d65dc9     NaN     NaN     NaN   2954    3159  \\n\",\n       \"9a5094b2563a1ef3ff50dc5c7ff71345  1375.0  1653.0  1831.0   2080    2336  \\n\",\n       \"051132a778e61a86eb147c7c6f564dfe   743.0  1611.0  1019.0   2304    2880  \\n\",\n       \"063319de25ce7edb9b1c6b8881290140     NaN     NaN     NaN   2540    3072  \\n\",\n       \"...                                  ...     ...     ...    ...     ...  \\n\",\n       \"936fd5cff1c058d39817a08f58b72cae     NaN     NaN     NaN   2444    3200  \\n\",\n       \"ca7e72954550eeb610fe22bf0244b7fa     NaN     NaN     NaN   1994    2430  \\n\",\n       \"aa17d5312a0fb4a2939436abca7f9579     NaN     NaN     NaN   2048    2500  \\n\",\n       \"4b56bc6d22b192f075f13231419dfcc8   979.0  1680.0  1311.0   1968    2040  \\n\",\n       \"5e272e3adbdaafb07a7e84a9e62b1a4c     NaN     NaN     NaN   2048    2500  \\n\",\n       \"\\n\",\n       \"[67914 rows x 9 columns]\"\n      ]\n     },\n     \"execution_count\": 2,\n     \"metadata\": {},\n     \"output_type\": \"execute_result\"\n    }\n   ],\n   \"source\": [\n    \"data = pd.read_csv('/Users/HPhuc/Practice/12. classification/chest-X-rays/output/csv/train.csv', index_col=0)\\n\",\n    \"data\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": null,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": []\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": null,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"classes = np.load('/Users/HPhuc/Practice/12. classification/vinbigdata/output/columns_14.npy')\\n\",\n    \"classes\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": null,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"concurr_arr = np.zeros([len(classes), len(classes)])\\n\",\n    \"\\n\",\n    \"for i, c1 in enumerate(classes):\\n\",\n    \"  for j, c2 in enumerate(classes):\\n\",\n    \"    concurr_arr[i, j] = len(data[(data[c1] == 1) & (data[c2] == 1)])\\n\",\n    \"\\n\",\n    \"concurr_mtrix = pd.DataFrame(concurr_arr, columns=classes, index=classes)\\n\",\n    \"concurr_mtrix\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": null,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"probs_mtrix = concurr_mtrix / np.diag(concurr_mtrix)[:, np.newaxis]\\n\",\n    \"probs_mtrix\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": null,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"smooth_corr = (probs_mtrix > 0.45).astype(int)  # threshold = 0.45\\n\",\n    \"smooth_corr\"\n   ]\n  },\n  {\n   \"cell_type\": \"markdown\",\n   \"metadata\": {},\n   \"source\": [\n    \"Over_smoothing problem\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": null,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"p = 0.2\\n\",\n    \"reweight = smooth_corr - np.identity(len(classes))\\n\",\n    \" # smooth_adj = probs_mtrix * p / (probs_mtrix.sum(axis=0) + 1e-6) / (1-p)\\n\",\n    \"reweight = reweight * 0.25 / (reweight.sum(axis=0) + 1e-6)\\n\",\n    \"reweight = reweight + np.identity(len(classes))\\n\",\n    \"reweight\"\n   ]\n  },\n  {\n   \"cell_type\": \"markdown\",\n   \"metadata\": {},\n   \"source\": [\n    \"Normalize\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": null,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"from pathlib import Path \\n\",\n    \"import parameter as para\\n\",\n    \"\\n\",\n    \"# D = np.diag(reweight.sum(axis=1) ** (-0.5))\\n\",\n    \"# reweight = D @ reweight.values.T @ D\\n\",\n    \"# np.save(Path(f'{para.output_path}' + '/correlations_14.npy'), reweight)\\n\",\n    \"# pd.DataFrame(reweight, columns=classes, index=classes)\\n\",\n    \"\\n\",\n    \"D = np.diag((reweight.sum(axis=1)) ** (-0.5))\\n\",\n    \"reweight = ((reweight @ D).T) @ D\\n\",\n    \"reweight\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": null,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"import parameter as para \\n\",\n    \"from pathlib import Path\\n\",\n    \"import os \\n\",\n    \"\\n\",\n    \"np.save(Path(f'{para.output_path}' + '/correlations_14'), reweight)\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": null,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": []\n  }\n ],\n \"metadata\": {\n  \"kernelspec\": {\n   \"display_name\": \"Python 3.7.13 ('env1')\",\n   \"language\": \"python\",\n   \"name\": \"python3\"\n  },\n  \"language_info\": {\n   \"codemirror_mode\": {\n    \"name\": \"ipython\",\n    \"version\": 3\n   },\n   \"file_extension\": \".py\",\n   \"mimetype\": \"text/x-python\",\n   \"name\": \"python\",\n   \"nbconvert_exporter\": \"python\",\n   \"pygments_lexer\": \"ipython3\",\n   \"version\": \"3.7.13\"\n  },\n  \"orig_nbformat\": 4,\n  \"vscode\": {\n   \"interpreter\": {\n    \"hash\": \"73debb880a198c180bbd222a47dda85b4338a84f60caf5c95fac3f32e5ae8937\"\n   }\n  }\n },\n \"nbformat\": 4,\n \"nbformat_minor\": 2\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/notebooks/correlation.ipynb b/notebooks/correlation.ipynb
--- a/notebooks/correlation.ipynb	(revision 914c0e7bb37d00d1a25c112f282b7b36d5b80d23)
+++ b/notebooks/correlation.ipynb	(date 1676724868977)
@@ -7,14 +7,12 @@
    "outputs": [],
    "source": [
     "import pandas as pd \n",
-    "import numpy as np\n",
-    "import os \n",
-    "import sys"
+    "import numpy as np"
    ]
   },
   {
    "cell_type": "code",
-   "execution_count": 2,
+   "execution_count": 4,
    "metadata": {},
    "outputs": [
     {
@@ -38,257 +36,1237 @@
        "  <thead>\n",
        "    <tr style=\"text-align: right;\">\n",
        "      <th></th>\n",
+       "      <th>image_id</th>\n",
        "      <th>class_name</th>\n",
-       "      <th>class_id</th>\n",
-       "      <th>rad_id</th>\n",
-       "      <th>x_min</th>\n",
-       "      <th>y_min</th>\n",
-       "      <th>x_max</th>\n",
-       "      <th>y_max</th>\n",
-       "      <th>width</th>\n",
-       "      <th>height</th>\n",
+       "      <th>image_path</th>\n",
+       "      <th>Atelectasis</th>\n",
+       "      <th>Cardiomegaly</th>\n",
+       "      <th>Effusion</th>\n",
+       "      <th>Infiltration</th>\n",
+       "      <th>Mass</th>\n",
+       "      <th>Nodule</th>\n",
+       "      <th>Pneumonia</th>\n",
+       "      <th>Pneumothorax</th>\n",
+       "      <th>Consolidation</th>\n",
+       "      <th>Edema</th>\n",
+       "      <th>Emphysema</th>\n",
+       "      <th>Fibrosis</th>\n",
+       "      <th>Pleural Thickening</th>\n",
+       "      <th>Hernia</th>\n",
+       "    </tr>\n",
+       "  </thead>\n",
+       "  <tbody>\n",
+       "    <tr>\n",
+       "      <th>0</th>\n",
+       "      <td>00000001_000.png</td>\n",
+       "      <td>Cardiomegaly</td>\n",
+       "      <td>/Users/HPhuc/Practice/12. classification/chext...</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
        "    </tr>\n",
        "    <tr>\n",
-       "      <th>image_id</th>\n",
+       "      <th>1</th>\n",
+       "      <td>00000001_001.png</td>\n",
+       "      <td>Cardiomegaly|Emphysema</td>\n",
+       "      <td>/Users/HPhuc/Practice/12. classification/chext...</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>2</th>\n",
+       "      <td>00000001_002.png</td>\n",
+       "      <td>Cardiomegaly|Effusion</td>\n",
+       "      <td>/Users/HPhuc/Practice/12. classification/chext...</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>3</th>\n",
+       "      <td>00000002_000.png</td>\n",
+       "      <td>No Finding</td>\n",
+       "      <td>/Users/HPhuc/Practice/12. classification/chext...</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>4</th>\n",
+       "      <td>00000003_000.png</td>\n",
+       "      <td>Hernia</td>\n",
+       "      <td>/Users/HPhuc/Practice/12. classification/chext...</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "    </tr>\n",
+       "  </tbody>\n",
+       "</table>\n",
+       "</div>"
+      ],
+      "text/plain": [
+       "           image_id              class_name  \\\n",
+       "0  00000001_000.png            Cardiomegaly   \n",
+       "1  00000001_001.png  Cardiomegaly|Emphysema   \n",
+       "2  00000001_002.png   Cardiomegaly|Effusion   \n",
+       "3  00000002_000.png              No Finding   \n",
+       "4  00000003_000.png                  Hernia   \n",
+       "\n",
+       "                                          image_path  Atelectasis  \\\n",
+       "0  /Users/HPhuc/Practice/12. classification/chext...          0.0   \n",
+       "1  /Users/HPhuc/Practice/12. classification/chext...          0.0   \n",
+       "2  /Users/HPhuc/Practice/12. classification/chext...          0.0   \n",
+       "3  /Users/HPhuc/Practice/12. classification/chext...          0.0   \n",
+       "4  /Users/HPhuc/Practice/12. classification/chext...          0.0   \n",
+       "\n",
+       "   Cardiomegaly  Effusion  Infiltration  Mass  Nodule  Pneumonia  \\\n",
+       "0           1.0       0.0           0.0   0.0     0.0        0.0   \n",
+       "1           1.0       0.0           0.0   0.0     0.0        0.0   \n",
+       "2           1.0       1.0           0.0   0.0     0.0        0.0   \n",
+       "3           0.0       0.0           0.0   0.0     0.0        0.0   \n",
+       "4           0.0       0.0           0.0   0.0     0.0        0.0   \n",
+       "\n",
+       "   Pneumothorax  Consolidation  Edema  Emphysema  Fibrosis  \\\n",
+       "0           0.0            0.0    0.0        0.0       0.0   \n",
+       "1           0.0            0.0    0.0        1.0       0.0   \n",
+       "2           0.0            0.0    0.0        0.0       0.0   \n",
+       "3           0.0            0.0    0.0        0.0       0.0   \n",
+       "4           0.0            0.0    0.0        0.0       0.0   \n",
+       "\n",
+       "   Pleural Thickening  Hernia  \n",
+       "0                 0.0     0.0  \n",
+       "1                 0.0     0.0  \n",
+       "2                 0.0     0.0  \n",
+       "3                 0.0     0.0  \n",
+       "4                 0.0     1.0  "
+      ]
+     },
+     "execution_count": 4,
+     "metadata": {},
+     "output_type": "execute_result"
+    }
+   ],
+   "source": [
+    "data = pd.read_csv('/Users/HPhuc/Practice/12. classification/chextnet/output/csv/train_data.csv', index_col=0)\n",
+    "data.head()"
+   ]
+  },
+  {
+   "cell_type": "code",
+   "execution_count": 6,
+   "metadata": {},
+   "outputs": [
+    {
+     "data": {
+      "text/plain": [
+       "array(['Atelectasis', 'Cardiomegaly', 'Effusion', 'Infiltration', 'Mass',\n",
+       "       'Nodule', 'Pneumonia', 'Pneumothorax', 'Consolidation', 'Edema',\n",
+       "       'Emphysema', 'Fibrosis', 'Pleural Thickening', 'Hernia'],\n",
+       "      dtype='<U18')"
+      ]
+     },
+     "execution_count": 6,
+     "metadata": {},
+     "output_type": "execute_result"
+    }
+   ],
+   "source": [
+    "classes = np.load('/Users/HPhuc/Practice/12. classification/chextnet/output/columns_14.npy')\n",
+    "classes"
+   ]
+  },
+  {
+   "cell_type": "code",
+   "execution_count": 7,
+   "metadata": {},
+   "outputs": [
+    {
+     "data": {
+      "text/html": [
+       "<div>\n",
+       "<style scoped>\n",
+       "    .dataframe tbody tr th:only-of-type {\n",
+       "        vertical-align: middle;\n",
+       "    }\n",
+       "\n",
+       "    .dataframe tbody tr th {\n",
+       "        vertical-align: top;\n",
+       "    }\n",
+       "\n",
+       "    .dataframe thead th {\n",
+       "        text-align: right;\n",
+       "    }\n",
+       "</style>\n",
+       "<table border=\"1\" class=\"dataframe\">\n",
+       "  <thead>\n",
+       "    <tr style=\"text-align: right;\">\n",
        "      <th></th>\n",
-       "      <th></th>\n",
-       "      <th></th>\n",
-       "      <th></th>\n",
-       "      <th></th>\n",
-       "      <th></th>\n",
-       "      <th></th>\n",
-       "      <th></th>\n",
+       "      <th>Atelectasis</th>\n",
+       "      <th>Cardiomegaly</th>\n",
+       "      <th>Effusion</th>\n",
+       "      <th>Infiltration</th>\n",
+       "      <th>Mass</th>\n",
+       "      <th>Nodule</th>\n",
+       "      <th>Pneumonia</th>\n",
+       "      <th>Pneumothorax</th>\n",
+       "      <th>Consolidation</th>\n",
+       "      <th>Edema</th>\n",
+       "      <th>Emphysema</th>\n",
+       "      <th>Fibrosis</th>\n",
+       "      <th>Pleural Thickening</th>\n",
+       "      <th>Hernia</th>\n",
+       "    </tr>\n",
+       "  </thead>\n",
+       "  <tbody>\n",
+       "    <tr>\n",
+       "      <th>Atelectasis</th>\n",
+       "      <td>3.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Cardiomegaly</th>\n",
+       "      <td>0.0</td>\n",
+       "      <td>4.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Effusion</th>\n",
+       "      <td>1.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>3.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Infiltration</th>\n",
+       "      <td>1.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>8.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Mass</th>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>2.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Nodule</th>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Pneumonia</th>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Pneumothorax</th>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Consolidation</th>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>2.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Edema</th>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Emphysema</th>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Fibrosis</th>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Pleural Thickening</th>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Hernia</th>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>6.0</td>\n",
+       "    </tr>\n",
+       "  </tbody>\n",
+       "</table>\n",
+       "</div>"
+      ],
+      "text/plain": [
+       "                    Atelectasis  Cardiomegaly  Effusion  Infiltration  Mass  \\\n",
+       "Atelectasis                 3.0           0.0       1.0           1.0   0.0   \n",
+       "Cardiomegaly                0.0           4.0       1.0           1.0   0.0   \n",
+       "Effusion                    1.0           1.0       3.0           0.0   0.0   \n",
+       "Infiltration                1.0           1.0       0.0           8.0   0.0   \n",
+       "Mass                        0.0           0.0       0.0           0.0   2.0   \n",
+       "Nodule                      0.0           0.0       0.0           0.0   0.0   \n",
+       "Pneumonia                   0.0           0.0       0.0           0.0   0.0   \n",
+       "Pneumothorax                0.0           0.0       0.0           0.0   0.0   \n",
+       "Consolidation               1.0           0.0       1.0           0.0   0.0   \n",
+       "Edema                       0.0           0.0       0.0           1.0   0.0   \n",
+       "Emphysema                   0.0           1.0       0.0           0.0   0.0   \n",
+       "Fibrosis                    0.0           0.0       0.0           0.0   0.0   \n",
+       "Pleural Thickening          0.0           0.0       0.0           0.0   0.0   \n",
+       "Hernia                      0.0           0.0       0.0           1.0   0.0   \n",
+       "\n",
+       "                    Nodule  Pneumonia  Pneumothorax  Consolidation  Edema  \\\n",
+       "Atelectasis            0.0        0.0           0.0            1.0    0.0   \n",
+       "Cardiomegaly           0.0        0.0           0.0            0.0    0.0   \n",
+       "Effusion               0.0        0.0           0.0            1.0    0.0   \n",
+       "Infiltration           0.0        0.0           0.0            0.0    1.0   \n",
+       "Mass                   0.0        0.0           0.0            0.0    0.0   \n",
+       "Nodule                 0.0        0.0           0.0            0.0    0.0   \n",
+       "Pneumonia              0.0        0.0           0.0            0.0    0.0   \n",
+       "Pneumothorax           0.0        0.0           1.0            0.0    0.0   \n",
+       "Consolidation          0.0        0.0           0.0            2.0    0.0   \n",
+       "Edema                  0.0        0.0           0.0            0.0    1.0   \n",
+       "Emphysema              0.0        0.0           0.0            0.0    0.0   \n",
+       "Fibrosis               0.0        0.0           0.0            0.0    0.0   \n",
+       "Pleural Thickening     0.0        0.0           0.0            0.0    0.0   \n",
+       "Hernia                 0.0        0.0           0.0            0.0    0.0   \n",
+       "\n",
+       "                    Emphysema  Fibrosis  Pleural Thickening  Hernia  \n",
+       "Atelectasis               0.0       0.0                 0.0     0.0  \n",
+       "Cardiomegaly              1.0       0.0                 0.0     0.0  \n",
+       "Effusion                  0.0       0.0                 0.0     0.0  \n",
+       "Infiltration              0.0       0.0                 0.0     1.0  \n",
+       "Mass                      0.0       0.0                 0.0     0.0  \n",
+       "Nodule                    0.0       0.0                 0.0     0.0  \n",
+       "Pneumonia                 0.0       0.0                 0.0     0.0  \n",
+       "Pneumothorax              0.0       0.0                 0.0     0.0  \n",
+       "Consolidation             0.0       0.0                 0.0     0.0  \n",
+       "Edema                     0.0       0.0                 0.0     0.0  \n",
+       "Emphysema                 1.0       0.0                 0.0     0.0  \n",
+       "Fibrosis                  0.0       0.0                 0.0     0.0  \n",
+       "Pleural Thickening        0.0       0.0                 0.0     0.0  \n",
+       "Hernia                    0.0       0.0                 0.0     6.0  "
+      ]
+     },
+     "execution_count": 7,
+     "metadata": {},
+     "output_type": "execute_result"
+    }
+   ],
+   "source": [
+    "concurr_arr = np.zeros([len(classes), len(classes)])\n",
+    "\n",
+    "for i, c1 in enumerate(classes):\n",
+    "  for j, c2 in enumerate(classes):\n",
+    "    concurr_arr[i, j] = len(data[(data[c1] == 1) & (data[c2] == 1)])\n",
+    "\n",
+    "concurr_mtrix = pd.DataFrame(concurr_arr, columns=classes, index=classes)\n",
+    "concurr_mtrix"
+   ]
+  },
+  {
+   "cell_type": "code",
+   "execution_count": 8,
+   "metadata": {},
+   "outputs": [
+    {
+     "data": {
+      "text/html": [
+       "<div>\n",
+       "<style scoped>\n",
+       "    .dataframe tbody tr th:only-of-type {\n",
+       "        vertical-align: middle;\n",
+       "    }\n",
+       "\n",
+       "    .dataframe tbody tr th {\n",
+       "        vertical-align: top;\n",
+       "    }\n",
+       "\n",
+       "    .dataframe thead th {\n",
+       "        text-align: right;\n",
+       "    }\n",
+       "</style>\n",
+       "<table border=\"1\" class=\"dataframe\">\n",
+       "  <thead>\n",
+       "    <tr style=\"text-align: right;\">\n",
        "      <th></th>\n",
+       "      <th>Atelectasis</th>\n",
+       "      <th>Cardiomegaly</th>\n",
+       "      <th>Effusion</th>\n",
+       "      <th>Infiltration</th>\n",
+       "      <th>Mass</th>\n",
+       "      <th>Nodule</th>\n",
+       "      <th>Pneumonia</th>\n",
+       "      <th>Pneumothorax</th>\n",
+       "      <th>Consolidation</th>\n",
+       "      <th>Edema</th>\n",
+       "      <th>Emphysema</th>\n",
+       "      <th>Fibrosis</th>\n",
+       "      <th>Pleural Thickening</th>\n",
+       "      <th>Hernia</th>\n",
        "    </tr>\n",
        "  </thead>\n",
        "  <tbody>\n",
        "    <tr>\n",
-       "      <th>50a418190bc3fb1ef1633bf9678929b3</th>\n",
-       "      <td>No finding</td>\n",
-       "      <td>14</td>\n",
-       "      <td>R11</td>\n",
+       "      <th>Atelectasis</th>\n",
+       "      <td>1.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.333333</td>\n",
+       "      <td>0.333333</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.333333</td>\n",
+       "      <td>0.000</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Cardiomegaly</th>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>1.000000</td>\n",
+       "      <td>0.250000</td>\n",
+       "      <td>0.250000</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000</td>\n",
+       "      <td>0.25</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Effusion</th>\n",
+       "      <td>0.333333</td>\n",
+       "      <td>0.333333</td>\n",
+       "      <td>1.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.333333</td>\n",
+       "      <td>0.000</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Infiltration</th>\n",
+       "      <td>0.125000</td>\n",
+       "      <td>0.125000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>1.000000</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.125</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.125</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Mass</th>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Nodule</th>\n",
+       "      <td>NaN</td>\n",
+       "      <td>NaN</td>\n",
+       "      <td>NaN</td>\n",
+       "      <td>NaN</td>\n",
+       "      <td>NaN</td>\n",
+       "      <td>NaN</td>\n",
+       "      <td>NaN</td>\n",
+       "      <td>NaN</td>\n",
+       "      <td>NaN</td>\n",
+       "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
-       "      <td>2332</td>\n",
-       "      <td>2580</td>\n",
        "    </tr>\n",
        "    <tr>\n",
-       "      <th>21a10246a5ec7af151081d0cd6d65dc9</th>\n",
-       "      <td>No finding</td>\n",
-       "      <td>14</td>\n",
-       "      <td>R7</td>\n",
+       "      <th>Pneumonia</th>\n",
        "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
-       "      <td>2954</td>\n",
-       "      <td>3159</td>\n",
+       "      <td>NaN</td>\n",
+       "      <td>NaN</td>\n",
+       "      <td>NaN</td>\n",
+       "      <td>NaN</td>\n",
+       "      <td>NaN</td>\n",
+       "      <td>NaN</td>\n",
+       "      <td>NaN</td>\n",
+       "      <td>NaN</td>\n",
+       "      <td>NaN</td>\n",
+       "      <td>NaN</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Pneumothorax</th>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000</td>\n",
        "    </tr>\n",
        "    <tr>\n",
-       "      <th>9a5094b2563a1ef3ff50dc5c7ff71345</th>\n",
-       "      <td>Cardiomegaly</td>\n",
-       "      <td>3</td>\n",
-       "      <td>R10</td>\n",
-       "      <td>691.0</td>\n",
-       "      <td>1375.0</td>\n",
-       "      <td>1653.0</td>\n",
-       "      <td>1831.0</td>\n",
-       "      <td>2080</td>\n",
-       "      <td>2336</td>\n",
+       "      <th>Consolidation</th>\n",
+       "      <td>0.500000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.500000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.000000</td>\n",
+       "      <td>0.000</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Edema</th>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>1.000000</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>1.000</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000</td>\n",
        "    </tr>\n",
        "    <tr>\n",
-       "      <th>051132a778e61a86eb147c7c6f564dfe</th>\n",
-       "      <td>Aortic enlargement</td>\n",
-       "      <td>0</td>\n",
-       "      <td>R10</td>\n",
-       "      <td>1264.0</td>\n",
-       "      <td>743.0</td>\n",
-       "      <td>1611.0</td>\n",
-       "      <td>1019.0</td>\n",
-       "      <td>2304</td>\n",
-       "      <td>2880</td>\n",
+       "      <th>Emphysema</th>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>1.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000</td>\n",
+       "      <td>1.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000</td>\n",
        "    </tr>\n",
        "    <tr>\n",
-       "      <th>063319de25ce7edb9b1c6b8881290140</th>\n",
-       "      <td>No finding</td>\n",
-       "      <td>14</td>\n",
-       "      <td>R10</td>\n",
+       "      <th>Fibrosis</th>\n",
        "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
-       "      <td>2540</td>\n",
-       "      <td>3072</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>...</th>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>936fd5cff1c058d39817a08f58b72cae</th>\n",
-       "      <td>No finding</td>\n",
-       "      <td>14</td>\n",
-       "      <td>R1</td>\n",
        "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
-       "      <td>2444</td>\n",
-       "      <td>3200</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>ca7e72954550eeb610fe22bf0244b7fa</th>\n",
-       "      <td>No finding</td>\n",
-       "      <td>14</td>\n",
-       "      <td>R1</td>\n",
+       "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
-       "      <td>1994</td>\n",
-       "      <td>2430</td>\n",
+       "      <td>NaN</td>\n",
        "    </tr>\n",
        "    <tr>\n",
-       "      <th>aa17d5312a0fb4a2939436abca7f9579</th>\n",
-       "      <td>No finding</td>\n",
-       "      <td>14</td>\n",
-       "      <td>R8</td>\n",
+       "      <th>Pleural Thickening</th>\n",
        "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
-       "      <td>2048</td>\n",
-       "      <td>2500</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>4b56bc6d22b192f075f13231419dfcc8</th>\n",
-       "      <td>Cardiomegaly</td>\n",
-       "      <td>3</td>\n",
-       "      <td>R8</td>\n",
-       "      <td>771.0</td>\n",
-       "      <td>979.0</td>\n",
-       "      <td>1680.0</td>\n",
-       "      <td>1311.0</td>\n",
-       "      <td>1968</td>\n",
-       "      <td>2040</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>5e272e3adbdaafb07a7e84a9e62b1a4c</th>\n",
-       "      <td>No finding</td>\n",
-       "      <td>14</td>\n",
-       "      <td>R16</td>\n",
+       "      <td>NaN</td>\n",
+       "      <td>NaN</td>\n",
+       "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
        "      <td>NaN</td>\n",
-       "      <td>2048</td>\n",
-       "      <td>2500</td>\n",
+       "      <td>NaN</td>\n",
+       "      <td>NaN</td>\n",
+       "      <td>NaN</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Hernia</th>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.166667</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.000</td>\n",
        "    </tr>\n",
        "  </tbody>\n",
        "</table>\n",
-       "<p>67914 rows × 9 columns</p>\n",
        "</div>"
       ],
       "text/plain": [
-       "                                          class_name  class_id rad_id   x_min  \\\n",
-       "image_id                                                                        \n",
-       "50a418190bc3fb1ef1633bf9678929b3          No finding        14    R11     NaN   \n",
-       "21a10246a5ec7af151081d0cd6d65dc9          No finding        14     R7     NaN   \n",
-       "9a5094b2563a1ef3ff50dc5c7ff71345        Cardiomegaly         3    R10   691.0   \n",
-       "051132a778e61a86eb147c7c6f564dfe  Aortic enlargement         0    R10  1264.0   \n",
-       "063319de25ce7edb9b1c6b8881290140          No finding        14    R10     NaN   \n",
-       "...                                              ...       ...    ...     ...   \n",
-       "936fd5cff1c058d39817a08f58b72cae          No finding        14     R1     NaN   \n",
-       "ca7e72954550eeb610fe22bf0244b7fa          No finding        14     R1     NaN   \n",
-       "aa17d5312a0fb4a2939436abca7f9579          No finding        14     R8     NaN   \n",
-       "4b56bc6d22b192f075f13231419dfcc8        Cardiomegaly         3     R8   771.0   \n",
-       "5e272e3adbdaafb07a7e84a9e62b1a4c          No finding        14    R16     NaN   \n",
+       "                    Atelectasis  Cardiomegaly  Effusion  Infiltration  Mass  \\\n",
+       "Atelectasis            1.000000      0.000000  0.333333      0.333333   0.0   \n",
+       "Cardiomegaly           0.000000      1.000000  0.250000      0.250000   0.0   \n",
+       "Effusion               0.333333      0.333333  1.000000      0.000000   0.0   \n",
+       "Infiltration           0.125000      0.125000  0.000000      1.000000   0.0   \n",
+       "Mass                   0.000000      0.000000  0.000000      0.000000   1.0   \n",
+       "Nodule                      NaN           NaN       NaN           NaN   NaN   \n",
+       "Pneumonia                   NaN           NaN       NaN           NaN   NaN   \n",
+       "Pneumothorax           0.000000      0.000000  0.000000      0.000000   0.0   \n",
+       "Consolidation          0.500000      0.000000  0.500000      0.000000   0.0   \n",
+       "Edema                  0.000000      0.000000  0.000000      1.000000   0.0   \n",
+       "Emphysema              0.000000      1.000000  0.000000      0.000000   0.0   \n",
+       "Fibrosis                    NaN           NaN       NaN           NaN   NaN   \n",
+       "Pleural Thickening          NaN           NaN       NaN           NaN   NaN   \n",
+       "Hernia                 0.000000      0.000000  0.000000      0.166667   0.0   \n",
        "\n",
-       "                                   y_min   x_max   y_max  width  height  \n",
-       "image_id                                                                 \n",
-       "50a418190bc3fb1ef1633bf9678929b3     NaN     NaN     NaN   2332    2580  \n",
-       "21a10246a5ec7af151081d0cd6d65dc9     NaN     NaN     NaN   2954    3159  \n",
-       "9a5094b2563a1ef3ff50dc5c7ff71345  1375.0  1653.0  1831.0   2080    2336  \n",
-       "051132a778e61a86eb147c7c6f564dfe   743.0  1611.0  1019.0   2304    2880  \n",
-       "063319de25ce7edb9b1c6b8881290140     NaN     NaN     NaN   2540    3072  \n",
-       "...                                  ...     ...     ...    ...     ...  \n",
-       "936fd5cff1c058d39817a08f58b72cae     NaN     NaN     NaN   2444    3200  \n",
-       "ca7e72954550eeb610fe22bf0244b7fa     NaN     NaN     NaN   1994    2430  \n",
-       "aa17d5312a0fb4a2939436abca7f9579     NaN     NaN     NaN   2048    2500  \n",
-       "4b56bc6d22b192f075f13231419dfcc8   979.0  1680.0  1311.0   1968    2040  \n",
-       "5e272e3adbdaafb07a7e84a9e62b1a4c     NaN     NaN     NaN   2048    2500  \n",
+       "                    Nodule  Pneumonia  Pneumothorax  Consolidation  Edema  \\\n",
+       "Atelectasis            0.0        0.0           0.0       0.333333  0.000   \n",
+       "Cardiomegaly           0.0        0.0           0.0       0.000000  0.000   \n",
+       "Effusion               0.0        0.0           0.0       0.333333  0.000   \n",
+       "Infiltration           0.0        0.0           0.0       0.000000  0.125   \n",
+       "Mass                   0.0        0.0           0.0       0.000000  0.000   \n",
+       "Nodule                 NaN        NaN           NaN            NaN    NaN   \n",
+       "Pneumonia              NaN        NaN           NaN            NaN    NaN   \n",
+       "Pneumothorax           0.0        0.0           1.0       0.000000  0.000   \n",
+       "Consolidation          0.0        0.0           0.0       1.000000  0.000   \n",
+       "Edema                  0.0        0.0           0.0       0.000000  1.000   \n",
+       "Emphysema              0.0        0.0           0.0       0.000000  0.000   \n",
+       "Fibrosis               NaN        NaN           NaN            NaN    NaN   \n",
+       "Pleural Thickening     NaN        NaN           NaN            NaN    NaN   \n",
+       "Hernia                 0.0        0.0           0.0       0.000000  0.000   \n",
        "\n",
-       "[67914 rows x 9 columns]"
+       "                    Emphysema  Fibrosis  Pleural Thickening  Hernia  \n",
+       "Atelectasis              0.00       0.0                 0.0   0.000  \n",
+       "Cardiomegaly             0.25       0.0                 0.0   0.000  \n",
+       "Effusion                 0.00       0.0                 0.0   0.000  \n",
+       "Infiltration             0.00       0.0                 0.0   0.125  \n",
+       "Mass                     0.00       0.0                 0.0   0.000  \n",
+       "Nodule                    NaN       NaN                 NaN     NaN  \n",
+       "Pneumonia                 NaN       NaN                 NaN     NaN  \n",
+       "Pneumothorax             0.00       0.0                 0.0   0.000  \n",
+       "Consolidation            0.00       0.0                 0.0   0.000  \n",
+       "Edema                    0.00       0.0                 0.0   0.000  \n",
+       "Emphysema                1.00       0.0                 0.0   0.000  \n",
+       "Fibrosis                  NaN       NaN                 NaN     NaN  \n",
+       "Pleural Thickening        NaN       NaN                 NaN     NaN  \n",
+       "Hernia                   0.00       0.0                 0.0   1.000  "
       ]
      },
-     "execution_count": 2,
+     "execution_count": 8,
      "metadata": {},
      "output_type": "execute_result"
     }
    ],
    "source": [
-    "data = pd.read_csv('/Users/HPhuc/Practice/12. classification/chest-X-rays/output/csv/train.csv', index_col=0)\n",
-    "data"
+    "probs_mtrix = concurr_mtrix / np.diag(concurr_mtrix)[:, np.newaxis]\n",
+    "probs_mtrix"
    ]
   },
   {
    "cell_type": "code",
-   "execution_count": null,
+   "execution_count": 9,
    "metadata": {},
-   "outputs": [],
-   "source": []
-  },
-  {
-   "cell_type": "code",
-   "execution_count": null,
-   "metadata": {},
-   "outputs": [],
-   "source": [
-    "classes = np.load('/Users/HPhuc/Practice/12. classification/vinbigdata/output/columns_14.npy')\n",
-    "classes"
-   ]
-  },
-  {
-   "cell_type": "code",
-   "execution_count": null,
-   "metadata": {},
-   "outputs": [],
-   "source": [
-    "concurr_arr = np.zeros([len(classes), len(classes)])\n",
-    "\n",
-    "for i, c1 in enumerate(classes):\n",
-    "  for j, c2 in enumerate(classes):\n",
-    "    concurr_arr[i, j] = len(data[(data[c1] == 1) & (data[c2] == 1)])\n",
-    "\n",
-    "concurr_mtrix = pd.DataFrame(concurr_arr, columns=classes, index=classes)\n",
-    "concurr_mtrix"
-   ]
-  },
-  {
-   "cell_type": "code",
-   "execution_count": null,
-   "metadata": {},
-   "outputs": [],
-   "source": [
-    "probs_mtrix = concurr_mtrix / np.diag(concurr_mtrix)[:, np.newaxis]\n",
-    "probs_mtrix"
-   ]
-  },
-  {
-   "cell_type": "code",
-   "execution_count": null,
-   "metadata": {},
-   "outputs": [],
+   "outputs": [
+    {
+     "data": {
+      "text/html": [
+       "<div>\n",
+       "<style scoped>\n",
+       "    .dataframe tbody tr th:only-of-type {\n",
+       "        vertical-align: middle;\n",
+       "    }\n",
+       "\n",
+       "    .dataframe tbody tr th {\n",
+       "        vertical-align: top;\n",
+       "    }\n",
+       "\n",
+       "    .dataframe thead th {\n",
+       "        text-align: right;\n",
+       "    }\n",
+       "</style>\n",
+       "<table border=\"1\" class=\"dataframe\">\n",
+       "  <thead>\n",
+       "    <tr style=\"text-align: right;\">\n",
+       "      <th></th>\n",
+       "      <th>Atelectasis</th>\n",
+       "      <th>Cardiomegaly</th>\n",
+       "      <th>Effusion</th>\n",
+       "      <th>Infiltration</th>\n",
+       "      <th>Mass</th>\n",
+       "      <th>Nodule</th>\n",
+       "      <th>Pneumonia</th>\n",
+       "      <th>Pneumothorax</th>\n",
+       "      <th>Consolidation</th>\n",
+       "      <th>Edema</th>\n",
+       "      <th>Emphysema</th>\n",
+       "      <th>Fibrosis</th>\n",
+       "      <th>Pleural Thickening</th>\n",
+       "      <th>Hernia</th>\n",
+       "    </tr>\n",
+       "  </thead>\n",
+       "  <tbody>\n",
+       "    <tr>\n",
+       "      <th>Atelectasis</th>\n",
+       "      <td>1</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Cardiomegaly</th>\n",
+       "      <td>0</td>\n",
+       "      <td>1</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Effusion</th>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>1</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Infiltration</th>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>1</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Mass</th>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>1</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Nodule</th>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Pneumonia</th>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Pneumothorax</th>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>1</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Consolidation</th>\n",
+       "      <td>1</td>\n",
+       "      <td>0</td>\n",
+       "      <td>1</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>1</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Edema</th>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>1</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>1</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Emphysema</th>\n",
+       "      <td>0</td>\n",
+       "      <td>1</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>1</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Fibrosis</th>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Pleural Thickening</th>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Hernia</th>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>0</td>\n",
+       "      <td>1</td>\n",
+       "    </tr>\n",
+       "  </tbody>\n",
+       "</table>\n",
+       "</div>"
+      ],
+      "text/plain": [
+       "                    Atelectasis  Cardiomegaly  Effusion  Infiltration  Mass  \\\n",
+       "Atelectasis                   1             0         0             0     0   \n",
+       "Cardiomegaly                  0             1         0             0     0   \n",
+       "Effusion                      0             0         1             0     0   \n",
+       "Infiltration                  0             0         0             1     0   \n",
+       "Mass                          0             0         0             0     1   \n",
+       "Nodule                        0             0         0             0     0   \n",
+       "Pneumonia                     0             0         0             0     0   \n",
+       "Pneumothorax                  0             0         0             0     0   \n",
+       "Consolidation                 1             0         1             0     0   \n",
+       "Edema                         0             0         0             1     0   \n",
+       "Emphysema                     0             1         0             0     0   \n",
+       "Fibrosis                      0             0         0             0     0   \n",
+       "Pleural Thickening            0             0         0             0     0   \n",
+       "Hernia                        0             0         0             0     0   \n",
+       "\n",
+       "                    Nodule  Pneumonia  Pneumothorax  Consolidation  Edema  \\\n",
+       "Atelectasis              0          0             0              0      0   \n",
+       "Cardiomegaly             0          0             0              0      0   \n",
+       "Effusion                 0          0             0              0      0   \n",
+       "Infiltration             0          0             0              0      0   \n",
+       "Mass                     0          0             0              0      0   \n",
+       "Nodule                   0          0             0              0      0   \n",
+       "Pneumonia                0          0             0              0      0   \n",
+       "Pneumothorax             0          0             1              0      0   \n",
+       "Consolidation            0          0             0              1      0   \n",
+       "Edema                    0          0             0              0      1   \n",
+       "Emphysema                0          0             0              0      0   \n",
+       "Fibrosis                 0          0             0              0      0   \n",
+       "Pleural Thickening       0          0             0              0      0   \n",
+       "Hernia                   0          0             0              0      0   \n",
+       "\n",
+       "                    Emphysema  Fibrosis  Pleural Thickening  Hernia  \n",
+       "Atelectasis                 0         0                   0       0  \n",
+       "Cardiomegaly                0         0                   0       0  \n",
+       "Effusion                    0         0                   0       0  \n",
+       "Infiltration                0         0                   0       0  \n",
+       "Mass                        0         0                   0       0  \n",
+       "Nodule                      0         0                   0       0  \n",
+       "Pneumonia                   0         0                   0       0  \n",
+       "Pneumothorax                0         0                   0       0  \n",
+       "Consolidation               0         0                   0       0  \n",
+       "Edema                       0         0                   0       0  \n",
+       "Emphysema                   1         0                   0       0  \n",
+       "Fibrosis                    0         0                   0       0  \n",
+       "Pleural Thickening          0         0                   0       0  \n",
+       "Hernia                      0         0                   0       1  "
+      ]
+     },
+     "execution_count": 9,
+     "metadata": {},
+     "output_type": "execute_result"
+    }
+   ],
    "source": [
     "smooth_corr = (probs_mtrix > 0.45).astype(int)  # threshold = 0.45\n",
     "smooth_corr"
@@ -303,9 +1281,344 @@
   },
   {
    "cell_type": "code",
-   "execution_count": null,
+   "execution_count": 10,
    "metadata": {},
-   "outputs": [],
+   "outputs": [
+    {
+     "data": {
+      "text/html": [
+       "<div>\n",
+       "<style scoped>\n",
+       "    .dataframe tbody tr th:only-of-type {\n",
+       "        vertical-align: middle;\n",
+       "    }\n",
+       "\n",
+       "    .dataframe tbody tr th {\n",
+       "        vertical-align: top;\n",
+       "    }\n",
+       "\n",
+       "    .dataframe thead th {\n",
+       "        text-align: right;\n",
+       "    }\n",
+       "</style>\n",
+       "<table border=\"1\" class=\"dataframe\">\n",
+       "  <thead>\n",
+       "    <tr style=\"text-align: right;\">\n",
+       "      <th></th>\n",
+       "      <th>Atelectasis</th>\n",
+       "      <th>Cardiomegaly</th>\n",
+       "      <th>Effusion</th>\n",
+       "      <th>Infiltration</th>\n",
+       "      <th>Mass</th>\n",
+       "      <th>Nodule</th>\n",
+       "      <th>Pneumonia</th>\n",
+       "      <th>Pneumothorax</th>\n",
+       "      <th>Consolidation</th>\n",
+       "      <th>Edema</th>\n",
+       "      <th>Emphysema</th>\n",
+       "      <th>Fibrosis</th>\n",
+       "      <th>Pleural Thickening</th>\n",
+       "      <th>Hernia</th>\n",
+       "    </tr>\n",
+       "  </thead>\n",
+       "  <tbody>\n",
+       "    <tr>\n",
+       "      <th>Atelectasis</th>\n",
+       "      <td>1.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Cardiomegaly</th>\n",
+       "      <td>0.00</td>\n",
+       "      <td>1.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Effusion</th>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>1.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Infiltration</th>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>1.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Mass</th>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Nodule</th>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.25</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Pneumonia</th>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>1.25</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Pneumothorax</th>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Consolidation</th>\n",
+       "      <td>0.25</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.25</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Edema</th>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.25</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Emphysema</th>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.25</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Fibrosis</th>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.25</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Pleural Thickening</th>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>1.25</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>Hernia</th>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>0.00</td>\n",
+       "      <td>1.0</td>\n",
+       "    </tr>\n",
+       "  </tbody>\n",
+       "</table>\n",
+       "</div>"
+      ],
+      "text/plain": [
+       "                    Atelectasis  Cardiomegaly  Effusion  Infiltration  Mass  \\\n",
+       "Atelectasis                1.00          0.00      0.00          0.00   0.0   \n",
+       "Cardiomegaly               0.00          1.00      0.00          0.00   0.0   \n",
+       "Effusion                   0.00          0.00      1.00          0.00   0.0   \n",
+       "Infiltration               0.00          0.00      0.00          1.00   0.0   \n",
+       "Mass                       0.00          0.00      0.00          0.00   1.0   \n",
+       "Nodule                     0.00          0.00      0.00          0.00   0.0   \n",
+       "Pneumonia                  0.00          0.00      0.00          0.00   0.0   \n",
+       "Pneumothorax               0.00          0.00      0.00          0.00   0.0   \n",
+       "Consolidation              0.25          0.00      0.25          0.00   0.0   \n",
+       "Edema                      0.00          0.00      0.00          0.25   0.0   \n",
+       "Emphysema                  0.00          0.25      0.00          0.00   0.0   \n",
+       "Fibrosis                   0.00          0.00      0.00          0.00   0.0   \n",
+       "Pleural Thickening         0.00          0.00      0.00          0.00   0.0   \n",
+       "Hernia                     0.00          0.00      0.00          0.00   0.0   \n",
+       "\n",
+       "                    Nodule  Pneumonia  Pneumothorax  Consolidation  Edema  \\\n",
+       "Atelectasis           0.00       0.00           0.0            0.0    0.0   \n",
+       "Cardiomegaly          0.00       0.00           0.0            0.0    0.0   \n",
+       "Effusion              0.00       0.00           0.0            0.0    0.0   \n",
+       "Infiltration          0.00       0.00           0.0            0.0    0.0   \n",
+       "Mass                  0.00       0.00           0.0            0.0    0.0   \n",
+       "Nodule                1.25       0.00           0.0            0.0    0.0   \n",
+       "Pneumonia             0.00       1.25           0.0            0.0    0.0   \n",
+       "Pneumothorax          0.00       0.00           1.0            0.0    0.0   \n",
+       "Consolidation         0.00       0.00           0.0            1.0    0.0   \n",
+       "Edema                 0.00       0.00           0.0            0.0    1.0   \n",
+       "Emphysema             0.00       0.00           0.0            0.0    0.0   \n",
+       "Fibrosis              0.00       0.00           0.0            0.0    0.0   \n",
+       "Pleural Thickening    0.00       0.00           0.0            0.0    0.0   \n",
+       "Hernia                0.00       0.00           0.0            0.0    0.0   \n",
+       "\n",
+       "                    Emphysema  Fibrosis  Pleural Thickening  Hernia  \n",
+       "Atelectasis               0.0      0.00                0.00     0.0  \n",
+       "Cardiomegaly              0.0      0.00                0.00     0.0  \n",
+       "Effusion                  0.0      0.00                0.00     0.0  \n",
+       "Infiltration              0.0      0.00                0.00     0.0  \n",
+       "Mass                      0.0      0.00                0.00     0.0  \n",
+       "Nodule                    0.0      0.00                0.00     0.0  \n",
+       "Pneumonia                 0.0      0.00                0.00     0.0  \n",
+       "Pneumothorax              0.0      0.00                0.00     0.0  \n",
+       "Consolidation             0.0      0.00                0.00     0.0  \n",
+       "Edema                     0.0      0.00                0.00     0.0  \n",
+       "Emphysema                 1.0      0.00                0.00     0.0  \n",
+       "Fibrosis                  0.0      1.25                0.00     0.0  \n",
+       "Pleural Thickening        0.0      0.00                1.25     0.0  \n",
+       "Hernia                    0.0      0.00                0.00     1.0  "
+      ]
+     },
+     "execution_count": 10,
+     "metadata": {},
+     "output_type": "execute_result"
+    }
+   ],
    "source": [
     "p = 0.2\n",
     "reweight = smooth_corr - np.identity(len(classes))\n",
@@ -324,13 +1637,329 @@
   },
   {
    "cell_type": "code",
-   "execution_count": null,
+   "execution_count": 12,
    "metadata": {},
-   "outputs": [],
+   "outputs": [
+    {
+     "data": {
+      "text/html": [
+       "<div>\n",
+       "<style scoped>\n",
+       "    .dataframe tbody tr th:only-of-type {\n",
+       "        vertical-align: middle;\n",
+       "    }\n",
+       "\n",
+       "    .dataframe tbody tr th {\n",
+       "        vertical-align: top;\n",
+       "    }\n",
+       "\n",
+       "    .dataframe thead th {\n",
+       "        text-align: right;\n",
+       "    }\n",
+       "</style>\n",
+       "<table border=\"1\" class=\"dataframe\">\n",
+       "  <thead>\n",
+       "    <tr style=\"text-align: right;\">\n",
+       "      <th></th>\n",
+       "      <th>0</th>\n",
+       "      <th>1</th>\n",
+       "      <th>2</th>\n",
+       "      <th>3</th>\n",
+       "      <th>4</th>\n",
+       "      <th>5</th>\n",
+       "      <th>6</th>\n",
+       "      <th>7</th>\n",
+       "      <th>8</th>\n",
+       "      <th>9</th>\n",
+       "      <th>10</th>\n",
+       "      <th>11</th>\n",
+       "      <th>12</th>\n",
+       "      <th>13</th>\n",
+       "    </tr>\n",
+       "  </thead>\n",
+       "  <tbody>\n",
+       "    <tr>\n",
+       "      <th>0</th>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.204124</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>1</th>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.223607</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>2</th>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.204124</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>3</th>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.223607</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>4</th>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>5</th>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>6</th>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>7</th>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>8</th>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.666667</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>9</th>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.800000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>10</th>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.800000</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>11</th>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>12</th>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "      <td>0.0</td>\n",
+       "    </tr>\n",
+       "    <tr>\n",
+       "      <th>13</th>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.000000</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>0.0</td>\n",
+       "      <td>1.0</td>\n",
+       "    </tr>\n",
+       "  </tbody>\n",
+       "</table>\n",
+       "</div>"
+      ],
+      "text/plain": [
+       "     0    1    2    3    4    5    6    7         8         9         10   11  \\\n",
+       "0   1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.204124  0.000000  0.000000  0.0   \n",
+       "1   0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.000000  0.000000  0.223607  0.0   \n",
+       "2   0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.204124  0.000000  0.000000  0.0   \n",
+       "3   0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.000000  0.223607  0.000000  0.0   \n",
+       "4   0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.000000  0.000000  0.000000  0.0   \n",
+       "5   0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.000000  0.000000  0.000000  0.0   \n",
+       "6   0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.000000  0.000000  0.000000  0.0   \n",
+       "7   0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.000000  0.000000  0.000000  0.0   \n",
+       "8   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.666667  0.000000  0.000000  0.0   \n",
+       "9   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.000000  0.800000  0.000000  0.0   \n",
+       "10  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.000000  0.000000  0.800000  0.0   \n",
+       "11  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.000000  0.000000  0.000000  1.0   \n",
+       "12  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.000000  0.000000  0.000000  0.0   \n",
+       "13  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.000000  0.000000  0.000000  0.0   \n",
+       "\n",
+       "     12   13  \n",
+       "0   0.0  0.0  \n",
+       "1   0.0  0.0  \n",
+       "2   0.0  0.0  \n",
+       "3   0.0  0.0  \n",
+       "4   0.0  0.0  \n",
+       "5   0.0  0.0  \n",
+       "6   0.0  0.0  \n",
+       "7   0.0  0.0  \n",
+       "8   0.0  0.0  \n",
+       "9   0.0  0.0  \n",
+       "10  0.0  0.0  \n",
+       "11  0.0  0.0  \n",
+       "12  1.0  0.0  \n",
+       "13  0.0  1.0  "
+      ]
+     },
+     "execution_count": 12,
+     "metadata": {},
+     "output_type": "execute_result"
+    }
+   ],
    "source": [
-    "from pathlib import Path \n",
-    "import parameter as para\n",
-    "\n",
     "# D = np.diag(reweight.sum(axis=1) ** (-0.5))\n",
     "# reweight = D @ reweight.values.T @ D\n",
     "# np.save(Path(f'{para.output_path}' + '/correlations_14.npy'), reweight)\n",
@@ -343,15 +1972,13 @@
   },
   {
    "cell_type": "code",
-   "execution_count": null,
+   "execution_count": 14,
    "metadata": {},
    "outputs": [],
    "source": [
-    "import parameter as para \n",
     "from pathlib import Path\n",
-    "import os \n",
     "\n",
-    "np.save(Path(f'{para.output_path}' + '/correlations_14'), reweight)"
+    "# np.save(Path(f'{output_path}' + '/correlations_14'), reweight)"
    ]
   },
   {
@@ -364,7 +1991,7 @@
  ],
  "metadata": {
   "kernelspec": {
-   "display_name": "Python 3.7.13 ('env1')",
+   "display_name": "venv",
    "language": "python",
    "name": "python3"
   },
@@ -378,12 +2005,12 @@
    "name": "python",
    "nbconvert_exporter": "python",
    "pygments_lexer": "ipython3",
-   "version": "3.7.13"
+   "version": "3.7.16"
   },
   "orig_nbformat": 4,
   "vscode": {
    "interpreter": {
-    "hash": "73debb880a198c180bbd222a47dda85b4338a84f60caf5c95fac3f32e5ae8937"
+    "hash": "572ac709a4723f93826c4758b1d2d0b69d22c7b56265776d12836d04ab7ee591"
    }
   }
  },
